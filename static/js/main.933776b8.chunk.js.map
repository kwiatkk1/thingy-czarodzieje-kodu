{"version":3,"sources":["assets/czarodzieje-logo.png","components/challenges/led.js","components/challenges/led.md","components/challenges/dino.js","components/challenges/dino.md","components/challenges/ball.js","components/challenges/ball.md","components/challenges/sensors.md","utils/use-markdown.js","components/ui/markdown-code-block.js","components/ui/markdown.js","components/ui/challenge-frame.js","components/ui/menu.js","components/not-connected-view.js","module/thingy/thingy-actions.js","module/thingy/api/EventTarget.js","module/thingy/api/Utilities.js","module/thingy/api/ThingyController.js","module/thingy/api/FeatureOperations.js","module/thingy/api/AdvertisingParametersService.js","module/thingy/api/MicrophoneSensor.js","module/thingy/api/MTUService.js","module/thingy/api/NameService.js","module/thingy/api/TemperatureSensor.js","module/thingy/api/PressureSensor.js","module/thingy/api/LEDService.js","module/thingy/api/TapSensor.js","module/thingy/api/AbsoluteOrientationSensor.js","module/thingy/api/QuaternionOrientationSensor.js","module/thingy/api/ButtonSensor.js","module/thingy/api/CloudTokenService.js","module/thingy/api/ColorSensor.js","module/thingy/api/ConnectionParametersService.js","module/thingy/api/FirmwareService.js","module/thingy/api/GasSensor.js","module/thingy/api/GravityVectorSensor.js","module/thingy/api/HumiditySensor.js","module/thingy/api/StepCounterSensor.js","module/thingy/api/RawDataSensor.js","module/thingy/api/EulerOrientationSensor.js","module/thingy/api/RotationMatrixOrientationSensor.js","module/thingy/api/HeadingSensor.js","module/thingy/api/EddystoneUrlService.js","module/thingy/api/EnvironmentConfigurationService.js","module/thingy/api/MotionConfigurationService.js","module/thingy/api/SoundConfigurationService.js","module/thingy/api/SpeakerDataService.js","module/thingy/api/SpeakerStatusService.js","module/thingy/api/BatteryService.js","module/thingy/api/DFUControlPointServiceFirmwarev1.js","module/thingy/api/DFUControlPointServiceFirmwarev2.js","module/thingy/api/Thingy.js","components/connect-button.js","components/ui/battery.js","module/firestore/firebase.js","components/connection-panel.js","components/connection-panel-container.js","components/status-view.js","components/app.js","components/app-container.js","theme.js","module/thingy/thingy-reducer.js","reducers.js","utils/colorConverter.js","components/challenges/light-and-sound/UICards.js","components/challenges/light-and-sound/index.js","components/challenges/light-and-sound/container.js","components/challenges/led-container.js","components/challenges/dino-container.js","components/challenges/ball-container.js","components/ui/realtime-chart.js","components/challenges/sensors-container.js","challenges.js","components/challenges/sensors.js","index.js","components/ui/code-editor.js","components/ui/code-editor-card.js","components/ui/game-frame.js","assets/thingy-product.png","components/ui/challenge-header.js"],"names":["module","exports","Led","props","defaultCode","markdownText","useMarkdown","docsUrl","useSnackbar","enqueueSnackbar","executeCode","code","writeLedColor","sleep","time","Promise","resolve","setTimeout","changeColor","color","console","log","led","reading","onButtonPressed","callback","window","thingyOnButtonPressed","eval","variant","preventDuplicate","e","error","useEffect","onStart","connected","buttonPressed","headerText","showcasePanel","JSON","stringify","codePanel","name","initial","onRun","GAME_NAME","Dino","trexGameCommand","cmd","gameCommand","jumpStart","jumpEnd","onTap","thingyOnTap","onEnd","tapCount","tapDirection","id","publicPath","Ball","dinoGameCommand","moveRight","moveLeft","moveUp","moveDown","onGravityChange","thingyOnGravityChange","gravity","x","y","z","src","useState","setMarkdownText","fetch","then","r","text","md","MarkdownCodeBlock","language","value","style","prism","defaultProps","useStyles","makeStyles","theme","markdown","Markdown","classes","className","renderers","source","input","root","display","flexDirection","height","main","flexGrow","sourcePanel","textPanel","width","padding","spacing","ChallengeFrame","header","ListItemLink","icon","primary","secondary","to","renderLink","React","useMemo","forwardRef","itemProps","ref","innerRef","ListItem","button","component","ListItemIcon","ListItemText","toolbar","mixins","backgroundColor","palette","textAlign","toolbarImg","maxHeight","maxWidth","Menu","logo","alt","Divider","List","items","map","item","key","path","alignItems","justifyContent","flexFlow","thingyName","NotConnectedView","localStorage","getItem","thingyImage","message","Typography","receiveNewReading","feature","type","receiveNewNotifyReading","featureNotificationStatus","status","notifyUser","category","toggleFeature","toggle","isMicrophone","async","dispatch","getState","notifyFeatures","state","thingy","hasEventListener","featureToUpdateStatusFor","includes","isNot","mtu","write","data","tempData","detail","microphone","play","stop","addEventListener","setFeatureHasEventListener","start","features","f","readFeature","read","writeFeature","onConnectionEvent","defineProperties","target","descriptions","property","Object","defineProperty","configurable","EventTargetMixin","superclass","eventNames","constructor","args","super","eventTarget","document","createDocumentFragment","this","removeEventListener","dispatchEvent","event","currentTarget","methodName","retValue","parentNode","EventTarget","Utilities","device","ms","processEvent","body","eventObject","ce","CustomEvent","ThingyController","setDevice","utilities","_initialize","undefined","thingyController","tid","gattStatus","queuedOperations","executingQueuedOperations","executedOperations","addExecutedOperation","method","getConnected","push","clearExecutedOperations","setGattStatus","bool","getGattStatus","getNumQueuedOperations","length","getQueuedOperation","index","removeQueuedOperation","Number","isInteger","splice","i","op","enqueue","dequeue","shift","setExecutingQueuedOperations","getExecutingQueuedOperations","getDevice","getExecutedOperation","getNumExecutedOperations","terminate","FeatureOperations","latestReading","Map","characteristic","logEnabled","_connect","bind","service","server","getPrimaryService","uuid","getCharacteristic","notifying","returnRaw","connectIteration","readIteration","returnValue","Error","wait","hasProperty","decoder","prop","readValue","writeIteration","encoder","encodedProp","writeValue","enable","verify","_notify","onReading","csn","startNotifications","stopNotifications","audioCtx","suspendAudioContext","properties","_read","_write","AdvertisingParametersService","TCS_UUID","TCS_ADV_PARAMS_UUID","decodeAdvertisingParam","encodeAdvertisingParam","littleEndian","interval","getUint16","toFixed","timeout","getUint8","params","RangeError","receivedData","dataArray","Uint8Array","Microphone","eventListeners","TSS_UUID","TSS_MIC_UUID","decodeMicrophoneData","AudioContext","webkitAudioContext","_MICROPHONE_INDEX_TABLE","_MICROPHONE_STEP_SIZE_TABLE","suspend","audioPacket","buffer","adpcm","DataView","slice","_decodeAudio","getGattAvailable","microphoneData","verifyReaction","byteLength","notifyError","audioBufferDataLength","audioBuffer","ArrayBuffer","pcm","diff","step","bufferStep","inputBuffer","delta","sign","valuePredicted","getInt16","getInt8","_in","_out","setInt16","audio","_audioStack","_scheduleAudioBuffers","bufferTime","channels","framecount","_audioNextTime","resume","myArrayBuffer","createBuffer","nowBuffering","getChannelData","createBufferSource","connect","destination","currentTime","duration","MTUService","TCS_MTU_REQUEST_UUID","decodeMtu","encodeMtu","mtuSize","peripheralRequest","NameService","TCS_NAME_UUID","decodeName","encodeName","TextDecoder","decode","reject","TypeError","encodedName","charCodeAt","TemperatureSensor","TES_UUID","TES_TEMP_UUID","decodeTemperature","unit","PressureSensor","TES_PRESSURE_UUID","decodePressureData","getUint32","LEDService","TUIS_UUID","TUIS_LED_UUID","decodeLedData","encodeLedData","mode","g","b","intensity","delay","red","green","blue","colors","colorCode","indexOf","join","TapSensor","TMS_UUID","TMS_TAP_UUID","decodeTapData","direction","count","AbsoluteOrientationSensor","TMS_ORIENTATION_UUID","decodeOrientationData","orientation","QuaternionOrientationSensor","TMS_QUATERNION_UUID","decodeQuaternionData","w","getInt32","magnitude","Math","sqrt","pow","ButtonSensor","TUIS_BTN_UUID","decodeButtonData","CloudTokenService","TCS_CLOUD_TOKEN_UUID","decodeCloudToken","encodeCloudToken","token","TextEncoder","encode","ColorSensor","TES_COLOR_UUID","decodeColorData","c","clearAtBlack","clearNormalized","parseInt","ConnectionParametersService","TCS_CONN_PARAMS_UUID","decodeConnectionParam","encodeConnectionParam","minInterval","maxInterval","slaveLatency","round","FirmwareService","TCS_FW_VER_UUID","decodeFirmwareVersion","firmware","GasSensor","TES_GAS_UUID","decodeGasData","eCO2","TVOC","GravityVectorSensor","TMS_GRAVITY_UUID","decodeGravityVectorData","getFloat32","HumiditySensor","TES_HUMIDITY_UUID","decodeHumidityData","StepCounterSensor","TMS_STEP_UUID","decodeStepData","RawDataSensor","TMS_RAW_UUID","decodeRawDataData","accelerometer","gyroscope","compass","EulerOrientationSensor","TMS_EULER_UUID","decodeEulerData","roll","pitch","yaw","RotationMatrixOrientationSensor","TMS_ROT_MATRIX_UUID","decodeRotationData","row1","row2","row3","HeadingSensor","TMS_HEADING_UUID","decodeHeadingData","heading","EddystoneUrlService","TCS_EDDYSTONE_UUID","decodeEddystoneData","encodeEddystoneData","expansionCodes","prefix","url","forEach","element","String","fromCharCode","replace","URL","prefixArray","prefixCode","expansionCode","eddystoneUrl","href","len","byteArray","EnvironmentConfigurationService","TES_CONFIG_UUID","decodeConfigData","encodeConfigData","temperatureInterval","pressureInterval","humidityInterval","colorInterval","gasInterval","colorSensorRed","colorSensorGreen","colorSensorBlue","colorSensorCalibration","MotionConfigurationService","TMS_CONFIG_UUID","stepCounterInterval","tempCompensationInterval","magnetCompInterval","motionProcessFrequency","wakeOnMotion","SoundConfigurationService","TSS_CONFIG_UUID","decodeSoundConfigurationData","encodeSoundConfigurationData","speakerMode","microphoneMode","SpeakerDataService","TSS_SPEAKER_DATA_UUID","encodeSpeakerData","soundconfigurationservice","frequency","volume","sample","SpeakerStatusService","TSS_SPEAKER_STAT_UUID","decodeSpeakerStatus","BatteryService","decodeBatteryStatus","DFUControlPointService","DFU_UUID","DFU_CTRL_POINT_UUID_VERSION_1","decodeDfuData","encodeDfuData","DFU_CTRL_POINT_UUID_VERSION_2","Thingy","options","TUIS_PIN_UUID","serviceUUIDs","executeQueuedOperations","advertisingparameters","MicrophoneSensor","temperature","pressure","tap","absoluteorientation","quaternionorientation","cloudtoken","connectionparameters","eddystone","gas","gravityvector","humidity","stepcounter","rawdata","eulerorientation","rotationmatrixorientation","environmentconfiguration","motionconfiguration","soundconfiguration","speakerdata","speakerstatus","battery","dfucontrolpoint_v1","DFUControlPointServiceFirmwarev1","dfucontrolpoint_v2","DFUControlPointServiceFirmwarev2","getStoredThingyName","storedThingyName","filters","services","navigator","bluetooth","requestDevice","optionalServices","onDisconnected","setConnected","gatt","triedOperations","operation","totalOperationsExecutedUntilLastIteration","totalOperationsExecutedSinceLastIteration","successful","resetDeviceProperties","disconnect","btIconConnect","btIconDisconnect","ConnectButton","Button","fullWidth","onClick","startIcon","Battery","getBatteryIconFor","batteryLevel","firebase","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","saveDeviceStatus","doc","set","lastContact","FieldValue","serverTimestamp","StatusLink","statusBtn","alignSelf","spacer","notification","readName","readFirmware","startDisconnectNotification","startErrorNotification","startWriteNotification","configurationTypes","startBatteryNotification","connectButton","statusButton","infoBlock","ListItemAvatar","Avatar","margin","table","minWidth","marginTop","StatusView","collectionPath","useCollection","collection","useDeviceCollection","loading","Paper","Table","aria-label","TableHead","TableRow","TableCell","align","TableBody","docs","sort","a","localeCompare","date","Date","seconds","scope","toLocaleString","drawer","flexShrink","drawerPaper","background","darker","content","default","isConnected","challenges","router","exact","Drawer","paper","createMuiTheme","A400","thingyState","co2","tvoc","samples","tones","playStatus","combineReducers","action","colorToRgb","rgb","rgbToColor","CardLedView","disabled","changeMode","UI","Component","changeTab","shutdown","componentWillReceiveProps","np","setState","ps","componentDidMount","startUiFeatures","writeLedMode","render","rgbConvertedColor","Lesson","RealtimeChart","temps","setTemps","newData","now","series","chart","animations","enabled","show","zoom","dataLabels","stroke","curve","markers","size","xaxis","yaxis","legend","helpTextUrl","LightAndSound","DinosaurGame","BallGame","store","createStore","AppReducer","applyMiddleware","thunk","ReactDOM","ThemeProvider","CssBaseline","maxSnack","basename","pathPrefix","querySelector","CodeEditor","placeholder","fontSize","showPrintMargin","showGutter","highlightActiveLine","setOptions","showLineNumbers","tabSize","CodeEditorCard","codeString","Card","onChange","newValue","setItem","CardActions","iframeNode","getElementById","contentWindow","postMessage","GameFrame","iframeSrc","location","hostname","frameBorder","boxShadow","shadows","ChallengeHeader","position"],"mappings":"2HAAAA,EAAOC,QAAU,shF,o0DCQF,SAASC,IAAIC,OAC1B,MAAMC,YAAc,gKAOdC,aAAeC,0DAAYC,qEARA,aASLC,6DAApBC,gBATyB,aASzBA,gBAcR,SAASC,YAAYC,MAAO,MAClBC,cAAkBT,MAAlBS,cAER,SAASC,MAAMC,GAAQ,OAAO,IAAIC,QAAQC,GAAWC,WAAWD,EAASF,IAEzE,SAASI,YAAYC,GACnBC,QAAQC,IAAI,cAAeF,GAC3BP,cAAcO,EAAD,iBAAahB,MAAMmB,IAAIC,UAGtC,SAASC,gBAAgBC,GACvBC,OAAOC,sBAAwBF,EAOjC,IACEG,KAAK,oBAAsBjB,KAAO,wJAClCF,gBAAgB,gBAAiB,CAAEoB,QAAS,UAAWC,kBAAkB,IACzE,MAAOC,GACPX,QAAQY,MAAMD,GACdtB,gBAAgB,6DAAoD,CAAEoB,QAAS,QAASC,kBAAkB,KAI9G,OAvCAG,qDAAU,KACR9B,MAAM+B,WACL,CAAC/B,MAAMgC,YAEVF,qDAAU,OACe9B,MAAMiC,eAE+B,oBAAjCV,OAAOC,uBAChCD,OAAOC,yBAER,CAACxB,MAAMiC,gBA8BR,2DAAC,6DAAD,CACEC,WAAW,gCACXhC,aAAcA,aACdiC,cAAe,sEAAMC,KAAKC,UAAUrC,MAAMmB,MAC1CmB,UAAW,2DAAC,8DAAD,CAAgBC,KAAK,cAAcC,QAASvC,YAAawC,MAAOlC,kB,oBC/DjFV,EAAOC,QAAU,IAA0B,gC,0ECA3C,kxBAQA,MAAM4C,UAAY,YAEH,SAASC,KAAK3C,OAC3B,MAAMC,YAAc,mHAQdC,aAAeC,0DAAYC,sEAE3BwC,gBAAmBC,GAAQC,gEAAYJ,UAAWG,GAqBxD,SAAStC,YAAYC,MAEnB,SAASuC,YAAcH,gBAAgB,gBACvC,SAASI,UAAYJ,gBAAgB,iBAErC,SAASvB,gBAAgBC,GACvBC,OAAOC,sBAAwBF,EAGjC,SAAS2B,MAAM3B,GACbC,OAAO2B,YAAc5B,EATvBL,QAAQC,IAAI,cAAeV,MAY3BiB,KAAKjB,MAGP,OAnCAsB,qDAAU,KACJ9B,MAAMgC,WAAWhC,MAAM+B,UACpB,KAAY/B,MAAMgC,WAAWhC,MAAMmD,UACzC,CAACnD,MAAMgC,YAEVF,qDAAU,OACe9B,MAAMiC,eAE+B,oBAAjCV,OAAOC,uBAChCD,OAAOC,yBAER,CAACxB,MAAMiC,gBAEVH,qDAAU,KAC0B,oBAAvBP,OAAO2B,aAChB3B,OAAO2B,eAER,CAAClD,MAAMoD,SAAUpD,MAAMqD,eAmBxB,2DAAC,6DAAD,CACEnB,WAAW,wBACXhC,aAAcA,aACdiC,cAAe,2DAAC,wDAAD,CAAWmB,GAAIZ,UAAWa,WAAW,8BACpDjB,UAAW,2DAAC,8DAAD,CAAgBC,KAAK,WAAWC,QAASvC,YAAawC,MAAOlC,kB,oBC/D9EV,EAAOC,QAAU,IAA0B,iC,0ECA3C,87BASA,MAAM4C,UAAY,YAEH,SAASc,KAAKxD,OAC3B,MAAMC,YAAc,gKAOdC,aAAeC,0DAAYC,sEARC,aASNC,6DAApBC,gBAT0B,aAS1BA,gBAEFmD,gBAAmBZ,GAAQC,gEAAYJ,UAAWG,GAexD,SAAStC,YAAYC,MAEnB,SAASkD,YAAcD,gBAAgB,cACvC,SAASE,WAAaF,gBAAgB,aACtC,SAASG,SAAWH,gBAAgB,WACpC,SAASI,WAAaJ,gBAAgB,aAEtC,SAASK,gBAAgBxC,GACvBC,OAAOwC,sBAAwBzC,EAGjC,IACEG,KAAKjB,MACLF,gBAAgB,gBAAiB,CAAEoB,QAAS,UAAWC,kBAAkB,IACzE,MAAOC,GACPX,QAAQY,MAAMD,GACdtB,gBAAgB,6DAAoD,CAAEoB,QAAS,QAASC,kBAAkB,KAI9G,OAjCAG,qDAAU,KACJ9B,MAAMgC,WAAYhC,MAAM+B,UACrB,KAAY/B,MAAMgC,WAAYhC,MAAMmD,UAC1C,CAACnD,MAAMgC,YAEVF,qDAAU,KAAO,MAAD,EACM9B,MAAMgE,QAAlBC,EADM,EACNA,EAAGC,EADG,EACHA,EAAGC,EADA,EACAA,EAE8B,oBAAjC5C,OAAOwC,uBAChBxC,OAAOwC,sBAAsBE,EAAGC,EAAGC,IAEpC,CAACnE,MAAMgE,UAuBR,2DAAC,6DAAD,CACE9B,WAAW,uBACXhC,aAAcA,aACdiC,cAAe,2DAAC,wDAAD,CAAWmB,GAAIZ,UAAWa,WAAW,0BACpDjB,UAAW,2DAAC,8DAAD,CAAgBC,KAAK,WAAWC,QAASvC,YAAawC,MAAOlC,kB,oBC9D9EV,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,oC,iJCE5B,SAASK,EAAYiE,GAAM,MAAD,EACGC,mBAAS,IADZ,mBAC/BnE,EAD+B,KACjBoE,EADiB,KASvC,OANAxC,oBAAU,KACRyC,MAAMH,GACHI,KAAKC,GAAKA,EAAEC,QACZF,KAAKG,GAAML,EAAgBK,KAC7B,CAACP,IAEGlE,I,gGCNM,SAAS0E,EAAkB5E,GAAQ,MACxC6E,EAAoB7E,EAApB6E,SAAUC,EAAU9E,EAAV8E,MAClB,OAAO,kBAAC,IAAD,CAAOD,SAAUA,EAAUE,MAAOC,KAAQF,GAQnDF,EAAkBK,aAAe,CAC/BJ,SAAU,MCTZ,MAAMK,EAAYC,YAAWC,IAAK,CAChCC,SAAU,MAKG,SAASC,EAAStF,GAC/B,MAAMuF,EAAUL,IAChB,OAAO,kBAAC,IAAD,CACLM,UAAWD,EAAQF,SACnBI,UAAW,CAAEjF,KAAMoE,GACnBc,OAAQ1F,EAAM2F,Q,YClBlB,kCAMA,MAAMT,EAAYC,YAAWC,IAAK,CAChCQ,KAAM,CACJC,QAAS,OACTC,cAAe,SACfC,OAAQ,SAEVC,KAAM,CACJC,SAAU,EACVJ,QAAS,QAEXK,YAAa,CACXD,SAAU,EACVJ,QAAS,OACTC,cAAe,UAEjBxD,UAAW,CACT2D,SAAU,GAEZE,UAAW,CACTC,MAAO,OACPC,QAASjB,EAAMkB,QAAQ,OAIZ,SAASC,EAAevG,GACrC,MAAMuF,EAAUL,IACRhD,EAAuDlC,EAAvDkC,WAAYhC,EAA2CF,EAA3CE,aAAciC,EAA6BnC,EAA7BmC,cAAeG,EAActC,EAAdsC,UAEjD,OACE,yBAAKkD,UAAWD,EAAQK,MACtB,yBAAKJ,UAAWD,EAAQiB,QACtB,kBAAC,IAAD,CAAiB9B,KAAMxC,KAEzB,yBAAKsD,UAAWD,EAAQS,MACtB,yBAAKR,UAAWD,EAAQW,aACrB/D,EACD,yBAAKqD,UAAWD,EAAQjD,WAAYA,IAEtC,yBAAKkD,UAAWD,EAAQY,WACrBjG,EAAe,kBAACoF,EAAD,CAAUK,MAAOzF,IAAmB,U,qvBClC9D,SAASuG,EAAazG,GAAQ,MACpB0G,EAAiC1G,EAAjC0G,KAAMC,EAA2B3G,EAA3B2G,QAASC,EAAkB5G,EAAlB4G,UAAWC,EAAO7G,EAAP6G,GAE5BC,EAAaC,IAAMC,QACvB,IACED,IAAME,WAAW,CAACC,EAAWC,IAG3B,kBAAC,IAAD,eAAYN,GAAIA,GAAQK,EAAxB,CAAmCE,SAAUD,MAEjD,CAACN,IAGH,OACE,4BACE,kBAACQ,EAAA,EAAD,CAAUC,QAAM,EAACC,UAAWT,GACzBJ,EAAO,kBAACc,EAAA,EAAD,KAAed,GAAuB,KAC9C,kBAACe,EAAA,EAAD,CAAcd,QAASA,EAASC,UAAWA,MAMnD,MAAM1B,EAAYC,YAAWC,IAAK,CAChCsC,QAAQ,EAAD,GACFtC,EAAMuC,OAAOD,QADX,CAELE,gBAAiBxC,EAAMyC,QAAQlB,QAAQX,KACvCK,QAASjB,EAAMkB,QAAQ,GACvBwB,UAAW,WAEbC,WAAY,CACVC,UAAW,OACXC,SAAU,WAIC,SAASC,EAAKlI,GAC3B,MAAMuF,EAAUL,IAEhB,OACE,kBAAC,WAAD,KACE,yBAAKM,UAAWD,EAAQmC,SACtB,yBAAKtD,IAAK+D,IAAMC,IAAI,mBAAmB5C,UAAWD,EAAQwC,cAE5D,kBAACM,EAAA,EAAD,MACA,kBAACC,EAAA,EAAD,KACGtI,EAAMuI,MAAMC,IAAIC,GAAQ,kBAAChC,EAAD,CAAciC,IAAKD,EAAKE,KAAM9B,GAAI4B,EAAKE,KAAMhC,QAAS8B,EAAK9B,QAASC,UAAW6B,EAAK7B,aAC7G,kBAACyB,EAAA,EAAD,Q,8CCpDR,MAAMnD,EAAYC,YAAWC,IAAK,CAChCQ,KAAM,CACJC,QAAS,OACT+C,WAAY,SACZC,eAAgB,SAChBC,SAAU,SACV1C,MAAO,OACPL,OAAQ,OACR+B,UAAW,UAEbiB,WAAY,CACV/H,MAAO,WAII,SAASgI,IACtB,MAAMzD,EAAUL,IAEV6D,EAAaE,aAAaC,QAAQ,cAExC,OACE,yBAAK1D,UAAWD,EAAQK,MACtB,yBAAKxB,IAAK+E,IAAaf,IAAI,KAC3B,yBAAK5C,UAAWD,EAAQ6D,SACtB,kBAACC,EAAA,EAAD,CAAY3H,QAAQ,MAApB,mDAIEqH,EACI,kBAACM,EAAA,EAAD,CAAY3H,QAAQ,KAAK8D,UAAWD,EAAQwD,YAAaA,GACzD,OCpCP,MAOMO,EAAoB,CAACC,EAASnI,KAAV,CAC/BoI,KARiC,sBASjCpI,QAAS,CACPmI,UACAnI,aAISqI,EAA0B,CAACF,EAASnI,KAAV,CACrCoI,KAfwC,6BAgBxCpI,QAAS,CACPmI,UACAnI,aAISsI,EAA4B,CAACH,EAASI,KAAV,CACvCH,KAtByC,wBAuBzCG,OAAQ,CACNJ,UACAI,YAQSC,EAAa,CAACR,EAASS,KAAV,CACxBL,KAhCyB,cAiCzBJ,UACAS,aASWC,EAAgB,CAACP,EAASQ,EAAO,OAAQC,GAAa,IAC1DC,MAAOC,EAAUC,KACtB,IACE,GAAgB,QAAZZ,EAEF,YADAW,EAASE,EAAe,CAAC,OAAQ,OAAQL,IAI3C,MAAMM,QAAcF,IACdR,EAASU,EAAMC,OAAOf,GAASI,OAC/BY,EAAmBF,EAAMC,OAAOf,GAASgB,mBAAoB,EAEnE,GAAe,SAAXR,GAAiC,OAAXA,IAAoBJ,GAAuB,QAAXI,GAAoBJ,EAAS,CACrF,MAAMa,EAA2BjB,EAEjC,GAAI,CAAC,OAAQ,OAAOkB,SAASlB,GAAU,CACrC,MAAMmB,EAAoB,SAAZnB,EAAqB,MAAQ,OAG3C,GAFoBc,EAAMC,OAAOI,GAAOf,OAItC,YADAO,EAASR,EAA0Bc,GAA2Bb,IAIhEJ,EAAU,MAGZ,IAAI3H,EAEAoI,GACGL,SACGpI,OAAO+I,OAAOK,IAAIC,MAAM,KAEhChJ,EAAKiJ,IACH,MAAMC,EAAWD,EAAKE,OACtBxJ,OAAO+I,OAAOU,WAAWC,KAAKH,KAGhClJ,EAAKR,IACH8I,EAAST,EAAwBF,EAASnI,KAIzCuI,SAQGpI,OAAO+I,OAAOf,GAAS2B,OAC7BhB,EAASR,EAA0Bc,GAA0B,MARxDD,IACHhJ,OAAO+I,OAAOa,iBAAiB5B,EAAS3H,GACxCsI,EApD+BX,KAAD,CACxCC,KArC4C,iCAsC5CD,YAkDmB6B,CAA2B7B,WAEhChI,OAAO+I,OAAOf,GAAS8B,QAC7BnB,EAASR,EAA0Bc,GAA0B,MAMjE,MAAO3I,GAWP,YARsB,iDAAlBA,EAAMuH,SAA8DvH,EAAMuH,WAc9EgB,EAAiB,CAACkB,EAAUvB,EAAO,SAChCE,UACL,IAAK,MAAMsB,KAAKD,QACRpB,EAASJ,EAAcyB,EAAGxB,KAgJzByB,EAAejC,GACnBU,UACL,IACE,MAAM7I,QAAgBG,OAAO+I,OAAOf,GAASkC,OAC7CvB,EAASZ,EAAkBC,EAASnI,IACpC,MAAOQ,GACP,SAKO8J,EAAe,CAACnC,EAASzE,IAC7BmF,UACL,UACQ1I,OAAO+I,OAAOf,GAASqB,MAAM9F,GACnC,MAAM1D,QAAgBG,OAAO+I,OAAOf,GAASkC,OAC7CvB,EAASZ,EAAkBC,EAASnI,IACpC,MAAOQ,GACPX,QAAQY,MAAMD,KAKP+J,EAAqBtB,GACxBH,IACNA,EAASZ,EAAkB,YAAae,KCrR5C,SAASuB,EAAiBC,EAAQC,GAChC,IAAK,MAAMC,KAAYD,EACrBE,OAAOC,eAAeJ,EAAQE,EAAU,CACtCG,cAAc,EACdpH,MAAOgH,EAAaC,KAK1B,MAAMI,EAAmB,CAACC,KAAeC,KAAe,cAAcD,EACpEE,eAAeC,GACbC,MAAMD,GACN,MAAME,EAAcC,SAASC,yBAG7BC,KAAKzB,iBAAmB,CAAC3B,KAAS+C,IACzBE,EAAYtB,iBAAiB3B,KAAS+C,GAG/CK,KAAKC,oBAAsB,IAAIN,IACtBE,EAAYI,uBAAuBN,GAG5CK,KAAKE,cAAiBC,IACpBnB,EAAiBmB,EAAO,CAACC,cAAeJ,OACnCG,EAAMlB,QACTD,EAAiBmB,EAAO,CAAClB,OAAQe,OAGnC,MAAMK,EAAc,KAAIF,EAAMvD,OACE,oBAArBoD,KAAKK,IACdL,KAAKK,GAAYF,GAGnB,MAAMG,EAAWT,EAAYK,cAAcC,GAQ3C,OANIG,GAAYN,KAAKO,YACnBP,KAAKO,WAAWL,cAAcC,GAGhCnB,EAAiBmB,EAAO,CAACC,cAAe,KAAMnB,OAAQ,OAE/CqB,MAKE,MAAME,UAAoBjB,EAAiBH,UCxB3CqB,MAnCf,cAAwBD,EACpBd,YAAYgB,GACVd,QAEAI,KAAKU,OAASA,EAIhB,WAAWC,GACT,OAAO,IAAI3M,QAASC,GAAYC,WAAWD,EAAS0M,IAGtDC,aAAahE,EAAMD,EAASkE,EAAM5B,EAASe,KAAKU,QAC9C,IAAII,EAEJ,QAAO,GACL,KAAMlE,IAASD,GAAoB,uBAATC,EACxBkE,EAAcD,EACd,MACF,QACEC,EAAc,CACZnE,UACAkE,QAON,MAAME,EAAK,IAAIC,YAAYpE,EAAM,CAACuB,OAAQ2C,IAE1C7B,EAAOiB,cAAca,KCoJZE,MApJf,MACEvB,YAAYgB,GAGVV,KAAKkB,UAAUR,GACfV,KAAKmB,UAAY,IAAIV,EAAUC,GAC/BV,KAAKoB,cAGPA,mBACkCC,IAA5B1M,OAAO2M,mBACP3M,OAAO2M,iBAAmB,SAGcD,IAAtC1M,OAAO2M,iBAAiBtB,KAAKuB,OAC/B5M,OAAO2M,iBAAiBtB,KAAKuB,KAAO,SAGeF,IAAjD1M,OAAO2M,iBAAiBtB,KAAKuB,KAAKC,aACpC7M,OAAO2M,iBAAiBtB,KAAKuB,KAAKC,YAAa,QAGUH,IAAvD1M,OAAO2M,iBAAiBtB,KAAKuB,KAAKE,mBACpC9M,OAAO2M,iBAAiBtB,KAAKuB,KAAKE,iBAAmB,SAGaJ,IAAhE1M,OAAO2M,iBAAiBtB,KAAKuB,KAAKG,4BACpC/M,OAAO2M,iBAAiBtB,KAAKuB,KAAKG,2BAA4B,QAGHL,IAAzD1M,OAAO2M,iBAAiBtB,KAAKuB,KAAKI,qBACpChN,OAAO2M,iBAAiBtB,KAAKuB,KAAKI,mBAAqB,IAI7DC,qBAAqBjF,EAASkF,GACxB7B,KAAKU,OAAOoB,gBACdnN,OAAO2M,iBAAiBtB,KAAKuB,KAAKI,mBAAmBI,KAAK,CAACpF,UAASkF,WAIxEG,0BACErN,OAAO2M,iBAAiBtB,KAAKuB,KAAKI,mBAAqB,GAGzDM,cAAcC,GACRlC,KAAKU,OAAOoB,iBACdnN,OAAO2M,iBAAiBtB,KAAKuB,KAAKC,WAAaU,EAE3CA,GACFlC,KAAKmB,UAAUP,aAAa,kBAKlCuB,gBACE,GAAInC,KAAKU,OAAOoB,eACd,OAAOnN,OAAO2M,iBAAiBtB,KAAKuB,KAAKC,WAI7CY,yBACE,GAAIpC,KAAKU,OAAOoB,eACd,OAAOnN,OAAO2M,iBAAiBtB,KAAKuB,KAAKE,iBAAiBY,OAI9DC,mBAAmBC,GACjB,GAAIvC,KAAKU,OAAOoB,gBACVnN,OAAO2M,iBAAiBtB,KAAKuB,KAAKE,iBAAiBY,QAAUE,EAC/D,OAAO5N,OAAO2M,iBAAiBtB,KAAKuB,KAAKE,iBAAiBc,GAMhEC,sBAAsBnL,GACpB,GAAI2I,KAAKU,OAAOoB,eACd,GAAIW,OAAOC,UAAUrL,GACnB1C,OAAO2M,iBAAiBtB,KAAKuB,KAAKE,iBAAiBkB,OAAOtL,EAAG,QAE7D,IAAK,IAAIuL,EAAE,EAAEA,EAAE5C,KAAKoC,yBAAyBQ,IAAK,CAChD,MAAMC,EAAK7C,KAAKsC,mBAAmBM,GAE/BvL,EAAEsF,UAAYkG,EAAGlG,SAAWtF,EAAEwK,SAAWgB,EAAGhB,SAC9C7B,KAAKwC,sBAAsBI,GAC3BA,MAOVE,QAAQnG,EAASkF,EAAQlD,GACnBqB,KAAKU,OAAOoB,iBACdnN,OAAO2M,iBAAiBtB,KAAKuB,KAAKE,iBAAiBM,KAAK,CAACpF,UAASkF,SAAQlD,MAC1EqB,KAAKmB,UAAUP,aAAa,oBAIhCmC,UACE,GAAI/C,KAAKU,OAAOoB,eACd,OAAOnN,OAAO2M,iBAAiBtB,KAAKuB,KAAKE,iBAAiBuB,QAI9DC,6BAA6Bf,GACvBlC,KAAKU,OAAOoB,iBACdnN,OAAO2M,iBAAiBtB,KAAKuB,KAAKG,0BAA4BQ,EAE1DA,GACHlC,KAAKgC,2BAKVkB,+BACE,GAAIlD,KAAKU,OAAOoB,eACd,OAAOnN,OAAO2M,iBAAiBtB,KAAKuB,KAAKG,0BAI7CyB,YACE,OAAOnD,KAAKU,OAGdQ,UAAUR,GACRV,KAAKU,OAASA,EACdV,KAAKuB,IAAMb,EAAOA,OAAOhK,GAG3B0M,qBAAqBb,GACnB,GAAIvC,KAAKU,OAAOoB,eACd,OAAOnN,OAAO2M,iBAAiBtB,KAAKuB,KAAKI,mBAAmBY,GAIhEc,2BACE,GAAIrD,KAAKU,OAAOoB,eACd,OAAOnN,OAAO2M,iBAAiBtB,KAAKuB,KAAKI,mBAAmBU,OAIhEiB,YACE3O,OAAO2M,iBAAiBtB,KAAKuB,UAAOF,IC2NzBkC,MAzWf,MACE7D,YAAYgB,EAAQ9D,GAClBoD,KAAKU,OAASA,EACdV,KAAKmB,UAAY,IAAIV,EAAUT,KAAKU,QACpCV,KAAKpD,KAAOA,GAAQoD,KAAKN,YAAY/J,KACrCqK,KAAKwD,cAAgB,IAAIC,IAG3B,iBASE,GARM,qBAAsBzD,OAG1BA,KAAKsB,iBAAmB,IAAIL,EAAiBjB,KAAKU,SAGpDV,KAAKsB,iBAAiBM,qBAAqB5B,KAAKpD,KAAM,WAEjD,cAAeoD,KAAK0D,gBAAmB1D,KAAK0D,eAAetO,UAK9D,OAJI4K,KAAKU,OAAOiD,YACdtP,QAAQC,IAAK,mCAAkC0L,KAAKpD,iBAG/C,EAGT,IAAIoD,KAAKsB,iBAAiBa,gBAkDxB,OADAnC,KAAKsB,iBAAiBwB,QAAQ9C,KAAKpD,KAAM,UAAWoD,KAAK4D,SAASC,KAAK7D,QAChE,EAjDP,IAgCE,OA/BAA,KAAKsB,iBAAiBW,eAAc,GAEpCjC,KAAK8D,QAAQA,cAAgB9D,KAAKU,OAAOqD,OAAOC,kBAAkBhE,KAAK8D,QAAQG,MAC/EjE,KAAK0D,eAAeA,qBAAuB1D,KAAK8D,QAAQA,QAAQI,kBAAkBlE,KAAK0D,eAAeO,MAEtGjE,KAAKsB,iBAAiBW,eAAc,GAEpCjC,KAAK0D,eAAetO,WAAY,EAChC4K,KAAK0D,eAAeS,WAAY,EAChCnE,KAAK0D,eAAe/F,kBAAmB,EAkBnCqC,KAAKU,OAAOiD,YACdtP,QAAQC,IAAK,oBAAmB0L,KAAKpD,iBAGhC,EACP,MAAO3H,GAYP,MAXI,qBAAsB+K,OACxBA,KAAKsB,iBAAiBW,eAAc,GACpCjC,KAAKsB,iBAAiBwB,QAAQ9C,KAAKpD,KAAM,UAAWoD,KAAK4D,SAASC,KAAK7D,QAGzEA,KAAK0D,eAAetO,WAAY,EAE5B,cAAe4K,MACjBA,KAAKmB,UAAUP,aAAa,QAASZ,KAAKpD,KAAM3H,IAG3C,GAQb,YAAYmP,GAAY,GACtB,IACE,IAAIC,EAAmB,EACnBC,EAAgB,EAChBC,GAAc,EAMlB,IAJKvE,KAAK0D,eAAetO,iBACjB4K,KAAK4D,YAGL5D,KAAK0D,eAAetO,WAAW,CAGrC,GAAyB,QAFzBiP,EAE8B,CAC5B,MAAMpP,EAAQ,IAAIuP,MAAO,iCAAgCxE,KAAKpD,sDAE9D,OADAoD,KAAKmB,UAAUP,aAAa,QAASZ,KAAKpD,KAAM3H,IACzC,QAIH+K,KAAKmB,UAAUsD,KAAK,IAK5B,GAFAzE,KAAKsB,iBAAiBM,qBAAqB5B,KAAKpD,KAAM,SAEjDoD,KAAK0E,YAAY,QAAS,CAC7B,MAAMzP,EAAQ,IAAIuP,MAAO,OAAMxE,KAAKpD,iDAEpC,OADAoD,KAAKmB,UAAUP,aAAa,QAASZ,KAAKpD,KAAM3H,IACzC,EAGT,IAAK+K,KAAK0D,eAAeiB,QAAS,CAChC,MAAM1P,EAAQ,IAAIuP,MAAM,8EAExB,OADAxE,KAAKmB,UAAUP,aAAa,QAASZ,KAAKpD,KAAM3H,IACzC,EAGT,MAAuB,IAAhBsP,GAAuB,CAG5B,GAAsB,QAFtBD,EAE2B,CACzB,MAAMrP,EAAQ,IAAIuP,MAAM,wFAExB,OADAxE,KAAKmB,UAAUP,aAAa,QAASZ,KAAKpD,KAAM3H,IACzC,EAGT,GAAI+K,KAAKsB,iBAAiBa,gBAAiB,CACzCnC,KAAKsB,iBAAiBW,eAAc,GACpC,IAAI2C,QAAa5E,KAAK0D,eAAeA,eAAemB,YACpD7E,KAAKsB,iBAAiBW,eAAc,IAElB,IAAdmC,IACFQ,QAAa5E,KAAK0D,eAAeiB,QAAQC,IAG3CL,EAAcK,aAGR5E,KAAKmB,UAAUsD,KAAK,IAI9B,OAAOF,EACP,MAAOtP,GAGP,OAFA+K,KAAKsB,iBAAiBW,eAAc,GACpCjC,KAAKmB,UAAUP,aAAa,QAASZ,KAAKpD,KAAM3H,IACzC,GAIX,aAAa2P,GACX,IACE,QAAavD,IAATuD,EAAoB,CACtB,MAAM3P,EAAQ,IAAIuP,MAAM,sCAExB,OADAxE,KAAKmB,UAAUP,aAAa,QAASZ,KAAKpD,KAAM3H,IACzC,EAGT,IAAIoP,EAAmB,EACnBS,EAAiB,EACjBP,GAAc,EAMlB,IAJKvE,KAAK0D,eAAetO,iBACjB4K,KAAK4D,YAGL5D,KAAK0D,eAAetO,WAAW,CAGrC,GAAyB,QAFzBiP,EAE8B,CAC5B,MAAMpP,EAAQ,IAAIuP,MAAO,iCAAgCxE,KAAKpD,uDAE9D,OADAoD,KAAKmB,UAAUP,aAAa,QAASZ,KAAKpD,KAAM3H,IACzC,QAIH+K,KAAKmB,UAAUsD,KAAK,IAK5B,GAFAzE,KAAKsB,iBAAiBM,qBAAqB5B,KAAKpD,KAAM,UAEjDoD,KAAK0E,YAAY,WAAa1E,KAAK0E,YAAY,wBAAyB,CAC3E,MAAMzP,EAAQ,IAAIuP,MAAO,OAAMxE,KAAKpD,0EAEpC,OADAoD,KAAKmB,UAAUP,aAAa,QAASZ,KAAKpD,KAAM3H,IACzC,EAGT,IAAK+K,KAAK0D,eAAeqB,QAAS,CAChC,MAAM9P,EAAQ,IAAIuP,MAAM,+EAExB,OADAxE,KAAKmB,UAAUP,aAAa,QAASZ,KAAKpD,KAAM3H,IACzC,EAGT,MAAuB,IAAhBsP,GAAuB,CAG5B,GAAuB,QAFvBO,EAE4B,CAC1B,MAAM7P,EAAQ,IAAIuP,MAAM,wFAExB,OADAxE,KAAKmB,UAAUP,aAAa,QAASZ,KAAKpD,KAAM3H,IACzC,EAGT,GAAI+K,KAAKsB,iBAAiBa,gBAAiB,CACzC,MAAM6C,QAAoBhF,KAAK0D,eAAeqB,QAAQH,GACtD5E,KAAKsB,iBAAiBW,eAAc,SAC9BjC,KAAK0D,eAAeA,eAAeuB,WAAWD,GACpDhF,KAAKsB,iBAAiBW,eAAc,GAGpCjC,KAAKmB,UAAUP,aAAa,QAASZ,KAAKpD,KAAMgI,GAEhDL,GAAc,aAGRvE,KAAKmB,UAAUsD,KAAK,IAI9B,OAAOF,EACP,MAAOtP,GAGP,OAFA+K,KAAKsB,iBAAiBW,eAAc,GACpCjC,KAAKmB,UAAUP,aAAa,QAASZ,KAAKpD,KAAM3H,IACzC,GAIX,cAAciQ,EAAQC,GAAS,GAC7B,IAAiB,IAAXD,IAA8B,IAAXA,EAAmB,CAC1C,MAAMjQ,EAAQ,IAAIuP,MAAM,yDAExB,YADAxE,KAAKmB,UAAUP,aAAa,QAASZ,KAAKpD,KAAM3H,GAIlD,IAAK+K,KAAK0D,eAAetO,UAAW,CAGlC,UAFwB4K,KAAK4D,WAI3B,OADA5D,KAAKsB,iBAAiBwB,QAAQ9C,KAAKpD,KAAOsI,EAAS,QAAU,OAASlF,KAAKoF,QAAQvB,KAAK7D,KAAMkF,EAAQC,KAC/F,EAMX,GAFAnF,KAAKsB,iBAAiBM,qBAAqB5B,KAAKpD,KAAOsI,EAAS,QAAU,SAErElF,KAAK0E,YAAY,YAAc1E,KAAK0E,YAAY,YAAa,CAChE,MAAMzP,EAAQ,IAAIuP,MAAO,OAAMxE,KAAKpD,wDAEpC,YADAoD,KAAKmB,UAAUP,aAAa,QAASZ,KAAKpD,KAAM3H,GAIlD,GAAIiQ,IAAWlF,KAAK0D,eAAeS,UAMjC,OALInE,KAAKU,OAAOiD,YACdtP,QAAQC,IAAK,OAAM0L,KAAKpD,4BAA6BoD,KAAK0D,eAAeS,UAAY,UAAY,6BAI5F,EAGT,IAAKnE,KAAK0D,eAAeiB,QAAS,CAChC,MAAM1P,EAAQ,IAAIuP,MAAM,gFAExB,YADAxE,KAAKmB,UAAUP,aAAa,QAASZ,KAAKpD,KAAM3H,GAIlD,MAAMoQ,EAAYhI,UAChB,IACE,MAAMY,QAAa+B,KAAK0D,eAAeiB,QAAQ3P,EAAEiK,OAAO/G,OAEpDiN,GAIFnF,KAAKmB,UAAUP,aAAaZ,KAAKpD,KAAMoD,KAAKpD,KAAMqB,GAEpD,MAAOhJ,GACP+K,KAAKmB,UAAUP,aAAa,QAASZ,KAAKpD,KAAM3H,KAI9CyO,EAAiB1D,KAAK0D,eAAeA,eAE3C,IAAI1D,KAAKsB,iBAAiBa,gBAuDxB,OADAnC,KAAKsB,iBAAiBwB,QAAQ9C,KAAKpD,KAAOsI,EAAS,QAAU,OAASlF,KAAKoF,QAAQvB,KAAK7D,KAAMkF,EAAQC,KAC/F,EArDP,GADAnF,KAAKsB,iBAAiBW,eAAc,GAChCiD,EACF,IACE,MAAMI,QAAY5B,EAAe6B,qBAcjC,OAbAvF,KAAKsB,iBAAiBW,eAAc,GAE/BjC,KAAK0D,eAAe/F,mBACvB2H,EAAI/G,iBAAiB,6BAA8B8G,EAAUxB,KAAK7D,OAClEA,KAAK0D,eAAe/F,kBAAmB,GAGzCqC,KAAK0D,eAAeS,WAAY,EAE5BnE,KAAKU,OAAOiD,YACdtP,QAAQC,IAAK,iCAAgC0L,KAAKpD,iBAG7C,EACP,MAAO3H,GAKP,OAJA+K,KAAKsB,iBAAiBW,eAAc,GACpCjC,KAAKsB,iBAAiBwB,QAAQ9C,KAAKpD,KAAOsI,EAAS,QAAU,OAASlF,KAAKoF,QAAQvB,KAAK7D,KAAMkF,EAAQC,IACtGnF,KAAK0D,eAAeS,WAAY,EAChCnE,KAAKmB,UAAUP,aAAa,QAASZ,KAAKpD,KAAM3H,IACzC,OAGT,UACoByO,EAAe8B,oBAgBjC,OAfAxF,KAAKsB,iBAAiBW,eAAc,GAEpCjC,KAAK0D,eAAeS,WAAY,EAGd,eAAdnE,KAAKpD,MACHoD,KAAKyF,UACPzF,KAAK0F,sBAIL1F,KAAKU,OAAOiD,YACdtP,QAAQC,IAAK,kCAAiC0L,KAAKpD,iBAG9C,EACP,MAAO3H,GAKP,OAJA+K,KAAKsB,iBAAiBW,eAAc,GACpCjC,KAAKsB,iBAAiBwB,QAAQ9C,KAAKpD,KAAOsI,EAAS,QAAU,OAASlF,KAAKoF,QAAQvB,KAAK7D,KAAMkF,EAAQC,IACtGnF,KAAK0D,eAAeS,WAAY,EAChCnE,KAAKmB,UAAUP,aAAa,QAASZ,KAAKpD,KAAM3H,IACzC,GASfyP,YAAYvF,GACV,OAAoE,IAA5Da,KAAK0D,eAAeA,eAAeiC,WAAWxG,GAGxD,cACE,aAAaa,KAAKoF,SAAQ,GAG5B,aACE,aAAapF,KAAKoF,SAAQ,GAG5B,aACE,aAAapF,KAAK4F,QAGpB,YAAY3H,GACV,aAAa+B,KAAK6F,OAAO5H,KCjRd6H,MAtFf,cAA2CvC,EACzC7D,YAAYgB,GACVd,MAAMc,EAAQ,yBAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAOqF,UAGpB/F,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAOsF,oBAClBrB,QAAS3E,KAAKiG,uBAAuBpC,KAAK7D,MAC1C+E,QAAS/E,KAAKkG,uBAAuBrC,KAAK7D,OAI9CiG,uBAAuBhI,GACrB,IAEE,MAAMkI,GAAe,EAOrB,MAJiC,CAC/BC,UAHkD,KAAlCnI,EAAKoI,UAAU,EAAGF,IAAuBG,QAAQ,GAIjEC,QAHctI,EAAKuI,SAAS,IAM9B,MAAOvR,GACP,MAAMA,GAIV,6BAA6BwR,GAC3B,IAEE,GAAsB,kBAAXA,EAAqB,CAE9B,MADc,IAAIjC,MAAM,qCAI1B,QAAyBnD,IAApBoF,EAAOL,eAA+C/E,IAAnBoF,EAAOF,QAAwB,CAErE,MADc,IAAIG,WAAW,gJAI/B,IAAIN,EAAWK,EAAOL,SAClBG,EAAUE,EAAOF,QAGrB,QAAiBlF,IAAb+E,EAAwB,CAC1B,GAAIA,EAAW,IAAMA,EAAW,IAAM,CAEpC,MADc,IAAIM,WAAW,0EAI/BN,GAAsB,IAGxB,QAAgB/E,IAAZkF,IACEA,EAAU,GAAKA,EAAU,KAAK,CAEhC,MADc,IAAIG,WAAW,kEAKjC,MAAMC,QAAqB3G,KAAK4F,OAAM,GAChCO,GAAe,EACrBC,EAAWA,GAAYO,EAAaN,UAAU,EAAGF,GACjDI,EAAUA,GAAWI,EAAaH,SAAS,EAAGL,GAE9C,MAAMS,EAAY,IAAIC,WAAW,GACjC,IAAK,IAAIjE,EAAI,EAAGA,EAAIgE,EAAUvE,OAAQO,IACpCgE,EAAUhE,GAAK+D,EAAaH,SAAS5D,GAOvC,OAJAgE,EAAU,GAAgB,IAAXR,EACfQ,EAAU,GAAMR,GAAY,EAAK,IACjCQ,EAAU,GAAKL,EAERK,EACP,MAAO3R,GACP,MAAMA,KC4GG6R,MA7Lf,cAAyBvD,EACvB7D,YAAYgB,EAAQqG,EAAiB,IACnCnH,MAAMc,EAAQ,cAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAOsG,UAGpBhH,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAOuG,aAClBtC,QAAS3E,KAAKkH,qBAAqBrD,KAAK7D,OAK1C,MAAMmH,EAAexS,OAAOwS,cAAgBxS,OAAOyS,mBACnDpH,KAAKyF,SAAW,IAAI0B,EAEpBnH,KAAKqH,wBAA0B,EAAE,GAAI,GAAI,GAAI,EAAG,EAAG,EAAG,EAAG,GAAI,GAAI,GAAI,GAAI,EAAG,EAAG,EAAG,EAAG,GAErFrH,KAAKsH,4BAA8B,CAAC,EAAG,EAAG,EAAG,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAClL,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KACtL,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,OAE1HtH,KAAK0F,oBAAsB1F,KAAK0F,oBAAoB7B,KAAK7D,MAG3D,kCACQA,KAAKyF,SAAS8B,UAEtBL,qBAAqB/G,GACnB,MAAMqH,EAAcrH,EAAMsH,OACpBC,EAAQ,CACZ9N,OAAQ,IAAI+N,SAASH,EAAYI,MAAM,EAAG,IAC1C3J,KAAM,IAAI0J,SAASH,EAAYI,MAAM,KAIvC,OAFqB5H,KAAK6H,aAAaH,GAKzC,+BACE,UACQ1H,KAAKU,OAAO3C,IAAI8H,OAAO,KAC7B,MAAO5Q,GACP,MAAMA,GAIV,+BAA+BgJ,GAC7B,GAAI+B,KAAK8H,mBACP,IACE,MAAMC,EAAiB9J,EAAKE,OAAOF,KAInC,SAHM+B,KAAKoF,SAAQ,GAAO,GAC1BpF,KAAKC,oBAAoB,iBAAkBD,KAAK0D,eAAesE,gBAE7B,MAA9BD,EAAeE,WAEZ,CACL5T,QAAQC,IAAIyT,EAAeE,YAC3B,MAAMjT,EAAI,IAAIwP,MAAM,sGAEpB,MADAxE,KAAKkI,YAAYlT,GACXA,QALAgL,KAAKoF,SAAQ,GAOrB,MAAOnQ,GACP,MAAMA,GAKZ4S,aAAaH,GACX,IAEE,MAAMS,EAAwBT,EAAMzJ,KAAKgK,WACnCG,EAAc,IAAIC,YAAY,KAC9BC,EAAM,IAAIX,SAASS,GACzB,IAAIG,EAKAC,EAJAC,GAAa,EACbC,EAAc,EACdC,EAAQ,EACRC,EAAO,EAIPC,EAAiBnB,EAAM9N,OAAOkP,SAAS,GAAG,GAE1CvG,EAAQmF,EAAM9N,OAAOmP,QAAQ,GAC7BxG,EAAQ,IACVA,EAAQ,GAENA,EAAQ,KACVA,EAAQ,IAEViG,EAAOxI,KAAKsH,4BAA4B/E,GACxC,IAAK,IAAIyG,EAAM,EAAGC,EAAO,EAAGD,EAAMb,EAAuBc,GAAQ,EAE3DR,GACFE,EAAsB,GAAdD,EACRM,KAGAL,GADAD,EAAchB,EAAMzJ,KAAK8K,QAAQC,KACT,EAAK,GAE/BP,GAAcA,GAEdlG,GAASvC,KAAKqH,wBAAwBsB,IAC1B,IACVpG,EAAQ,GAENA,EAAQ,KACVA,EAAQ,IAGVqG,EAAe,EAARD,EAGPJ,EAAQC,GAAQ,GACH,GAHbG,GAAgB,IAGE,IAChBJ,GAAQC,IAEG,EAARG,GAAa,IAChBJ,GAASC,GAAQ,IAEN,EAARG,GAAa,IAChBJ,GAASC,GAAQ,GAEfI,EAAO,EACTC,GAAkBN,EAElBM,GAAkBN,EAGhBM,EAAiB,MACnBA,EAAiB,MACRA,GAAkB,QAC3BA,GAAkB,OAGpBL,EAAOxI,KAAKsH,4BAA4B/E,GAExC+F,EAAIY,SAASD,EAAMJ,GAAgB,GAGrC,OAAOP,EACP,MAAOrT,GACP,MAAMA,GAIVoJ,KAAK8K,QACsB9H,IAArBrB,KAAKoJ,cACPpJ,KAAKoJ,YAAc,IAErBpJ,KAAKoJ,YAAYrH,KAAKoH,GAClBnJ,KAAKoJ,YAAY/G,QACnBrC,KAAKqJ,wBAGTA,wBACE,KAAOrJ,KAAKoJ,YAAY/G,OAAS,GAAG,CAClC,MAAMiH,EAAa,IACb7B,EAASzH,KAAKoJ,YAAYpG,QAC1BuG,EAAW,EACXC,EAAa/B,EAAOQ,WAAa,OACX5G,IAAxBrB,KAAKyJ,iBACPzJ,KAAKyJ,eAAiB,GAEI,cAAxBzJ,KAAKyF,SAAShI,OAChBuC,KAAKyF,SAASiE,SAEhB,MAAMC,EAAgB3J,KAAKyF,SAASmE,aAAaL,EAAUC,EAAY,MAEjEK,EAAeF,EAAcG,eAAe,GAClD,IAAK,IAAIlH,EAAI,EAAGA,EAAI6E,EAAOQ,WAAa,EAAGrF,IACzCiH,EAAajH,GAAK6E,EAAOqB,SAAS,EAAIlG,GAAG,GAAQ,MAEnD,MAAM9J,EAASkH,KAAKyF,SAASsE,qBAC7BjR,EAAO2O,OAASkC,EAChB7Q,EAAOkR,QAAQhK,KAAKyF,SAASwE,aACD,IAAxBjK,KAAKyJ,iBACPzJ,KAAKyJ,eAAiBzJ,KAAKyF,SAASyE,YAAcZ,GAEpDxQ,EAAO2F,MAAMuB,KAAKyJ,gBAClBzJ,KAAKyJ,gBAAkB3Q,EAAO2O,OAAO0C,YC3I5BC,MA7Cf,cAAyB7G,EACvB7D,YAAYgB,GACVd,MAAMc,EAAQ,OAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAOqF,UAGpB/F,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAO2J,qBAClB1F,QAAS3E,KAAKsK,UAAUzG,KAAK7D,MAC7B+E,QAAS/E,KAAKuK,UAAU1G,KAAK7D,OAIjCsK,UAAUE,GACR,IACE,MAAMrE,GAAe,EAGrB,OAFYqE,EAAQnE,UAAU,EAAGF,GAGjC,MAAOlR,GACP,MAAMA,GAIVsV,UAAUC,EAASC,GAAoB,GACrC,IACE,GAAID,EAAU,IAAMA,EAAU,IAAK,CAEjC,MADU,IAAIhG,MAAM,4CAItB,MAAMoC,EAAY,IAAIC,WAAW,GAIjC,OAHAD,EAAU,GAAK6D,EAAmB,EAAI,EACtC7D,EAAU,GAAe,IAAV4D,EACf5D,EAAU,GAAM4D,GAAW,EAAK,IACzB5D,EACP,MAAO3R,GACP,MAAMA,KCMGyV,MA9Cf,cAA0BnH,EACxB7D,YAAYgB,GACVd,MAAMc,EAAQ,QAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAOqF,UAGpB/F,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAOiK,cAClBhG,QAAS3E,KAAK4K,WAAW/G,KAAK7D,MAC9B+E,QAAS/E,KAAK6K,WAAWhH,KAAK7D,OAIlC4K,WAAW3M,GACT,IAME,MAHoB,CAClBtI,MAHc,IAAImV,aACCC,OAAO9M,IAK5B,MAAOhJ,GACP,MAAMA,GAIV4V,WAAW5M,GACT,IACE,GAAIA,EAAKoE,OAAS,GAChB,OAAOrO,QAAQgX,OAAO,IAAIC,UAAU,oDAEtC,MAAMC,EAAc,IAAIrE,WAAW5I,EAAKoE,QAExC,IAAK,IAAIO,EAAI,EAAGA,EAAI3E,EAAKoE,OAAQO,GAAK,EACpCsI,EAAYtI,GAAK3E,EAAKkN,WAAWvI,GAEnC,OAAOsI,EACP,MAAOjW,GACP,MAAMA,KCRGmW,MAjCf,cAAgC7H,EAC9B7D,YAAYgB,GACVd,MAAMc,EAAQ,eAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAO2K,UAGpBrL,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAO4K,cAClB3G,QAAS3E,KAAKuL,kBAAkB1H,KAAK7D,OAIzCuL,kBAAkBtN,GAChB,IAUE,MAL2B,CACzB/F,MALc+F,EAAK8K,QAAQ,GACb9K,EAAKuI,SAAS,GACU,IAItCgF,KAAM,WAIR,MAAOvW,GACP,MAAMA,KCIGwW,MAhCf,cAA6BlI,EAC3B7D,YAAYgB,GACVd,MAAMc,EAAQ,YAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAO2K,UAGpBrL,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAOgL,kBAClB/G,QAAS3E,KAAK2L,mBAAmB9H,KAAK7D,OAI1C2L,mBAAmB1N,GACjB,IACE,MAAMkI,GAAe,EAQrB,MAJsB,CACpBjO,MAJc+F,EAAK2N,UAAU,EAAGzF,GAClBlI,EAAKuI,SAAS,GACO,IAGnCgF,KAAM,OAGR,MAAOvW,GACP,MAAMA,KCqIG4W,MAhKf,cAAyBtI,EACvB7D,YAAYgB,GACVd,MAAMc,EAAQ,OAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAOoL,WAGpB9L,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAOqL,cAClBpH,QAAS3E,KAAKgM,cAAcnI,KAAK7D,MACjC+E,QAAS/E,KAAKiM,cAAcpI,KAAK7D,OAIrCgM,cAAc/N,GACZ,IACE,MAAMiO,EAAOjO,EAAKuI,SAAS,GACrBL,GAAe,EACrB,IAAIpJ,EAEJ,OAAQmP,GACR,KAAK,EACHnP,EAAS,CACPmP,KAAMA,GAER,MACF,KAAK,EACHnP,EAAS,CACPmP,KAAMA,EACNrU,EAAGoG,EAAKuI,SAAS,GACjB2F,EAAGlO,EAAKuI,SAAS,GACjB4F,EAAGnO,EAAKuI,SAAS,IAEnB,MACF,KAAK,EACHzJ,EAAS,CACPmP,KAAMA,EACN9X,MAAO6J,EAAKuI,SAAS,GACrB6F,UAAWpO,EAAKuI,SAAS,GACzB8F,MAAOrO,EAAKoI,UAAU,EAAGF,IAE3B,MACF,KAAK,EACHpJ,EAAS,CACPmP,KAAMA,EACN9X,MAAO6J,EAAKuI,SAAS,GACrB6F,UAAWpO,EAAKuI,SAAS,IAI7B,OAAOzJ,EACP,MAAO9H,GACP,MAAMA,GAIVgX,cAAchO,GACZ,IACE,IAAI2I,EAEJ,IAAK3I,EAAKiO,KAAM,CAEd,MADc,IAAI1H,MAAM,+BAI1B,OAAQvG,EAAKiO,MACb,IAAK,WACH,QAAiB7K,IAAbpD,EAAKsO,UAAoClL,IAAfpD,EAAKuO,YAAqCnL,IAAdpD,EAAKwO,KAAoB,CAEjF,MADU,IAAIjI,MAAM,gGAItB,GACEvG,EAAKsO,IAAM,GACXtO,EAAKsO,IAAM,KACXtO,EAAKuO,MAAQ,GACbvO,EAAKuO,MAAQ,KACbvO,EAAKwO,KAAO,GACZxO,EAAKwO,KAAO,IACZ,CAEA,MADU,IAAIjI,MAAM,iDAItBoC,EAAY,IAAIC,WAAW,CAAC,EAAG5I,EAAKsO,IAAKtO,EAAKuO,MAAOvO,EAAKwO,OAC1D,MAGF,IAAK,UAAW,CACd,QAAmBpL,IAAfpD,EAAK7J,YAA0CiN,IAAnBpD,EAAKoO,gBAA0ChL,IAAfpD,EAAKqO,MAAqB,CAExF,MADU,IAAI9H,MAAM,kGAItB,MAAMkI,EAAS,CAAC,MAAO,QAAS,SAAU,OAAQ,SAAU,OAAQ,SACpE,IAAIC,EAEJ,GAAID,EAAOE,QAAQ3O,EAAK7J,QAAU,EAChCuY,EAAYD,EAAOE,QAAQ3O,EAAK7J,OAAS,MACpC,MAA0B,kBAAf6J,EAAK7J,OAAuB6J,EAAK7J,MAAQ,GAAK6J,EAAK7J,MAAQ,GAEtE,CAEL,MADU,IAAIoQ,MAAO,gDAA+CkI,EAAOG,KAAK,+CAFhFF,EAAY1O,EAAK7J,MAMnB,GAAI6J,EAAKoO,UAAY,GAAKpO,EAAKoO,UAAY,IAAK,CAE9C,MADU,IAAI7H,MAAM,4DAItB,GAAIvG,EAAKqO,MAAQ,IAAMrO,EAAKqO,MAAQ,IAAO,CAEzC,MADU,IAAI9H,MAAM,4DAItBoC,EAAY,IAAIC,WAAW,CAAC,EAAG8F,EAAW1O,EAAKoO,UAAwB,IAAbpO,EAAKqO,MAAerO,EAAKqO,OAAS,EAAK,MACjG,MAGF,IAAK,UACH,QAAmBjL,IAAfpD,EAAK7J,YAA0CiN,IAAnBpD,EAAKoO,UAAyB,CAE5D,MADU,IAAI7H,MAAM,6FAItB,GAAIvG,EAAK7J,MAAQ,GAAK6J,EAAK7J,MAAQ,EAAG,CAEpC,MADU,IAAIoQ,MAAM,mFAItB,GAAIvG,EAAKoO,UAAY,GAAKpO,EAAKoO,UAAY,IAAK,CAE9C,MADU,IAAI7H,MAAM,4DAItBoC,EAAY,IAAIC,WAAW,CAAC,EAAG5I,EAAK7J,MAAO6J,EAAKoO,YAChD,MAGF,IAAK,MACHzF,EAAY,IAAIC,WAAW,CAAC,IAC5B,MAGF,QACED,EAAY,IAAIC,WAAW,CAAC,EAAG,EAAG,GAAI,OAKxC,OAAOD,EACP,MAAO3R,GACP,MAAMA,KC3HG6X,OAhCf,cAAwBvJ,EACtB7D,YAAYgB,GACVd,MAAMc,EAAQ,OAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAOqM,UAGpB/M,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAOsM,aAClBrI,QAAS3E,KAAKiN,cAAcpJ,KAAK7D,OAIrCiN,cAAchP,GACZ,IASE,MALsB,CACpBiP,UAJgBjP,EAAKuI,SAAS,GAK9B2G,MAJYlP,EAAKuI,SAAS,IAQ5B,MAAOvR,GACP,MAAMA,KCGGmY,OA9Bf,cAAwC7J,EACtC7D,YAAYgB,GACVd,MAAMc,EAAQ,uBAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAOqM,UAGpB/M,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAO2M,qBAClB1I,QAAS3E,KAAKsN,sBAAsBzJ,KAAK7D,OAI7CsN,sBAAsBrP,GACpB,IAOE,MAJsB,CACpBsP,YAHkBtP,EAAKuI,SAAS,IAOlC,MAAOvR,GACP,MAAMA,KCoBGuY,OA7Cf,cAA0CjK,EACxC7D,YAAYgB,GACVd,MAAMc,EAAQ,yBAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAOqM,UAGpB/M,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAO+M,oBAClB9I,QAAS3E,KAAK0N,qBAAqB7J,KAAK7D,OAI5C0N,qBAAqBzP,GACnB,IACE,MAAMkI,GAAe,EACrB,IAAIwH,EAAI1P,EAAK2P,SAAS,EAAGzH,IAAiB,GAAK,IAC3C9O,EAAI4G,EAAK2P,SAAS,EAAGzH,IAAiB,GAAK,IAC3C7O,EAAI2G,EAAK2P,SAAS,EAAGzH,IAAiB,GAAK,IAC3C5O,EAAI0G,EAAK2P,SAAS,GAAIzH,IAAiB,GAAK,IAChD,MAAM0H,EAAYC,KAAKC,KAAKD,KAAKE,IAAIL,EAAG,GAAKG,KAAKE,IAAI3W,EAAG,GAAKyW,KAAKE,IAAI1W,EAAG,GAAKwW,KAAKE,IAAIzW,EAAG,IAgB3F,OAdkB,IAAdsW,IACFF,GAAKE,EACLxW,GAAKwW,EACLvW,GAAKuW,EACLtW,GAAKsW,GAGe,CACpBF,IACAtW,IACAC,IACAC,KAIF,MAAOtC,GACP,MAAMA,KCZGgZ,OA5Bf,cAA2B1K,EACzB7D,YAAYgB,GACVd,MAAMc,EAAQ,UAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAOoL,WAGpB9L,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAOwN,cAClBvJ,QAAS3E,KAAKmO,iBAAiBtK,KAAK7D,OAIxCmO,iBAAiBlQ,GACf,IAKE,MAHsB,CACpB/F,MAFY+F,EAAKuI,SAAS,IAK5B,MAAOvR,GACP,MAAMA,KCwBGmZ,OA/Cf,cAAgC7K,EAC9B7D,YAAYgB,GACVd,MAAMc,EAAQ,cAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAOqF,UAGpB/F,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAO2N,qBAClB1J,QAAS3E,KAAKsO,iBAAiBzK,KAAK7D,MACpC+E,QAAS/E,KAAKuO,iBAAiB1K,KAAK7D,OAIxCsO,iBAAiBrQ,GACf,IAOE,MAHqB,CACnBuQ,OAJc,IAAI1D,aACEC,OAAO9M,IAM7B,MAAOhJ,GACP,MAAMA,GAIVsZ,iBAAiBC,GACf,IACE,GAAIA,EAAMnM,OAAS,IAAK,CAEtB,MADc,IAAImC,MAAM,gEAO1B,OAHgB,IAAIiK,aACSC,OAAOF,GAGpC,MAAOvZ,GACP,MAAMA,KCoBG0Z,OA9Df,cAA0BpL,EACxB7D,YAAYgB,GACVd,MAAMc,EAAQ,SAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAO2K,UAGpBrL,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAOkO,eAClBjK,QAAS3E,KAAK6O,gBAAgBhL,KAAK7D,OAIvC6O,gBAAgB5Q,GACd,IACE,MAAMkI,GAAe,EACftO,EAAIoG,EAAKoI,UAAU,EAAGF,GACtBgG,EAAIlO,EAAKoI,UAAU,EAAGF,GACtBiG,EAAInO,EAAKoI,UAAU,EAAGF,GACtB2I,EAAI7Q,EAAKoI,UAAU,EAAGF,GAItB4I,EAAe,IAGrB,IAAIC,GAAmBF,EAAIC,IAFN,IACYA,GAG7BC,EAAkB,IACpBA,EAAkB,GAGpB,IAAIzC,EAAe,KAZJ1U,GAAKA,EAAIsU,EAAIC,IAYD,EAAI4C,EAC3BzC,EAAM,MACRA,EAAM,KAGR,IAAIC,EAAiB,KAhBNL,GAAKtU,EAAIsU,EAAIC,IAgBC,EAAI4C,EAC7BxC,EAAQ,MACVA,EAAQ,KAGV,IAAIC,EAAgB,KApBLL,GAAKvU,EAAIsU,EAAIC,IAoBA,EAAI4C,EAWhC,OAVIvC,EAAO,MACTA,EAAO,KAGa,CACpBF,IAAK0C,SAAS1C,EAAIjG,QAAQ,IAC1BkG,MAAOyC,SAASzC,EAAMlG,QAAQ,IAC9BmG,KAAMwC,SAASxC,EAAKnG,QAAQ,KAI9B,MAAOrR,GACP,MAAMA,KCmEGia,OA5Hf,cAA0C3L,EACxC7D,YAAYgB,GACVd,MAAMc,EAAQ,wBAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAOqF,UAGpB/F,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAOyO,qBAClBxK,QAAS3E,KAAKoP,sBAAsBvL,KAAK7D,MACzC+E,QAAS/E,KAAKqP,sBAAsBxL,KAAK7D,OAI7CoP,sBAAsBnR,GACpB,IAEE,MAAMkI,GAAe,EAarB,MANe,CACbmJ,YAPwD,KAAlCrR,EAAKoI,UAAU,EAAGF,GAQxCoJ,YAPwD,KAAlCtR,EAAKoI,UAAU,EAAGF,GAQxCqJ,aAPmBvR,EAAKoI,UAAU,EAAGF,GAQrCI,QAL2D,GAAlCtI,EAAKoI,UAAU,EAAGF,IAQ7C,MAAOlR,GACP,MAAMA,GAIV,4BAA4BwR,GAC1B,IACE,GAAsB,kBAAXA,EAAqB,CAE9B,MADc,IAAIjC,MAAM,qCAI1B,QAAwBnD,IAAnBoF,EAAOF,cAAmDlF,IAAxBoF,EAAO+I,mBAAuDnO,IAAvBoF,EAAO6I,kBAAsDjO,IAAvBoF,EAAO8I,YAA4B,CAErJ,MADc,IAAI/K,MAAM,mIAI1B,IAAI+B,EAAUE,EAAOF,QACjBiJ,EAAe/I,EAAO+I,aACtBF,EAAc7I,EAAO6I,YACrBC,EAAc9I,EAAO8I,YAGzB,QAAgBlO,IAAZkF,EAAuB,CACzB,GAAIA,EAAU,KAAOA,EAAU,KAAO,CAEpC,MADc,IAAI/B,MAAM,0EAI1B+B,EAAUuH,KAAK2B,MAAMlJ,EAAU,IAGjC,QAAqBlF,IAAjBmO,IACEA,EAAe,GAAKA,EAAe,KAAK,CAE1C,MADc,IAAIhL,MAAM,8EAK5B,QAAoBnD,IAAhBiO,EAA2B,CAC7B,GAAIA,EAAc,KAAOA,EAAcC,EAAa,CAElD,MADc,IAAI/K,MAAM,uFAI1B8K,EAAcxB,KAAK2B,MAAoB,GAAdH,GAG3B,QAAoBjO,IAAhBkO,EAA2B,CAC7B,GAAIA,EAAc,KAAQA,EAAcD,EAAa,CAEnD,MADc,IAAI9K,MAAM,sFAI1B+K,EAAczB,KAAK2B,MAAoB,GAAdF,GAG3B,MAAM5I,QAAqB3G,KAAK4F,OAAM,GAChCO,GAAe,EAOrB,GANAmJ,EAAcA,GAAe3I,EAAaN,UAAU,EAAGF,GACvDoJ,EAAcA,GAAe5I,EAAaN,UAAU,EAAGF,GACvDqJ,EAAeA,GAAgB7I,EAAaN,UAAU,EAAGF,GAI3C,GAHdI,EAAUA,GAAWI,EAAaN,UAAU,EAAGF,KAG5B,EAAIqJ,GAAgBD,EAAa,CAElD,MADc,IAAI/K,MAAM,+JAI1B,MAAMoC,EAAY,IAAIC,WAAW,GACjC,IAAK,IAAIjE,EAAI,EAAGA,EAAIgE,EAAUvE,OAAQO,IACpCgE,EAAUhE,GAAK+D,EAAaH,SAAS5D,GAYvC,OATAgE,EAAU,GAAmB,IAAd0I,EACf1I,EAAU,GAAM0I,GAAe,EAAK,IACpC1I,EAAU,GAAmB,IAAd2I,EACf3I,EAAU,GAAM2I,GAAe,EAAK,IACpC3I,EAAU,GAAoB,IAAf4I,EACf5I,EAAU,GAAM4I,GAAgB,EAAK,IACrC5I,EAAU,GAAe,IAAVL,EACfK,EAAU,GAAML,GAAW,EAAK,IAEzBK,EACP,MAAO3R,GACP,MAAMA,KCtFGya,OAjCf,cAA8BnM,EAC5B7D,YAAYgB,GACVd,MAAMc,EAAQ,YAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAOqF,UAGpB/F,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAOiP,gBAClBhL,QAAS3E,KAAK4P,sBAAsB/L,KAAK7D,OAI7C4P,sBAAsB3R,GACpB,IAUE,MAJuB,CACrB4R,SAHe,IAHH5R,EAAKuI,SAAS,MACdvI,EAAKuI,SAAS,MACdvI,EAAKuI,SAAS,MAQ5B,MAAOvR,GACP,MAAMA,KCSG6a,OArCf,cAAwBvM,EACtB7D,YAAYgB,GACVd,MAAMc,EAAQ,OAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAO2K,UAGpBrL,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAOqP,aAClBpL,QAAS3E,KAAKgQ,cAAcnM,KAAK7D,OAIrCgQ,cAAc/R,GACZ,IACE,MAAMkI,GAAe,EAarB,MAVsB,CACpB8J,KAAM,CACJ/X,MAJS+F,EAAKoI,UAAU,EAAGF,GAK3BqF,KAAM,OAER0E,KAAM,CACJhY,MAPS+F,EAAKoI,UAAU,EAAGF,GAQ3BqF,KAAM,QAIV,MAAOvW,GACP,MAAMA,KCAGkb,OAhCf,cAAkC5M,EAChC7D,YAAYgB,GACVd,MAAMc,EAAQ,iBAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAOqM,UAGpB/M,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAO0P,iBAClBzL,QAAS3E,KAAKqQ,wBAAwBxM,KAAK7D,OAI/CqQ,wBAAwBpS,GACtB,IASE,MAJsB,CACpB/F,MAAO,CAACb,EALA4G,EAAKqS,WAAW,GAAG,GAKbhZ,EAJN2G,EAAKqS,WAAW,GAAG,GAIP/Y,EAHZ0G,EAAKqS,WAAW,GAAG,KAO7B,MAAOrb,GACP,MAAMA,KCIGsb,OA/Bf,cAA6BhN,EAC3B7D,YAAYgB,GACVd,MAAMc,EAAQ,YAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAO2K,UAGpBrL,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAO8P,kBAClB7L,QAAS3E,KAAKyQ,mBAAmB5M,KAAK7D,OAI1CyQ,mBAAmBxS,GACjB,IAQE,MALsB,CACpB/F,MAHe+F,EAAKuI,SAAS,GAI7BgF,KAAM,KAIR,MAAOvW,GACP,MAAMA,KCUGyb,OApCf,cAAgCnN,EAC9B7D,YAAYgB,GACVd,MAAMc,EAAQ,eAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAOqM,UAGpB/M,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAOiQ,cAClBhM,QAAS3E,KAAK4Q,eAAe/M,KAAK7D,OAItC4Q,eAAe3S,GACb,IACE,MAAMkI,GAAe,EAYrB,MARsB,CACpBgH,MAJYlP,EAAK2N,UAAU,EAAGzF,GAK9BpS,KAAM,CACJmE,MALS+F,EAAK2N,UAAU,EAAGzF,GAM3BqF,KAAM,OAKV,MAAOvW,GACP,MAAMA,KC6BG4b,OA5Df,cAA4BtN,EAC1B7D,YAAYgB,GACVd,MAAMc,EAAQ,WAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAOqM,UAGpB/M,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAOoQ,aAClBnM,QAAS3E,KAAK+Q,kBAAkBlN,KAAK7D,OAIzC+Q,kBAAkB9S,GAChB,IACE,MAAMkI,GAAe,EAoCrB,MArBsB,CACpB6K,cAAe,CACb3Z,EAhBS4G,EAAK6K,SAAS,EAAG3C,GAAgB,GAiB1C7O,EAhBS2G,EAAK6K,SAAS,EAAG3C,GAAgB,GAiB1C5O,EAhBS0G,EAAK6K,SAAS,EAAG3C,GAAgB,GAiB1CqF,KAAM,KAERyF,UAAW,CACT5Z,EAjBU4G,EAAK6K,SAAS,EAAG3C,GAAgB,KAkB3C7O,EAjBU2G,EAAK6K,SAAS,EAAG3C,GAAgB,KAkB3C5O,EAjBU0G,EAAK6K,SAAS,GAAI3C,GAAgB,KAkB5CqF,KAAM,SAER0F,QAAS,CACP7Z,EAlBa4G,EAAK6K,SAAS,GAAI3C,GAAgB,KAmB/C7O,EAlBa2G,EAAK6K,SAAS,GAAI3C,GAAgB,KAmB/C5O,EAlBa0G,EAAK6K,SAAS,GAAI3C,GAAgB,KAmB/CqF,KAAM,eAKV,MAAOvW,GACP,MAAMA,KCnBGkc,OApCf,cAAqC5N,EACnC7D,YAAYgB,GACVd,MAAMc,EAAQ,oBAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAOqM,UAGpB/M,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAO0Q,eAClBzM,QAAS3E,KAAKqR,gBAAgBxN,KAAK7D,OAIvCqR,gBAAgBpT,GACd,IACE,MAAMkI,GAAe,EAYrB,MANsB,CACpBmL,KALWrT,EAAK2P,SAAS,EAAGzH,GAAgB,MAM5CoL,MALYtT,EAAK2P,SAAS,EAAGzH,GAAgB,MAM7CqL,IALUvT,EAAK2P,SAAS,EAAGzH,GAAgB,OAS7C,MAAOlR,GACP,MAAMA,KCUGwc,OAzCf,cAA8ClO,EAC5C7D,YAAYgB,GACVd,MAAMc,EAAQ,6BAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAOqM,UAGpB/M,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAOgR,oBAClB/M,QAAS3E,KAAK2R,mBAAmB9N,KAAK7D,OAI1C2R,mBAAmB1T,GACjB,IAkBE,MANsB,CACpB2T,KAAM,CAXK3T,EAAK6K,SAAS,GAAG,GAAQ,EACzB7K,EAAK6K,SAAS,GAAG,GAAQ,EACzB7K,EAAK6K,SAAS,GAAG,GAAQ,GAUpC+I,KAAM,CATK5T,EAAK6K,SAAS,GAAG,GAAQ,EACzB7K,EAAK6K,SAAS,GAAG,GAAQ,EACzB7K,EAAK6K,SAAS,GAAG,GAAQ,GAQpCgJ,KAAM,CAPK7T,EAAK6K,SAAS,GAAG,GAAQ,EACzB7K,EAAK6K,SAAS,GAAG,GAAQ,EACzB7K,EAAK6K,SAAS,GAAG,GAAQ,IAStC,MAAO7T,GACP,MAAMA,KCLG8c,OA/Bf,cAA4BxO,EAC1B7D,YAAYgB,GACVd,MAAMc,EAAQ,WAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAOqM,UAGpB/M,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAOsR,iBAClBrN,QAAS3E,KAAKiS,kBAAkBpO,KAAK7D,OAIzCiS,kBAAkBhU,GAChB,IACE,MAAMkI,GAAe,EAOrB,MAJsB,CACpB+L,QAHcjU,EAAK2P,SAAS,EAAGzH,GAAgB,OAOjD,MAAOlR,GACP,MAAMA,KC4FGkd,OAtHf,cAAkC5O,EAChC7D,YAAYgB,GACVd,MAAMc,EAAQ,aAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAOqF,UAGpB/F,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAO0R,mBAClBzN,QAAS3E,KAAKqS,oBAAoBxO,KAAK7D,MACvC+E,QAAS/E,KAAKsS,oBAAoBzO,KAAK7D,OAI3CqS,oBAAoBpU,GAClB,IAEE,MACMsU,EAAiB,CACrB,QACA,QACA,QACA,QACA,SACA,QACA,QACA,OACA,OACA,OACA,OACA,QACA,OACA,QAEIC,EAjBc,CAAC,cAAe,eAAgB,UAAW,YAiBpCvU,EAAKuI,SAAS,IAEzC,IAAIiM,GADY,IAAI3H,aACFC,OAAO9M,GASzB,OARAwU,EAAMD,EAASC,EAAI7K,MAAM,GAEzB2K,EAAeG,QAAQ,CAACC,EAAS/P,MACc,IAAzC6P,EAAI7F,QAAQgG,OAAOC,aAAajQ,MAClC6P,EAAMA,EAAIK,QAAQF,OAAOC,aAAajQ,GAAI2P,EAAe3P,OAItD,IAAImQ,IAAIN,GACf,MAAOxd,GACP,MAAMA,GAIVqd,oBAAoBrU,GAClB,IAEE,MAAMwU,EAAM,IAAIM,IAAI9U,GAKd+U,EAAc,CAAC,cAAe,eAAgB,UAAW,YACzDT,EAAiB,CACrB,QACA,QACA,QACA,QACA,SACA,QACA,QACA,OACA,OACA,OACA,OACA,QACA,OACA,QAGF,IAAIU,EAAa,KACbC,EAAgB,KAChBC,EAAeV,EAAIW,KACnBC,EAAMF,EAAa9Q,OAkBvB,GAhBA2Q,EAAYN,QAAQ,CAACC,EAAS/P,MACO,IAA/B6P,EAAIW,KAAKxG,QAAQ+F,IAAkC,OAAfM,IACtCA,EAAaL,OAAOC,aAAajQ,GACjCuQ,EAAeA,EAAaL,QAAQH,EAASM,GAC7CI,GAAOV,EAAQtQ,UAInBkQ,EAAeG,QAAQ,CAACC,EAAS/P,MACI,IAA/B6P,EAAIW,KAAKxG,QAAQ+F,IAAqC,OAAlBO,IACtCA,EAAgBN,OAAOC,aAAajQ,GACpCuQ,EAAeA,EAAaL,QAAQH,EAASO,GAC7CG,GAAOV,EAAQtQ,UAIfgR,EAAM,GAAKA,EAAM,GAAI,CAEvB,MADc,IAAI7O,MAAM,qGAI1B,MAAM8O,EAAY,IAAIzM,WAAWsM,EAAa9Q,QAE9C,IAAK,IAAIO,EAAI,EAAGA,EAAIuQ,EAAa9Q,OAAQO,IACvC0Q,EAAU1Q,GAAKuQ,EAAahI,WAAWvI,GAGzC,OAAO0Q,EACP,MAAOre,GACP,MAAMA,KCiDGse,OAlKf,cAA8ChQ,EAC5C7D,YAAYgB,GACVd,MAAMc,EAAQ,4BAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAO2K,UAGpBrL,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAO8S,gBAClB7O,QAAS3E,KAAKyT,iBAAiB5P,KAAK7D,MACpC+E,QAAS/E,KAAK0T,iBAAiB7P,KAAK7D,OAIxCyT,iBAAiBxV,GACf,IACE,MAAMkI,GAAe,EACfwN,EAAsB1V,EAAKoI,UAAU,EAAGF,GACxCyN,EAAmB3V,EAAKoI,UAAU,EAAGF,GACrC0N,EAAmB5V,EAAKoI,UAAU,EAAGF,GACrC2N,EAAgB7V,EAAKoI,UAAU,EAAGF,GACxC,IAAI4N,EAAc9V,EAAKuI,SAAS,GAChC,MAAMwN,EAAiB/V,EAAKuI,SAAS,GAC/ByN,EAAmBhW,EAAKuI,SAAS,IACjC0N,EAAkBjW,EAAKuI,SAAS,IAuBtC,OArBoB,IAAhBuN,EACFA,EAAc,EACW,IAAhBA,EACTA,EAAc,GACW,IAAhBA,IACTA,EAAc,IAGM,CACpBJ,oBAAqBA,EACrBC,iBAAkBA,EAClBC,iBAAkBA,EAClBC,cAAeA,EACfC,YAAaA,EACbI,uBAAwB,CACtB5H,IAAKyH,EACLxH,MAAOyH,EACPxH,KAAMyH,IAKV,MAAOjf,GACP,MAAMA,GAIV,uBAAuBwR,GACrB,IACE,GAAsB,kBAAXA,EACT,OAAOzS,QAAQgX,OAAO,IAAIC,UAAU,sCAGtC,QAAoC5J,IAA/BoF,EAAOkN,0BAAmEtS,IAA5BoF,EAAOmN,uBAAgEvS,IAA5BoF,EAAOoN,uBAA6DxS,IAAzBoF,EAAOqN,oBAAwDzS,IAAvBoF,EAAOsN,kBAAiE1S,IAAlCoF,EAAO0N,uBAC5N,OAAOngB,QAAQgX,OAAO,IAAIC,UAAU,oMAGtC,IAAI0I,EAAsBlN,EAAOkN,oBAC7BC,EAAmBnN,EAAOmN,iBAC1BC,EAAmBpN,EAAOoN,iBAC1BC,EAAgBrN,EAAOqN,cACvBC,EAActN,EAAOsN,YACzB,MAAMI,EAAyB1N,EAAO0N,uBAEtC,QAA4B9S,IAAxBsS,IACEA,EAAsB,KAAOA,EAAsB,KACrD,OAAO3f,QAAQgX,OAAO,IAAItE,WAAW,qFAIzC,QAAyBrF,IAArBuS,IACEA,EAAmB,IAAMA,EAAmB,KAC9C,OAAO5f,QAAQgX,OAAO,IAAItE,WAAW,iFAIzC,QAAyBrF,IAArBwS,IACEA,EAAmB,KAAOA,EAAmB,KAC/C,OAAO7f,QAAQgX,OAAO,IAAItE,WAAW,kFAIzC,QAAsBrF,IAAlByS,IACEA,EAAgB,KAAOA,EAAgB,KACzC,OAAO9f,QAAQgX,OAAO,IAAItE,WAAW,+EAIzC,QAAoBrF,IAAhB0S,EACF,GAAoB,IAAhBA,EACFA,EAAc,OACT,GAAoB,KAAhBA,EACTA,EAAc,MACT,IAAoB,KAAhBA,EAEJ,CAEL,MADU,IAAIrN,WAAW,mEAFzBqN,EAAc,EAOlB,IAAIC,EACAC,EACAC,EACJ,QAA+B7S,IAA3B8S,EAAsC,CACxC,GAAsC,kBAA3BA,EACT,OAAOngB,QAAQgX,OAAO,IAAIC,UAAU,6DAEtC,QAAmC5J,IAA/B8S,EAAuB5H,UAAsDlL,IAAjC8S,EAAuB3H,YAAuDnL,IAAhC8S,EAAuB1H,KACnH,OAAOzY,QAAQgX,OAAO,IAAIC,UAAU,qGAGtC+I,EAAiBG,EAAuB5H,IACxC0H,EAAmBE,EAAuB3H,MAC1C0H,EAAkBC,EAAuB1H,KAI3C,MAAM9F,QAAqB3G,KAAK4F,OAAM,GAChCO,GAAe,EACrBwN,EAAsBA,GAAuBhN,EAAaN,UAAU,EAAGF,GACvEyN,EAAmBA,GAAoBjN,EAAaN,UAAU,EAAGF,GACjE0N,EAAmBA,GAAoBlN,EAAaN,UAAU,EAAGF,GACjE2N,EAAgBA,GAAiBnN,EAAaN,UAAU,EAAGF,GAC3D4N,EAAcA,GAAepN,EAAaH,SAAS,GACnDwN,EAAiBA,GAAkBrN,EAAaH,SAAS,GACzDyN,EAAmBA,GAAmBtN,EAAaH,SAAS,IAC5D0N,EAAkBA,GAAmBvN,EAAaH,SAAS,IAE3D,MAAMI,EAAY,IAAIC,WAAW,IACjC,IAAK,IAAIjE,EAAI,EAAGA,EAAIgE,EAAUvE,OAAQO,IACpCgE,EAAUhE,GAAK+D,EAAaH,SAAS5D,GAgBvC,OAbAgE,EAAU,GAA2B,IAAtB+M,EACf/M,EAAU,GAAM+M,GAAuB,EAAK,IAC5C/M,EAAU,GAAwB,IAAnBgN,EACfhN,EAAU,GAAMgN,GAAoB,EAAK,IACzChN,EAAU,GAAwB,IAAnBiN,EACfjN,EAAU,GAAMiN,GAAoB,EAAK,IACzCjN,EAAU,GAAqB,IAAhBkN,EACflN,EAAU,GAAMkN,GAAiB,EAAK,IACtClN,EAAU,GAAKmN,EACfnN,EAAU,GAAKoN,EACfpN,EAAU,IAAMqN,EAChBrN,EAAU,IAAMsN,EAETtN,EACP,MAAO3R,GACP,MAAMA,KCpCGmf,OAzHf,cAAyC7Q,EACvC7D,YAAYgB,GACVd,MAAMc,EAAQ,uBAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAOqM,UAGpB/M,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAO2T,gBAClB1P,QAAS3E,KAAKyT,iBAAiB5P,KAAK7D,MACpC+E,QAAS/E,KAAK0T,iBAAiB7P,KAAK7D,OAIxCyT,iBAAiBxV,GACf,IACE,MAAMkI,GAAe,EAerB,MARsB,CACpBmO,oBAP0BrW,EAAKoI,UAAU,EAAGF,GAQ5CoO,yBAP+BtW,EAAKoI,UAAU,EAAGF,GAQjDqO,mBAPyBvW,EAAKoI,UAAU,EAAGF,GAQ3CsO,uBAP6BxW,EAAKoI,UAAU,EAAGF,GAQ/CuO,aAPmBzW,EAAKuI,SAAS,IAWnC,MAAOvR,GACP,MAAMA,GAIV,uBAAuBwR,GACrB,IACE,GAAsB,kBAAXA,EACT,OAAOzS,QAAQgX,OAAO,IAAIC,UAAU,sCAGtC,QAAoC5J,IAA/BoF,EAAO6N,0BAA2EjT,IAApCoF,EAAO8N,+BAA0ElT,IAA9BoF,EAAO+N,yBAAwEnT,IAAlCoF,EAAOgO,6BAAkEpT,IAAxBoF,EAAOiO,aACzM,OAAO1gB,QAAQgX,OAAO,IAAIC,UAAU,8LAGtC,IAAIqJ,EAAsB7N,EAAO6N,oBAC7BC,EAA2B9N,EAAO8N,yBAClCC,EAAqB/N,EAAO+N,mBAC5BC,EAAyBhO,EAAOgO,uBAChCC,EAAejO,EAAOiO,aAE1B,QAA4BrT,IAAxBiT,IACEA,EAAsB,KAAOA,EAAsB,KACrD,OAAOtgB,QAAQgX,OAAO,IAAItE,WAAW,oEAIzC,QAAiCrF,IAA7BkT,IACEA,EAA2B,KAAOA,EAA2B,KAC/D,OAAOvgB,QAAQgX,OAAO,IAAItE,WAAW,gFAIzC,QAA2BrF,IAAvBmT,IACEA,EAAqB,KAAOA,EAAqB,KACnD,OAAOxgB,QAAQgX,OAAO,IAAItE,WAAW,iFAIzC,QAA+BrF,IAA3BoT,IACEA,EAAyB,GAAKA,EAAyB,KACzD,OAAOzgB,QAAQgX,OAAO,IAAItE,WAAW,4EAIzC,QAAqBrF,IAAjBqT,EAA4B,CAC9B,GAA4B,mBAAjBA,EACT,OAAO1gB,QAAQgX,OAAO,IAAItE,WAAW,wCAEvCgO,EAAeA,EAAe,EAAI,EAGpC,MAAM/N,QAAqB3G,KAAK4F,OAAM,GAChCO,GAAe,EACrBmO,EAAsBA,GAAuB3N,EAAaN,UAAU,EAAGF,GACvEoO,EAA2BA,GAA4B5N,EAAaN,UAAU,EAAGF,GACjFqO,EAAqBA,GAAsB7N,EAAaN,UAAU,EAAGF,GACrEsO,EAAyBA,GAA0B9N,EAAaN,UAAU,EAAGF,QAIxD9E,IAAjBqT,IACFA,EAAe/N,EAAaH,SAAS,IAGvC,MAAMI,EAAY,IAAIC,WAAW,GACjC,IAAK,IAAIjE,EAAI,EAAGA,EAAIgE,EAAUvE,OAAQO,IACpCgE,EAAUhE,GAAK+D,EAAaH,SAAS5D,GAavC,OAVAgE,EAAU,GAA2B,IAAtB0N,EACf1N,EAAU,GAAM0N,GAAuB,EAAK,IAC5C1N,EAAU,GAAgC,IAA3B2N,EACf3N,EAAU,GAAM2N,GAA4B,EAAK,IACjD3N,EAAU,GAA0B,IAArB4N,EACf5N,EAAU,GAAM4N,GAAsB,EAAK,IAC3C5N,EAAU,GAA8B,IAAzB6N,EACf7N,EAAU,GAAM6N,GAA0B,EAAK,IAC/C7N,EAAU,GAAK8N,EAER9N,EACP,MAAO3R,GACP,MAAMA,KC1CG0f,OA1Ef,cAAwCpR,EACtC7D,YAAYgB,GACVd,MAAMc,EAAQ,sBAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAOsG,UAGpBhH,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAOkU,gBAClBjQ,QAAS3E,KAAK6U,6BAA6BhR,KAAK7D,MAChD+E,QAAS/E,KAAK8U,6BAA6BjR,KAAK7D,OAIpD6U,6BAA6B5W,GAC3B,IAOE,MAJkC,CAChC8W,YAHkB9W,EAAKuI,SAAS,GAIhCwO,eAHqB/W,EAAKuI,SAAS,IAMrC,MAAOvR,GACP,MAAMA,GAIV,mCAAmCgJ,GACjC,IACE,GAAoB,kBAATA,EACT,OAAOjK,QAAQgX,OAAO,IAAIC,UAAU,sCAGtC,QAA0B5J,IAArBpD,EAAK8W,kBAAuD1T,IAAxBpD,EAAK+W,eAC5C,OAAOhhB,QAAQgX,OAAO,IAAIC,UAAU,yGAGtC,IAAI8J,EAAc9W,EAAK8W,YACnBC,EAAiB/W,EAAK+W,eAE1B,QAAoB3T,IAAhB0T,GACoB,IAAhBA,GAAqC,IAAhBA,GAAqC,IAAhBA,EAC9C,OAAO/gB,QAAQgX,OAAO,IAAItE,WAAW,4DAIzC,QAAuBrF,IAAnB2T,GACuB,IAAnBA,GAA2C,IAAnBA,EAC5B,OAAOhhB,QAAQgX,OAAO,IAAItE,WAAW,4DAIzC,MAAMC,QAAqB3G,KAAK4F,OAAM,GACtCmP,EAAcA,GAAepO,EAAaH,SAAS,GACnDwO,EAAiBA,GAAkBrO,EAAaH,SAAS,GAEzD,MAAMI,EAAY,IAAIC,WAAW,GACjC,IAAK,IAAIjE,EAAI,EAAGA,EAAIgE,EAAUvE,OAAQO,IACpCgE,EAAUhE,GAAK+D,EAAaH,SAAS5D,GAMvC,OAHAgE,EAAU,GAAmB,IAAdmO,EACfnO,EAAU,GAAsB,IAAjBoO,EAERpO,EACP,MAAO3R,GACP,MAAMA,KCpBGggB,OAhDf,cAAiC1R,EAC/B7D,YAAYgB,GACVd,MAAMc,EAAQ,eAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAOsG,UAGpBhH,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAOwU,sBAClBnQ,QAAS/E,KAAKmV,kBAAkBtR,KAAK7D,OAGvCA,KAAKoV,0BAA4B,IAAIT,GAA0B3U,MAGjE,wBAAwB/B,GACtB,IACE,GAAkB,IAAdA,EAAKiO,KAAY,CACnB,MAAMtF,EAAY,IAAIC,WAAW,GAC3BwO,EAAYpX,EAAKoX,UACjBlL,EAAWlM,EAAKkM,SAChBmL,EAASrX,EAAKqX,OAQpB,OANA1O,EAAU,GAAiB,IAAZyO,EACfzO,EAAU,GAAMyO,GAAa,EAAK,IAClCzO,EAAU,GAAgB,IAAXuD,EACfvD,EAAU,GAAMuD,GAAY,EAAK,IACjCvD,EAAU,GAAc,IAAT0O,EAER1O,EACF,GAAkB,IAAd3I,EAAKiO,KACd,OAAOjO,EAAKA,KACP,GAAkB,IAAdA,EAAKiO,KAAY,CAC1B,MAAMtF,EAAY,IAAIC,WAAW,GAC3B0O,EAAStX,EAAKsX,OAIpB,OAFA3O,EAAU,GAAc,IAAT2O,EAER3O,GAET,MAAO3R,GACP,MAAMA,KCdGugB,OA9Bf,cAAmCjS,EACjC7D,YAAYgB,GACVd,MAAMc,EAAQ,iBAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAOsG,UAGpBhH,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAO+U,sBAClB9Q,QAAS3E,KAAK0V,oBAAoB7R,KAAK7D,OAI3C0V,oBAAoBzX,GAClB,IAOE,MAJ6B,CAC3BlB,OAHoBkB,EAAK8K,QAAQ,IAOnC,MAAO9T,GACP,MAAMA,KCKG0gB,OA9Bf,cAA6BpS,EAC3B7D,YAAYgB,GACVd,MAAMc,EAAQ,WAGdV,KAAK8D,QAAU,CACbG,KAAM,mBAGRjE,KAAK0D,eAAiB,CACpBO,KAAM,gBACNU,QAAS3E,KAAK4V,oBAAoB/R,KAAK7D,OAI3C4V,oBAAoB3X,GAClB,IAOE,MAJ6B,CAC3BlB,OAHoBkB,EAAK8K,QAAQ,IAOnC,MAAO9T,GACP,MAAMA,KCcG4gB,OAvCf,cAAqCtS,EACnC7D,YAAYgB,GACVd,MAAMc,EAAQ,sBAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAOoV,UAGpB9V,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAOqV,8BAClBpR,QAAS3E,KAAKgW,cAAcnS,KAAK7D,MACjC+E,QAAS/E,KAAKiW,cAAcpS,KAAK7D,OAIrCgW,cAAc/X,GACZ,IAKE,MAHmB,CACjB/F,MAFY+F,EAAKuI,SAAS,IAK5B,MAAOvR,GACP,MAAMA,GAIVghB,cAAchY,GACZ,IACE,MAAM2I,EAAY,IAAIC,WAAW,GAEjC,OADAD,EAAU,GAAY,IAAP3I,EACR2I,EACP,MAAO3R,GACP,MAAMA,KCKG4gB,OAvCf,cAAqCtS,EACnC7D,YAAYgB,GACVd,MAAMc,EAAQ,sBAGdV,KAAK8D,QAAU,CACbG,KAAMjE,KAAKU,OAAOoV,UAGpB9V,KAAK0D,eAAiB,CACpBO,KAAMjE,KAAKU,OAAOwV,8BAClBvR,QAAS3E,KAAKgW,cAAcnS,KAAK7D,MACjC+E,QAAS/E,KAAKiW,cAAcpS,KAAK7D,OAIrCgW,cAAc/X,GACZ,IAKE,MAHmB,CACjB/F,MAFY+F,EAAKuI,SAAS,IAK5B,MAAOvR,GACP,MAAMA,GAIVghB,cAAchY,GACZ,IACE,MAAM2I,EAAY,IAAIC,WAAW,GAEjC,OADAD,EAAU,GAAY,IAAP3I,EACR2I,EACP,MAAO3R,GACP,MAAMA,KC2RGkhB,OA3Rf,cAAqB3V,EACnBd,YAAY0W,EAAU,CAACzS,YAAY,IACjC/D,QAEAI,KAAK2D,WAAayS,EAAQzS,WAC1B3D,KAAK5K,WAAY,EAEb4K,KAAK2D,YACPtP,QAAQC,IAAI,eAId0L,KAAK+F,SAAW,uCAChB/F,KAAK2K,cAAgB,uCACrB3K,KAAKgG,oBAAsB,uCAC3BhG,KAAKmP,qBAAuB,uCAC5BnP,KAAKoS,mBAAqB,uCAC1BpS,KAAKqO,qBAAuB,uCAC5BrO,KAAK2P,gBAAkB,uCACvB3P,KAAKqK,qBAAuB,uCAG5BrK,KAAKqL,SAAW,uCAChBrL,KAAKsL,cAAgB,uCACrBtL,KAAK0L,kBAAoB,uCACzB1L,KAAKwQ,kBAAoB,uCACzBxQ,KAAK+P,aAAe,uCACpB/P,KAAK4O,eAAiB,uCACtB5O,KAAKwT,gBAAkB,uCAGvBxT,KAAK8L,UAAY,uCACjB9L,KAAK+L,cAAgB,uCACrB/L,KAAKkO,cAAgB,uCACrBlO,KAAKqW,cAAgB,uCAGrBrW,KAAK+M,SAAW,uCAChB/M,KAAKqU,gBAAkB,uCACvBrU,KAAKgN,aAAe,uCACpBhN,KAAKqN,qBAAuB,uCAC5BrN,KAAKyN,oBAAsB,uCAC3BzN,KAAK2Q,cAAgB,uCACrB3Q,KAAK8Q,aAAe,uCACpB9Q,KAAKoR,eAAiB,uCACtBpR,KAAK0R,oBAAsB,uCAC3B1R,KAAKgS,iBAAmB,uCACxBhS,KAAKoQ,iBAAmB,uCAGxBpQ,KAAKgH,SAAW,uCAChBhH,KAAK4U,gBAAkB,uCACvB5U,KAAKkV,sBAAwB,uCAC7BlV,KAAKyV,sBAAwB,uCAC7BzV,KAAKiH,aAAe,uCAGpBjH,KAAK8V,SAAW,uCAChB9V,KAAK+V,8BAAgC,uCACrC/V,KAAKkW,8BAAgC,uCAErClW,KAAKsW,aAAe,CAClB,kBACAtW,KAAK+F,SACL/F,KAAKqL,SACLrL,KAAK8L,UACL9L,KAAK+M,SACL/M,KAAKgH,SACLhH,KAAK8V,UAGP9V,KAAKzB,iBAAiB,gBAAiByB,KAAKuW,wBAAwB1S,KAAK7D,OACzEA,KAAKzB,iBAAiB,kBAAmByB,KAAKuW,wBAAwB1S,KAAK7D,OAE3EA,KAAKwW,sBAAwB,IAAI1Q,EAA6B9F,MAC9DA,KAAK5B,WAAa,IAAIqY,EAAiBzW,MACvCA,KAAKjC,IAAM,IAAIqM,EAAWpK,MAC1BA,KAAKrK,KAAO,IAAI+U,EAAY1K,MAC5BA,KAAK0W,YAAc,IAAItL,EAAkBpL,MACzCA,KAAK2W,SAAW,IAAIlL,EAAezL,MACnCA,KAAKzL,IAAM,IAAIsX,EAAW7L,MAC1BA,KAAK4W,IAAM,IAAI9J,GAAU9M,MACzBA,KAAK6W,oBAAsB,IAAIzJ,GAA0BpN,MACzDA,KAAK8W,sBAAwB,IAAItJ,GAA4BxN,MAC7DA,KAAKtF,OAAS,IAAIuT,GAAajO,MAC/BA,KAAK+W,WAAa,IAAI3I,GAAkBpO,MACxCA,KAAK5L,MAAQ,IAAIua,GAAY3O,MAC7BA,KAAKgX,qBAAuB,IAAI9H,GAA4BlP,MAC5DA,KAAKiX,UAAY,IAAI9E,GAAoBnS,MACzCA,KAAK6P,SAAW,IAAIH,GAAgB1P,MACpCA,KAAKkX,IAAM,IAAIpH,GAAU9P,MACzBA,KAAKmX,cAAgB,IAAIhH,GAAoBnQ,MAC7CA,KAAKoX,SAAW,IAAI7G,GAAevQ,MACnCA,KAAKqX,YAAc,IAAI3G,GAAkB1Q,MACzCA,KAAKsX,QAAU,IAAIzG,GAAc7Q,MACjCA,KAAKuX,iBAAmB,IAAIpG,GAAuBnR,MACnDA,KAAKwX,0BAA4B,IAAI/F,GAAgCzR,MACrEA,KAAKkS,QAAU,IAAIH,GAAc/R,MACjCA,KAAKyX,yBAA2B,IAAIlE,GAAgCvT,MACpEA,KAAK0X,oBAAsB,IAAItD,GAA2BpU,MAC1DA,KAAK2X,mBAAqB,IAAIhD,GAA0B3U,MACxDA,KAAK4X,YAAc,IAAI3C,GAAmBjV,MAC1CA,KAAK6X,cAAgB,IAAIrC,GAAqBxV,MAC9CA,KAAK8X,QAAU,IAAInC,GAAe3V,MAClCA,KAAK+X,mBAAqB,IAAIC,GAAiChY,MAC/DA,KAAKiY,mBAAqB,IAAIC,GAAiClY,MAGjEmY,sBACE,IACE,OAAO9b,aAAaC,QAAQ,cAC5B,MAAOtH,GACP,QAIJ,gBACE,IAEE,MAAMojB,EAAmBpY,KAAKmY,sBAExBE,EAAU,GAwChB,OAtCID,GACFC,EAAQtW,KAAK,CAAEpM,KAAMyiB,IAEjBpY,KAAK2D,YACPtP,QAAQC,IAAK,2CAA0C8jB,OAIzDC,EAAQtW,KAAK,CAAEuW,SAAU,CAACtY,KAAK+F,YAE3B/F,KAAK2D,YACPtP,QAAQC,IAAK,mDAAkD0L,KAAK+F,aAIxE/F,KAAKU,aAAe6X,UAAUC,UAAUC,cAAc,CACpDJ,UACAK,iBAAkB1Y,KAAKsW,eAGzBtW,KAAKU,OAAOnC,iBAAiB,yBAA0ByB,KAAK2Y,eAAe9U,KAAK7D,OAEhFA,KAAK4Y,cAAa,GAEd5Y,KAAK2D,YACPtP,QAAQC,IAAK,uBAAsB0L,KAAKU,OAAO/K,4BAIjDqK,KAAK+D,aAAe/D,KAAKU,OAAOmY,KAAK7O,UAErChK,KAAKsB,iBAAmB,IAAIL,EAAiBjB,MAC7CA,KAAKmB,UAAY,IAAIV,EAAUT,MAE3BA,KAAK2D,YACPtP,QAAQC,IAAK,iBAAgB0L,KAAKU,OAAO/K,UAGpC,EACP,MAAOV,GAOP,OANA+K,KAAK4Y,cAAa,GAEd,cAAe5Y,MACjBA,KAAKmB,UAAUP,aAAa,QAAS,SAAU3L,IAG1C,GAOX,gCACE,IACE,IAAK+K,KAAKsB,iBAAiB4B,gCAC8B,IAAnDlD,KAAKsB,iBAAiBc,0BACpBpC,KAAKsB,iBAAiBa,gBAAiB,CACzCnC,KAAKsB,iBAAiB2B,8BAA6B,GAEnD,MAAM6V,EAAkB,GACxB,IAAIC,EAEAC,EAA4C,EAC5CC,EAA4C,EAEhD,KAA0D,IAAnDjZ,KAAKsB,iBAAiBc,0BACtBpC,KAAK8B,gBADiD,CAK3DmX,EAA4CjZ,KAAKsB,iBAAiB+B,2BAA6B2V,EAC/FA,EAA4ChZ,KAAKsB,iBAAiB+B,4BAClE0V,EAAY/Y,KAAKsB,iBAAiByB,WAElBpG,WAAWmc,IACzBA,EAAgBC,EAAUpc,SAAW,IAGjCoc,EAAUlX,UAAUiX,EAAgBC,EAAUpc,WAClDmc,EAAgBC,EAAUpc,SAASoc,EAAUlX,QAAU,GAGzDiX,EAAgBC,EAAUpc,SAASoc,EAAUlX,UAE7C,MAAMqX,QAAmBH,EAAUpa,IAQnC,GAL6D,KAAzDma,EAAgBC,EAAUpc,SAASoc,EAAUlX,UAAiC,IAAfqX,IACjElZ,KAAKsB,iBAAiBkB,sBAAsBuW,GAC5C/Y,KAAKmB,UAAUP,aAAa,qBAAsB,SAAUmY,IAG1DD,EAAgBC,EAAUpc,SAASoc,EAAUlX,SAAW,IACvC,IAAfqX,GACED,EAA4C,EAAG,CACjD,GAAkD,IAA9CA,EAAiD,CACnD,MAAMpW,EAAK7C,KAAKsB,iBAAiB8B,qBAAqBpD,KAAKsB,iBAAiB+B,2BAA6B,GAEzG,GAAIR,EAAGlG,UAAYoc,EAAUpc,SAAWkG,EAAGhB,SAAWkX,EAAUlX,OAC9D,SAOJ7B,KAAKsB,iBAAiBkB,sBAAsBuW,GAC5C/Y,KAAKmB,UAAUP,aAAa,qBAAsB,SAAUmY,IAMpE/Y,KAAKsB,iBAAiB2B,8BAA6B,IAIzD,MAAOhO,GACP+K,KAAKsB,iBAAiB2B,8BAA6B,GACnDjD,KAAKmB,UAAUP,aAAa,QAAS,SAAU3L,IAInD6M,eACE,OAAO9B,KAAK5K,UAGdwjB,aAAa1W,GACXlC,KAAK5K,UAAY8M,EAGnBiX,wBACEnZ,KAAK4Y,cAAa,GAClB5Y,KAAKsB,iBAAiBgC,YAGxBqV,gBAAe,OAAC1Z,IACTe,KAAK8B,gBAKR9B,KAAKmZ,wBACLnZ,KAAKmB,UAAUP,aAAa,eAAgB,WALxCZ,KAAK2D,YACPtP,QAAQC,IAAK,kCAAiC2K,EAAOtJ,QAQ3D,mBACE,IAGE,OAFAqK,KAAKmZ,8BACCnZ,KAAKU,OAAOmY,KAAKO,cAChB,EACP,MAAOnkB,GAEP,OADA+K,KAAKmB,UAAUP,aAAa,QAAS,SAAU3L,IACxC,K,oDCjVb,MAAMqD,GAAYC,YAAWC,IAAK,CAChC6gB,cAAe,CACbjlB,MAAO,WAETklB,iBAAkB,CAChBllB,MAAO,WAILsJ,GAAS,IAAIyY,GAAO,CAAExS,YAAY,IAGzB,SAAS4V,GAAcnmB,GACpC,MAAMuF,EAAUL,KAkBhB,MAAMR,EAAO1E,EAAMgC,UACf,oCACA,sCAEE0E,EAAO1G,EAAMgC,UACf,kBAAC,KAAD,CAAuBwD,UAAWD,EAAQ2gB,mBAC1C,kBAAC,KAAD,CAAwB1gB,UAAWD,EAAQ0gB,gBAE/C,OACE,6BACE,kBAACG,GAAA,EAAD,CAAQC,WAAW,EAAMC,QA1B7Brc,iBACE,GAAKjK,EAAMgC,UAUThC,EAAM2L,mBAAkB,GACxB3L,EAAMgmB,kBAVN,UAC0BzkB,OAAO+I,OAAOsM,WAEpC5W,EAAM2L,mBAAkB,GAE1B,MAAO/J,GACP5B,EAAM8U,YAAYlT,KAkBqB2kB,UAAW7f,GACjDhC,IAhCTnD,OAAO+I,OAASA,G,uJCND,SAASkc,GAAQxmB,GAC9B,OAAOymB,GAAkBzmB,EAAM0mB,cAGjC,MAAMD,GAAqBC,GACrBA,GAAgB,GACV,kBAAC,KAAD,MACCA,GAAgB,GACjB,kBAAC,KAAD,MACCA,GAAgB,GACjB,kBAAC,KAAD,MACCA,GAAgB,GACjB,kBAAC,KAAD,MACCA,GAAgB,GACjB,kBAAC,KAAD,MACCA,GAAgB,GACjB,kBAAC,KAAD,MAEA,kBAAC,KAAD,M,4RC1BZ,MAAMhe,GAAMO,aAAaC,QAAQ,qBAE7BR,IACFie,iBAAuB,CACrBC,OAAQle,GACRme,WAAY,kCACZC,YAAa,yCACbC,UAAW,kBACXC,cAAe,8BACfC,kBAAmB,eACnBC,MAAO,8CAMJ,SAASC,GAAiB5kB,EAAMygB,GACrC,IACc2D,eAAqBS,IAAI,iBAAmB7kB,GACpD8kB,I,2VAAJ,IACKrE,EADL,CAEEsE,YAAaX,aAAmBY,WAAWC,qBAE7C,MAAO5lB,KCXX,MAAM6lB,GAAa1gB,IAAME,WAAW,CAACjH,EAAOmH,IAC1C,kBAAC,IAAD,eAAYC,SAAUD,EAAKN,GAAG,WAAc7G,KAGxCkF,GAAYC,YAAWC,IAAK,CAChCQ,KAAM,CACJC,QAAS,OACTC,cAAe,SACfG,SAAU,KAEZyhB,UAAW,CACTC,UAAW,WACX3mB,MAAO,QAET4mB,OAAQ,CACN3hB,SAAU,MCaC2Q,mBAxCS,EAAEtM,aAChB,CACNtI,UAAWsI,EAAOtI,UAAUZ,QAC5BmB,KAAM+H,EAAO/H,KAAKnB,QAAQmB,KAC1Bka,SAAUnS,EAAOmS,SAASrb,QAAQqb,SAClCoL,aAAcvd,EAAOud,aACrBnB,aAAcpc,EAAOoa,QAAQtjB,QAAQuI,SAIbO,IAAD,CACzByB,kBAAoBtB,IAClBH,EAASyB,EAAkBtB,KAE7Byd,SAAU,KACR5d,EAASsB,EAAY,UAEvBuc,aAAc,KACZ7d,EAASsB,EAAY,cAEvBwa,WAAY,KACV9b,E1C+QKD,gBACC1I,OAAO+I,OAAO0b,aACpB9b,EA3QyB,CAC3BV,KA7B6B,uB0CwB7Bwe,4BAA6B,KAC3B9d,E1C4SKD,UAQL1I,OAAO+I,OAAOa,iBAAiB,eAPJlB,gBACnB1I,OAAO+I,OAAO0b,aACpB9b,EA5SuB,CAC3BV,KA7B6B,oBAyUzBU,EAASyB,GAAkB,IAC3BzB,EAASN,EAAW,CAACR,QAAS,0DAA2DS,SAAU,gB0C/SvGoe,uBAAwB,KACtB/d,E1CsTKD,MAAOC,EAAUC,KAWtB5I,OAAO+I,OAAOa,iBAAiB,QAVRvJ,SACJqM,IAAbrM,EAAEmJ,OACUZ,IACJG,OAAOtI,UAAUZ,SACzB8I,EAASN,EAAW,CAACR,QAASxH,EAAEmJ,OAAO0C,KAAKrE,QAASS,SAAU,WAGjEK,EAASN,EAAW,CAACR,QAASoW,OAAO5d,GAAIiI,SAAU,gB0C5TzDqe,uBAAwB,KACtBhe,E1CmUKD,UAiBL1I,OAAO+I,OAAOa,iBAAiB,QAhBRP,IACrB,MAAMud,EAAqB,CACzB,OACA,wBACA,uBACA,YACA,aACA,2BACA,uBAEEvd,EAAMG,QACJod,EAAmB1d,SAASG,EAAMG,OAAOxB,UAC3CW,EAASN,EAAW,CAACR,QAAS,UAAWS,SAAU,kB0C9U3Due,yBAA0B,KACxBle,E1CsVKD,UAIL1I,OAAO+I,OAAOa,iBAAiB,UAHN/J,IACvB8I,EAAST,EAAwB,UAAWrI,MAG9C,MAAMslB,QAAqBnlB,OAAO+I,OAAOoa,QAAQjZ,OACjDvB,EAASZ,EAAkB,UAAWod,UAChCnlB,OAAO+I,OAAOoa,QAAQrZ,W0C3V9ByJ,YAAclT,IACZsI,E1C8VwBtI,IAClBsI,IACNA,EAASN,EAAW,CAACR,QAASoW,OAAO5d,GAAIiI,SAAU,Y0ChW1CiL,CAAYlT,OAIVgV,EDTA,SAAyB5W,GAAQ,MACtCM,EAAoBD,yBAApBC,gBACFiF,EAAUL,KAEhBpD,oBAAU,KACJ9B,EAAMgC,WAAahC,EAAMuC,MAC3B4kB,GAAiBnnB,EAAMuC,KAAM,CAC3BmiB,QAAS1kB,EAAM0mB,aACfjK,SAAUzc,EAAMyc,YAGnB,CAACzc,EAAMgC,UAAWhC,EAAMuC,KAAMvC,EAAMyc,SAAUzc,EAAM0mB,eAkBvD,MAAM2B,EAAgB,kBAAClC,GAAD,CAAexa,kBAhBrC,SAA2BtB,GACzBrK,EAAM2L,kBAAkBtB,GACpBA,GACFrK,EAAM8nB,WACN9nB,EAAM+nB,eAENznB,EAAgB,8BAAqB,CAAEoB,QAAS,YAChD1B,EAAMioB,yBACNjoB,EAAMgoB,8BACNhoB,EAAMkoB,yBACNloB,EAAMooB,4BAEN9nB,EAAgB,iCAIuD0lB,WAAYhmB,EAAMgmB,WAAYlR,YAAa9U,EAAM8U,YAAa9S,UAAWhC,EAAMgC,YACpJsmB,EAAe,kBAAClC,GAAA,EAAD,CAAQC,WAAW,EAAM7gB,UAAWD,EAAQmiB,UAAWngB,UAAWkgB,IAAlE,UAEfc,EAAYvoB,EAAMgC,WAAahC,EAAMuC,MAAQvC,EAAMyc,UAAYzc,EAAM0mB,aAEvE,kBAACrf,EAAA,EAAD,KACE,kBAACmhB,GAAA,EAAD,KACE,kBAACC,GAAA,EAAD,KACE,kBAACjC,GAAD,CAAShhB,UAAU,UAAUkhB,aAAc1mB,EAAM0mB,iBAGrD,kBAACjf,EAAA,EAAD,CAAcd,QAAS3G,EAAMuC,KAAMqE,UAAY,GAAE5G,EAAMyc,uBAAuBzc,EAAM0mB,mBAGtF,KAEJ,OACE,yBAAKlhB,UAAWD,EAAQK,MACrB2iB,EACAF,EACD,yBAAK7iB,UAAWD,EAAQqiB,SACvBU,M,mSEzEP,MAAMpjB,GAAYC,YAAWC,IAAK,CAChCQ,KAAM,CACJC,QAAS,OACT6iB,OAAQtjB,EAAMkB,QAAQ,IAExBqiB,MAAO,CACLC,SAAU,KAEZzf,YAAa,CACX0f,UAAWzjB,EAAMkB,QAAQ,OAId,SAASwiB,KACtB,MAAMvjB,EAAUL,KADmB,EHK9B,SAA6B6jB,GAClC,IACE,OAAOC,aAAcrC,eAAqBsC,WAAWF,IACrD,MAAOnnB,GACP,MAAO,CAAC,MAAM,EAAO,IAAIwP,MAAM,oBGPD8X,CAAoB,gBAFjB,oBAE5BpkB,EAF4B,KAErBqkB,EAFqB,KAEZtnB,EAFY,KAInC,OACE,kBAACunB,GAAA,EAAD,CAAO5jB,UAAWD,EAAQK,MACxB,yBAAKxB,IAAK+E,IAAa3D,UAAWD,EAAQ4D,YAAaf,IAAI,KAC1DvG,GAAS,0CAAgBO,KAAKC,UAAUR,IACxCsnB,GAAW,wDACXrkB,GACC,kBAACukB,GAAA,EAAD,CAAO7jB,UAAWD,EAAQojB,MAAOW,aAAW,gBAC1C,kBAACC,GAAA,EAAD,KACE,kBAACC,GAAA,EAAD,KACE,kBAACC,GAAA,EAAD,cACA,kBAACA,GAAA,EAAD,CAAWC,MAAM,SAAjB,kBACA,kBAACD,GAAA,EAAD,CAAWC,MAAM,SAAjB,UACA,kBAACD,GAAA,EAAD,CAAWC,MAAM,SAAjB,sBAGJ,kBAACC,GAAA,EAAD,KACG7kB,EAAM8kB,KACJphB,IAAI4e,I,4VAAG,EAAO9jB,GAAI8jB,EAAI9jB,IAAO8jB,EAAIvc,SACjCgf,KAAK,CAACC,EAAE9Q,IAAM8Q,EAAExmB,GAAGymB,cAAc/Q,EAAE1V,KACnCkF,IAAI4e,IACH,MAAM4C,EAAO5C,EAAIE,YACb,IAAI2C,KAAuC,IAAlC5a,OAAO+X,EAAIE,YAAY4C,UAChC,KACJ,OACE,kBAACV,GAAA,EAAD,CAAU9gB,IAAK0e,EAAI9jB,IACjB,kBAACmmB,GAAA,EAAD,CAAWliB,UAAU,KAAK4iB,MAAM,OAC7B/C,EAAI9jB,IAEP,kBAACmmB,GAAA,EAAD,CAAWC,MAAM,SAAStC,EAAI1C,QAA9B,KACA,kBAAC+E,GAAA,EAAD,CAAWC,MAAM,SAAStC,EAAI3K,SAAW2K,EAAI3K,SAAW,KACxD,kBAACgN,GAAA,EAAD,CAAWC,MAAM,SAASM,EAAQA,EAAKI,eAAe,MAAS,YChDnF,MAEMllB,GAAYC,YAAWC,IAAK,CAChCQ,KAAM,CACJC,QAAS,QAEXwkB,OAAQ,CACNjkB,MAPgB,IAQhBkkB,WAAY,GAEdC,YAAa,CACXnkB,MAXgB,IAYhBwB,gBAAiBxC,EAAMyC,QAAQ2iB,WAAWC,QAE5C/iB,QAAStC,EAAMuC,OAAOD,QACtBgjB,QAAS,CACPzkB,SAAU,EACV2B,gBAAiBxC,EAAMyC,QAAQ2iB,WAAWG,YCrB/B/T,mBAJS,EAAGtM,aAAH,CACtBsgB,YAAatgB,EAAOtI,UAAUZ,UAGjBwV,EDyBA,SAAa5W,GAC1B,MAAMuF,EAAUL,KACR0lB,EAA4B5qB,EAA5B4qB,YAAaC,EAAe7qB,EAAf6qB,WAEfC,EACJ,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAOC,OAAK,EAACpiB,KAAK,UAAUpB,UAAWuhB,KAErC8B,EACIC,EAAWriB,IAAIC,GAAQ,kBAAC,IAAD,CAAOsiB,OAAK,EAACriB,IAAKD,EAAKE,KAAMA,KAAMF,EAAKE,KAAMpB,UAAWkB,EAAKlB,aACrF,kBAAC,IAAD,CAAOoB,KAAK,IAAIpB,UAAWyB,KAKrC,OACE,yBAAKxD,UAAWD,EAAQK,MACtB,kBAAColB,EAAA,EAAD,CAAQxlB,UAAWD,EAAQ8kB,OAAQ3oB,QAAQ,YAAY6D,QAAS,CAAE0lB,MAAO1lB,EAAQglB,cAC/E,kBAACriB,EAAD,CAAMK,MAAOsiB,IACb,kBAAC,GAAD,OAEF,0BAAMrlB,UAAWD,EAAQmlB,SACtBI,O,kBEjCM1lB,OAjBD8lB,aAAe,CAC3BrjB,QAAS,CACPlB,QAAS,CACPX,KAAM,WAERY,UAAW,CACTZ,KAAM,WAERnE,MAAO,CACLmE,KAAMmT,KAAIgS,MAEZX,WAAY,CACVC,OAAQ,c,glBCPd,MAAMW,GAAc,CAClBppB,UAAW,CACTZ,SAAS,GAEXkiB,YAAa,CACX3Z,QAAQ,EACRvI,aAAS6M,GAEXsV,SAAU,CACR5Z,QAAQ,EACRvI,aAAS6M,GAEXod,IAAK,CACH1hB,QAAQ,EACRvI,aAAS6M,GAEXqd,KAAM,CACJ3hB,QAAQ,EACRvI,aAAS6M,GAEX+V,SAAU,CACRra,QAAQ,EACRvI,aAAS6M,GAEXjN,MAAO,CACL2I,QAAQ,EACRvI,aAAS6M,GAEXgW,YAAa,CACXta,QAAQ,EACRvI,QAAS,CACP2Y,MAAO,EACPpZ,KAAM,CACJyX,KAAM,KACNtT,MAAO,KAIb0e,IAAK,CACH7Z,QAAQ,EACRvI,QAAS,CACP0Y,UAAW,EACXC,MAAO,IAGXgK,cAAe,CACbpa,QAAQ,EACRvI,QAAS,CACP0D,MAAO,CACLb,EAAG,EACHC,EAAG,EACHC,EAAG,KAIT2a,QAAS,CACPnV,QAAQ,EACRvI,QAAS,CACP0d,QAAS,IAGb4E,sBAAuB,CACrB/Z,QAAQ,EACRvI,QAAS,CACP6C,EAAG,EACHC,EAAG,EACHC,EAAG,EACHoW,EAAG,IAGPpZ,IAAK,CACHC,QAAS,CACP0X,MAAO,IAGXxR,OAAQ,CACNqC,QAAQ,EACRvI,QAAS,CACP0D,MAAO,IAGX2X,SAAU,CACRrb,QAAS,CACPqb,SAAU,KAGdla,KAAM,CACJnB,QAAS,CACPmB,KAAM,KAGV6gB,sBAAuB,CACrBhiB,QAAS,CACP4R,SAAU,EACVG,QAAS,IAGbyQ,qBAAsB,CACpBxiB,QAAS,CACP8a,YAAa,EACbC,YAAa,IACbC,aAAc,EACdjJ,QAAS,MAGb0Q,UAAW,CACTziB,QAAS,CACP4e,KAAM,KAGV2D,WAAY,CACVviB,QAAS,CACPga,MAAO,KAGXiJ,yBAA0B,CACxBjjB,QAAS,CACPmf,oBAAqB,EACrBC,iBAAkB,EAClBC,iBAAkB,EAClBC,cAAe,EACfC,YAAa,EACbI,uBAAwB,CACtB1H,KAAM,EACND,MAAO,EACPD,IAAK,KAIXmL,oBAAqB,CACnBljB,QAAS,CACP8f,oBAAqB,EACrBC,yBAA0B,EAC1BC,mBAAoB,EACpBC,uBAAwB,EACxBC,aAAc,IAGlBiK,QAAS,CACPnqB,aAAS6M,GAEXud,MAAO,CACLpqB,aAAS6M,GAEXiH,IAAK,CACH9T,QAAS,CACPqqB,WAAY,IAGhBzgB,WAAY,CACV5J,aAAS6M,EACTtE,QAAQ,GAEV+a,QAAS,CACPtjB,QAAS,CACPuI,OAAQ,OAKC,ICtKA+hB,gBAAgB,CAC7BphB,ODqKa,CAACD,EAAQ+gB,GAAaO,KACnC,OAAQA,EAAOniB,MACf,I/C3KiC,sB+C4K/B,OAAO,MACFa,EADL,CAEE,CAACshB,EAAOvqB,QAAQmI,SAAhB,MACKc,EAAMshB,EAAOvqB,QAAQmI,SAD1B,CAEEnI,QAASuqB,EAAOvqB,QAAQA,YAI9B,I/CnLwC,6B+CoLtC,MAA+B,QAA3BuqB,EAAOvqB,QAAQmI,QACV,MACFc,EADL,CAEEghB,IAAI,MACChhB,EAAMghB,IADR,CAEDjqB,QAAUiJ,EAAMghB,IAAI1hB,OAASgiB,EAAOvqB,QAAQA,QAAQ2J,OAAO8R,KAAOxS,EAAMghB,IAAIjqB,UAE9EkqB,KAAK,MACAjhB,EAAMihB,KADP,CAEFlqB,QAAUiJ,EAAMihB,KAAK3hB,OAASgiB,EAAOvqB,QAAQA,QAAQ2J,OAAO+R,KAAOzS,EAAMihB,KAAKlqB,YAI3E,MACFiJ,EADL,CAEE,CAACshB,EAAOvqB,QAAQmI,SAAhB,MACKc,EAAMshB,EAAOvqB,QAAQmI,SAD1B,CAEEnI,QAASuqB,EAAOvqB,QAAQA,QAAQ2J,WAKxC,I/CzMyC,wB+C0MvC,OAAO,MACFV,EADL,CAEE,CAACshB,EAAOhiB,OAAOJ,SAAf,MACKc,EAAMshB,EAAOhiB,OAAOJ,SADzB,CAEEI,OAAQgiB,EAAOhiB,OAAOA,WAI5B,I/CjN6B,kB+CkN3B,OAAOyhB,GAET,I/CnNyB,c+CoNvB,OAAO,MACF/gB,EADL,CAEEwd,aAAc8D,EAAOviB,UAGzB,I/CxN4C,iC+CyN1C,OAAO,MACFiB,EADL,CAEE,CAACshB,EAAOpiB,SAAR,MACKc,EAAMshB,EAAOpiB,SADlB,CAEEgB,kBAAkB,MAIxB,QACE,OAAOF,MEtOJ,MAAMuhB,GAAc5qB,IACzB,IAAI6qB,EACJ,OAAQ7qB,GACR,KAAK,EACH6qB,EAAM,CAAC1S,IAAK,IAAKC,MAAO,EAAGC,KAAM,GACjC,MACF,KAAK,EACHwS,EAAM,CAAC1S,IAAK,EAAGC,MAAO,IAAKC,KAAM,GACjC,MACF,KAAK,EACHwS,EAAM,CAAC1S,IAAK,IAAKC,MAAO,IAAKC,KAAM,GACnC,MACF,KAAK,EACHwS,EAAM,CAAC1S,IAAK,EAAGC,MAAO,EAAGC,KAAM,KAC/B,MACF,KAAK,EACHwS,EAAM,CAAC1S,IAAK,IAAKC,MAAO,EAAGC,KAAM,KACjC,MACF,KAAK,EACHwS,EAAM,CAAC1S,IAAK,EAAGC,MAAO,IAAKC,KAAM,KACjC,MACF,KAAK,EACHwS,EAAM,CAAC1S,IAAK,IAAKC,MAAO,IAAKC,KAAM,KACnC,MACF,QACEwS,EAAM,CAAC1S,IAAK,EAAGC,MAAO,IAAKC,KAAM,KAEnC,OAAOwS,GAIIC,GAAcD,IACzB,IAAI7qB,EACJ,QAAQ,GACR,KAAiB,MAAZ6qB,EAAI1S,KAA6B,IAAd0S,EAAIzS,OAA4B,IAAbyS,EAAIxS,KAC7CrY,EAAQ,EACR,MACF,KAAiB,IAAZ6qB,EAAI1S,KAA2B,MAAd0S,EAAIzS,OAA8B,IAAbyS,EAAIxS,KAC7CrY,EAAQ,EACR,MACF,KAAiB,MAAZ6qB,EAAI1S,KAA6B,MAAd0S,EAAIzS,OAA8B,IAAbyS,EAAIxS,KAC/CrY,EAAQ,EACR,MACF,KAAiB,IAAZ6qB,EAAI1S,KAA2B,IAAd0S,EAAIzS,OAA4B,MAAbyS,EAAIxS,KAC3CrY,EAAQ,EACR,MACF,KAAiB,MAAZ6qB,EAAI1S,KAA6B,IAAd0S,EAAIzS,OAA4B,MAAbyS,EAAIxS,KAC7CrY,EAAQ,EACR,MACF,KAAiB,IAAZ6qB,EAAI1S,KAA2B,MAAd0S,EAAIzS,OAA8B,MAAbyS,EAAIxS,KAC7CrY,EAAQ,EACR,MACF,KAAiB,MAAZ6qB,EAAI1S,KAA6B,MAAd0S,EAAIzS,OAA8B,MAAbyS,EAAIxS,KAC/CrY,EAAQ,EACR,MACF,QACEA,OAAQiN,EAGV,OAAOjN,GCzDI+qB,GAAe/rB,GAC1B,yBAAKwF,UAAU,iBACb,yBAAKA,UAAU,aACb,4BAAQgE,KAAK,SAAShE,UAAU,8BAA8BV,MAAM,WAAWknB,SAAyC,IAA/BhsB,EAAMuJ,QAAQnI,QAAQ0X,KAAYwN,QAAStmB,EAAMisB,YAA1I,cACA,4BAAQziB,KAAK,SAAShE,UAAU,8BAA8BV,MAAM,UAAUknB,SAAyC,IAA/BhsB,EAAMuJ,QAAQnI,QAAQ0X,KAAYwN,QAAStmB,EAAMisB,YAAzI,kBACA,4BAAQziB,KAAK,SAAShE,UAAU,8BAA8BV,MAAM,UAAUknB,SAAyC,IAA/BhsB,EAAMuJ,QAAQnI,QAAQ0X,KAAYwN,QAAStmB,EAAMisB,YAAzI,eACA,4BAAQziB,KAAK,SAAShE,UAAU,8BAA8BV,MAAM,MAAMknB,SAAyC,IAA/BhsB,EAAMuJ,QAAQnI,QAAQ0X,KAAYwN,QAAStmB,EAAMisB,YAArI,qBAEF,yBAAKzmB,UAAU,mBACb,6BACE,4BAAQgE,KAAK,SAAShE,UAAU,aAAaV,MAAM,IAAIknB,SAAyC,IAA/BhsB,EAAMuJ,QAAQnI,QAAQ0X,MAA8C,IAA/B9Y,EAAMuJ,QAAQnI,QAAQ0X,MAA4H,IAA9GgT,GAAW,CAAC3S,IAAKnZ,EAAMuJ,QAAQnI,QAAQqD,EAAG2U,MAAOpZ,EAAMuJ,QAAQnI,QAAQ2X,EAAGM,KAAMrZ,EAAMuJ,QAAQnI,QAAQ4X,KAAe,CAAC,EAAG,GAAGvO,SAASzK,EAAMuJ,QAAQnI,QAAQ0X,OAAyC,IAAhC9Y,EAAMuJ,QAAQnI,QAAQJ,MAAcslB,QAAStmB,EAAMe,cACjW,4BAAQyI,KAAK,SAAShE,UAAU,eAAeV,MAAM,IAAIknB,SAAyC,IAA/BhsB,EAAMuJ,QAAQnI,QAAQ0X,MAA8C,IAA/B9Y,EAAMuJ,QAAQnI,QAAQ0X,MAA4H,IAA9GgT,GAAW,CAAC3S,IAAKnZ,EAAMuJ,QAAQnI,QAAQqD,EAAG2U,MAAOpZ,EAAMuJ,QAAQnI,QAAQ2X,EAAGM,KAAMrZ,EAAMuJ,QAAQnI,QAAQ4X,KAAe,CAAC,EAAG,GAAGvO,SAASzK,EAAMuJ,QAAQnI,QAAQ0X,OAAyC,IAAhC9Y,EAAMuJ,QAAQnI,QAAQJ,MAAcslB,QAAStmB,EAAMe,cACnW,4BAAQyI,KAAK,SAAShE,UAAU,gBAAgBV,MAAM,IAAIknB,SAAyC,IAA/BhsB,EAAMuJ,QAAQnI,QAAQ0X,MAA8C,IAA/B9Y,EAAMuJ,QAAQnI,QAAQ0X,MAA4H,IAA9GgT,GAAW,CAAC3S,IAAKnZ,EAAMuJ,QAAQnI,QAAQqD,EAAG2U,MAAOpZ,EAAMuJ,QAAQnI,QAAQ2X,EAAGM,KAAMrZ,EAAMuJ,QAAQnI,QAAQ4X,KAAe,CAAC,EAAG,GAAGvO,SAASzK,EAAMuJ,QAAQnI,QAAQ0X,OAAyC,IAAhC9Y,EAAMuJ,QAAQnI,QAAQJ,MAAcslB,QAAStmB,EAAMe,cACpW,4BAAQyI,KAAK,SAAShE,UAAU,cAAcV,MAAM,IAAIknB,SAAyC,IAA/BhsB,EAAMuJ,QAAQnI,QAAQ0X,MAA8C,IAA/B9Y,EAAMuJ,QAAQnI,QAAQ0X,MAA4H,IAA9GgT,GAAW,CAAC3S,IAAKnZ,EAAMuJ,QAAQnI,QAAQqD,EAAG2U,MAAOpZ,EAAMuJ,QAAQnI,QAAQ2X,EAAGM,KAAMrZ,EAAMuJ,QAAQnI,QAAQ4X,KAAe,CAAC,EAAG,GAAGvO,SAASzK,EAAMuJ,QAAQnI,QAAQ0X,OAAyC,IAAhC9Y,EAAMuJ,QAAQnI,QAAQJ,MAAcslB,QAAStmB,EAAMe,eAEpW,6BACE,4BAAQyE,UAAU,gBAAgBV,MAAM,IAAIknB,SAAyC,IAA/BhsB,EAAMuJ,QAAQnI,QAAQ0X,MAA8C,IAA/B9Y,EAAMuJ,QAAQnI,QAAQ0X,MAA4H,IAA9GgT,GAAW,CAAC3S,IAAKnZ,EAAMuJ,QAAQnI,QAAQqD,EAAG2U,MAAOpZ,EAAMuJ,QAAQnI,QAAQ2X,EAAGM,KAAMrZ,EAAMuJ,QAAQnI,QAAQ4X,KAAe,CAAC,EAAG,GAAGvO,SAASzK,EAAMuJ,QAAQnI,QAAQ0X,OAAyC,IAAhC9Y,EAAMuJ,QAAQnI,QAAQJ,MAAcslB,QAAStmB,EAAMe,cACtV,4BAAQyE,UAAU,cAAcV,MAAM,IAAIknB,SAAyC,IAA/BhsB,EAAMuJ,QAAQnI,QAAQ0X,MAA8C,IAA/B9Y,EAAMuJ,QAAQnI,QAAQ0X,MAA4H,IAA9GgT,GAAW,CAAC3S,IAAKnZ,EAAMuJ,QAAQnI,QAAQqD,EAAG2U,MAAOpZ,EAAMuJ,QAAQnI,QAAQ2X,EAAGM,KAAMrZ,EAAMuJ,QAAQnI,QAAQ4X,KAAe,CAAC,EAAG,GAAGvO,SAASzK,EAAMuJ,QAAQnI,QAAQ0X,OAAyC,IAAhC9Y,EAAMuJ,QAAQnI,QAAQJ,MAAcslB,QAAStmB,EAAMe,cACpV,4BAAQyE,UAAU,eAAeV,MAAM,IAAIknB,SAAyC,IAA/BhsB,EAAMuJ,QAAQnI,QAAQ0X,MAA8C,IAA/B9Y,EAAMuJ,QAAQnI,QAAQ0X,MAA4H,IAA9GgT,GAAW,CAAC3S,IAAKnZ,EAAMuJ,QAAQnI,QAAQqD,EAAG2U,MAAOpZ,EAAMuJ,QAAQnI,QAAQ2X,EAAGM,KAAMrZ,EAAMuJ,QAAQnI,QAAQ4X,KAAc,CAAC,EAAG,GAAGvO,SAASzK,EAAMuJ,QAAQnI,QAAQ0X,OAAyC,IAAhC9Y,EAAMuJ,QAAQnI,QAAQJ,MAAeslB,QAAStmB,EAAMe,iB,ilBCb7V,MAAMmrB,WAAWnlB,IAAMolB,UACrB7f,YAAYtM,GACVwM,MAAMxM,GACN4M,KAAKvC,MAAQ,CACXlJ,IAAKnB,EAAMmB,KAGbyL,KAAKwf,UAAYpsB,EAAMosB,UACvBxf,KAAK7L,YAAc6L,KAAK7L,YAAY0P,KAAK7D,MACzCA,KAAKqf,WAAarf,KAAKqf,WAAWxb,KAAK7D,MACvCA,KAAKyf,SAAWrsB,EAAMqsB,SAGxBC,0BAA0BC,GACpBA,EAAGjlB,SAAWsF,KAAKvC,MAAM/C,QAC3BsF,KAAK4f,SAAUC,GAAD,MACTA,EADS,CAEZnlB,OAAQilB,EAAGjlB,UAIXilB,EAAGprB,MAAQyL,KAAKvC,MAAMlJ,KACxByL,KAAK4f,SAAUC,GAAD,MACTA,EADS,CAEZtrB,IAAKorB,EAAGprB,OAKdurB,oBACE9f,KAAK5M,MAAM2sB,kBAGb5rB,YAAYgM,GACVH,KAAK5M,MAAMS,cAAcob,SAAS9O,EAAMlB,OAAO/G,MAAO,IAAK8H,KAAKvC,MAAMlJ,IAAIC,SAG5E6qB,WAAWlf,GACTH,KAAK5M,MAAM4sB,aAAa7f,EAAMlB,OAAO/G,MAAO8H,KAAKvC,MAAMlJ,IAAIC,SAG7DyrB,SACE,OACE,yBAAKrnB,UAAU,WACb,kBAAC,KAAD,CAAiBd,KAAK,UACtB,kBAACqnB,GAAD,CAAaxiB,QAASqD,KAAKvC,MAAMlJ,IAAKJ,YAAa6L,KAAK7L,YAAakrB,WAAYrf,KAAKqf,eAkB/EC,UCUAtV,YA1ES,EAAGtM,aACjB,CACNnJ,IAAKmJ,EAAOnJ,MAIY+I,IAAD,CACzByiB,gBAAiB,KACfziB,EAASsB,EAAY,SAEvB/K,cAAe,CAACO,EAAOG,KACrB,IAAI2X,EACJ,OAAQ3X,EAAI2X,MACZ,KAAK,EACHA,EAAO,MACP,MACF,KAAK,EACHA,EAAO,WACP,MACF,KAAK,EACHA,EAAO,UACP,MACF,KAAK,EACHA,EAAO,UACP,MACF,QACEA,EAAO,UAGT,MAAMgU,EAAoBlB,GAAW5qB,GAC/BmY,EAAM2T,EAAkB3T,IACxBC,EAAQ0T,EAAkB1T,MAC1BC,EAAOyT,EAAkBzT,KAEzBH,EAAQ/X,EAAI+X,OAAS,KACrB7F,EAAS,CACbyF,KAAMA,EACN9X,MAAOA,EACPiY,UAAW9X,EAAI8X,UACfC,MAAOA,EACPC,IAAKA,EACLC,MAAOA,EACPC,KAAMA,GAGRpY,QAAQC,IAAI,CAAEmS,WACdnJ,EAASwB,EAAa,MAAO2H,KAE/BuZ,aAAc,CAAC9T,EAAM3X,KACnB,IAAIH,EAEFA,EADe,IAAbG,EAAI2X,KACEgT,GAAW,CAAC3S,IAAKhY,EAAIsD,EAAG2U,MAAOjY,EAAI4X,EAAGM,KAAMlY,EAAI6X,IAEhD7X,EAAIH,OAAS,EAEvB,MAAMkY,EAAQ/X,EAAI+X,OAAS,IACrBD,EAAY9X,EAAI8X,WAAa,GAC7B6T,EAAoBlB,GAAW5qB,GAC/BmY,EAAM2T,EAAkB3T,IACxBC,EAAQ0T,EAAkB1T,MAC1BC,EAAOyT,EAAkBzT,KAU/BnP,EAASwB,EAAa,MATP,CACboN,KAAMA,EACN9X,MAAOA,EACPiY,UAAWA,EACXC,MAAOA,EACPC,IAAKA,EACLC,MAAOA,EACPC,KAAMA,QAMGzC,CAGbmW,IAHanW,I,UCtBAA,mBArDS,EAAGtM,aACjB,CACNtI,UAAWsI,EAAOtI,UAAUZ,QAC5Ba,cAAeqI,EAAOhD,OAAOlG,QAAQ0D,MACrC3D,IAAKmJ,EAAOnJ,MAIY+I,IAAD,CACzBnI,QAAS,KACPmI,EAASsB,EAAY,QACrBtB,EAASJ,EAAc,SAAU,QAEnCrJ,cAAe,CAACO,EAAOG,KACrB,IAAI2X,EACJ,OAAQ3X,EAAI2X,MACZ,KAAK,EACHA,EAAO,MACP,MACF,KAAK,EACHA,EAAO,WACP,MACF,KAAK,EACHA,EAAO,UACP,MACF,KAAK,EACHA,EAAO,UACP,MACF,QACEA,EAAO,UAGT,MAAMgU,EAAoBlB,GAAW5qB,GAC/BmY,EAAM2T,EAAkB3T,IACxBC,EAAQ0T,EAAkB1T,MAC1BC,EAAOyT,EAAkBzT,KAEzBH,EAAQ/X,EAAI+X,OAAS,KACrB7F,EAAS,CACbyF,KAAMA,EACN9X,MAAOA,EACPiY,UAAW9X,EAAI8X,UACfC,MAAOA,EACPC,IAAKA,EACLC,MAAOA,EACPC,KAAMA,GAGRpY,QAAQC,IAAI,CAAEmS,WACdnJ,EAASwB,EAAa,MAAO2H,OAIlBuD,CAGbmW,M,UCvCanW,mBAlBS,EAAGtM,aACjB,CACNtI,UAAWsI,EAAOtI,UAAUZ,QAC5Ba,cAAeqI,EAAOhD,OAAOlG,QAAQ0D,MACrCzB,aAAciH,EAAOkZ,IAAIpiB,QAAQ0Y,UACjC1W,SAAUkH,EAAOkZ,IAAIpiB,QAAQ2Y,QAIL7P,IAAD,CACzBnI,QAAS,KACPmI,EAASJ,EAAc,SAAU,OACjCI,EAASJ,EAAc,MAAO,QAEhC3G,MAAO,SAIMyT,CAGbjU,M,UCNaiU,mBAfS,EAAGtM,aAAH,CACtBtI,UAAWsI,EAAOtI,UAAUZ,QAC5B4C,QAASsG,EAAOyZ,cAAc3iB,QAAQ0D,QAGZoF,IAAD,CACzBnI,QAAS,KACPmI,EAASJ,EAAc,SAAU,OACjCI,EAASJ,EAAc,gBAAiB,QAE1C3G,MAAO,KACL+G,EAASJ,EAAc,gBAAiB,WAI7B8M,CAGbpT,M,4DCpBa,SAASwpB,GAAchtB,GAAQ,MAAD,EACjBqE,mBAAS,IADQ,oBACpC4oB,EADoC,KAC7BC,EAD6B,KAG3CprB,oBAAU,KACR,GAAI9B,EAAM6K,KAAM,CACd,MAAMsiB,EAAUF,EAAMzY,OAAO,IAC7B2Y,EAAQxe,KAAK,CAAE1K,EAAGgmB,KAAKmD,MAAOlpB,EAAGlE,EAAM6K,KAAK/F,QAC5CooB,EAASC,KAEV,CAACntB,EAAM6K,OAEV,MAmCMwiB,EAAS,CAAC,CACdxiB,KAAMoiB,EAAMzY,UAGd,OAAO,kBAAC,KAAD,CAAOwO,QAvCE,CACdsK,MAAO,CACLhqB,GAAI,WACJiqB,WAAY,CACVC,SAAS,GAEX9lB,QAAS,CACP+lB,MAAM,GAERC,KAAM,CACJF,SAAS,IAGbG,WAAY,CACVH,SAAS,GAEXI,OAAQ,CACNC,MAAO,UAETC,QAAS,CACPC,KAAM,GAERC,MAAO,CACLxkB,KAAM,YAGRykB,MAAO,GAIPC,OAAQ,CACNT,MAAM,IAQsBJ,OAAQA,EAAQ7jB,KAAK,OAAOzD,OAAO,QCjCtD6Q,ICdA,IACb,CAAEjO,KAAM,WAAYpB,UDaPqP,YAfS,EAAGtM,aACjB,CACNtI,UAAWsI,EAAOtI,UAAUZ,QAC5BkiB,YAAahZ,EAAOgZ,YAAYliB,QAChC4iB,SAAU1Z,EAAO0Z,SAAS5iB,UAIF8I,IAAD,CACzBnI,QAAS,KACPmI,EAASJ,EAAc,cAAe,OACtCI,EAASJ,EAAc,WAAY,UAIxB8M,EEbA,SAAiB5W,GAC9B,MAAME,EAAeC,aAAYguB,MAMjC,OAJArsB,oBAAU,KACR9B,EAAM+B,WACL,CAAC/B,EAAMgC,YAGR,kBAAC,KAAD,CACEE,WAAW,UACXhC,aAAcA,EACdiC,cAAe,4CAEb,kBAAC6qB,GAAD,CAAeniB,KAAM7K,EAAMsjB,cAFd,wBAIb,kBAAC0J,GAAD,CAAeniB,KAAM7K,EAAMgkB,iBDfOrd,QAAS,aAAcC,UAAW,YAC1E,CAAE+B,KAAM,UAAWpB,UAAW6mB,GAAeznB,QAAS,aAAcC,UAAW,wCAE/E,CAAE+B,KAAM,QAASpB,UAAW8mB,GAAc1nB,QAAS,aAAcC,UAAW,+BAC5E,CAAE+B,KAAM,QAASpB,UAAW+mB,GAAU3nB,QAAS,aAAcC,UAAW,e,SEO1E,MAAM2nB,GAAQC,aAAYC,GAAYC,aAAgBC,OAEtDC,IAAS/B,OACP,kBAACgC,EAAA,EAAD,CAAezpB,MAAOA,IACpB,kBAAC0pB,EAAA,EAAD,MACA,kBAAC,IAAD,CAAUP,MAAOA,IACf,kBAAC,oBAAD,CAAkBQ,SAAU,GAC1B,kBAAC,IAAD,CAAQC,SAAUC,MAChB,kBAAC,GAAD,CAAKpE,WAAYA,SAKzBne,SAASwiB,cAAc,W,iICzBV,SAASC,EAAWnvB,GACjC,OACE,kBAAC,IAAD,eACEovB,YAAY,wCACZtW,KAAK,aACL1T,MAAM,SACN7C,KAAK,QACL6D,MAAM,OACNipB,SAAU,GACVC,iBAAiB,EACjBC,YAAY,EACZC,qBAAqB,EACrBC,WAAY,CACVC,iBAAiB,EACjBC,QAAS,IAEP3vB,ICdK,SAAS4vB,EAAe5vB,GAAQ,MACrCuC,EAAyBvC,EAAzBuC,KAAMC,EAAmBxC,EAAnBwC,QAASC,EAAUzC,EAAVyC,MAEjBotB,EAAa5mB,aAAaC,QAAQ3G,IAASC,GAAW,GAI5D,OACE,kBAACstB,EAAA,EAAD,KACE,kBAACX,EAAD,CAAYY,SALUC,GAAa/mB,aAAagnB,QAAQ1tB,EAAMytB,GAKtBlrB,MAAO+qB,IAC/C,kBAACK,EAAA,EAAD,KACE,kBAAC9J,EAAA,EAAD,CAAQE,QANM,IAAM7jB,EAAMwG,aAAaC,QAAQ3G,IAMjBwrB,KAAK,SAASrsB,QAAQ,YAAYV,MAAM,UAAUulB,UAAW,kBAAC,IAAD,OAA3F,aAnBR,mC,gCCAA,wGAIA,MAAMrhB,EAAYC,YAAWC,IAAK,CAChC+qB,WAAY,CACVtqB,QAAS,YAIN,SAAS/C,EAAYQ,EAAIT,GAC9B6J,SAAS0jB,eAAe9sB,GAAI+sB,cAAcC,YAAY,CAAEztB,QAG3C,SAAS0tB,EAAUvwB,GAAQ,MAChCsD,EAAmBtD,EAAnBsD,GAAIC,EAAevD,EAAfuD,WACNitB,GAA0C,cAA7BjvB,OAAOkvB,SAASC,SAA2BzB,IAAa,IAAM1rB,EAC3EgC,EAAUL,IAEhB,OACE,4BAAQd,IAAKosB,EAAWltB,GAAIA,EAAI8C,MAAM,OAAOL,OAAQ,IAAK4qB,YAAa,EAAGnrB,UAAWD,EAAQ4qB,e,mBCpBjGtwB,EAAOC,QAAU,IAA0B,4C,gCCA3C,iGAOA,MAAMoF,EAAYC,YAAWC,IAAK,CAChCsC,QAAS,CACPrB,QAASjB,EAAMkB,QAAQ,MACvBsqB,UAAWxrB,EAAMyrB,QAAQ,OAId,SAASC,EAAgB9wB,GACtC,MAAMuF,EAAUL,IAEhB,OACE,kBAAC,IAAD,CAAQ6rB,SAAS,SAAS/vB,MAAM,YAAYwE,UAAWD,EAAQmC,SAC7D,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAYhG,QAAQ,MACjB1B,EAAM0E,U","file":"static/js/main.933776b8.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAO4AAABBCAYAAADWpJgZAAAHQklEQVR42u3daWwUZRgH8P/z7ux2i1uqlRZbWmKQiJWotIIJRMAjkRi0HiQajxiPWI8mxisxaIz7wZRoJN6oeJAYY4xRIn7BAxHQaDxoa1AQadVAD4RedIEeOzuvHyq1tDvbXToznS3/37ftvvPOu8/us/O+szNPBTaUUlixYkXgy/Xdy7U2q7TGPAHO0EAYROQw3QNIq4h8g4Dx0aH4F9tTtZZkfwyrMxFWs5YkEnoNoOcyqERekw2hsNR09G5uSStxI2o+AjL1bsuy1gAwGECiCdOmDHXVofjmupSJG1bnICglV8PSnwBaMW5EE25/MJy7oLN3Y/NxS9n/17Rh5OaX5oul1zFpiXzjDLOv7/WRfxxK0AgWInEo8bCGPp2xIvIPDb08z7hs0fC//b+G1RoAbrLbeHlVB5Zf24H8fJORJHJYS3MO1q0txq7fpiR9XizrJgDfHbfGDapTkR9eUNLfG096Bqu6phXPvdzI6BK5qL9fYemCCuz89ZRkT/8a01vOO26qLMjHQNyaYddhzUPNjCqRy3JyLNx1b1vyIy4wY9QaN4BciJZ8uw5nlPYzqkQemFHWb7POlamjEpeIsgsTl4iJS0RMXCJi4hJNFq7dRDBVLRnX9j3WtqzqS0bcrpHq8fNr9uD2u9t8F68XXmvEnfe0ujaukf0de87pfWSioS6CJfMr0xqv12ObkMQ92QxeeGb/eDjLEgaMOFUm4lTZBWvf3Y055UdPePutP9Vn1H73rimovm2OI+Nyo6/Vq8rw7tvTseXHet+Py63Yu/VZ8fPnOOsSd075UVRcGDvh7TPdVkSn1e6cc49gXuVhz/vatzcH+/bmZMW43Iq9W58VP3+OOVUm4lTZ/x66f3ZG7Q8eCKXVbvWqmZhWOOBIX8/VzsS0wnjKNu0HgwCAG24+gEWLe3Ayx97+PSkbM47H3HjLASy8+JBnsfDT2LIicd9+vcSVfjd8PM2xvj5dn35fixb3jPrZ5WSLvRNxPH/eEU8T109j41SZiFNl91Vd3572dMWJvtoPBtP6ps2kr+++GbxDK1uOum7E3ol9lM894tvX7/bYsi5xH1m5z7Eze48+vnfMM64NdZG0EjeTvj58vwgfvl+UdYnrZOwnch+TYWxDU2WNRMC2ESfURJ4Q+4vqJBqNquOOuAaKoS2cn6x1JJKAYYzvt7ndu6ZkvI3dN5uTffnV7ztPgdbiSEwz6atsZj8KiwY8eR/d2kf99jzX9ufF6y843W4qrtWLtd/OBbADAIyQmo6QESiPxxOPJUvPWbN7x/1BPJEraewuznayL78az5VH4+nrkZX7Uk7fvYj9ePexdEGFr96XTF//rLPs882Mmy8VFFx5TWfnxh4V1ud+NhA36+zqKV++rIvzFyKPFBbFcd4Ftie2Lol39e05LXD5rUpDL4PNf+AzDI07qtsYTSIvZ1w1qU5a6iJLW+WSJ5fYLmDve6AFz7zQxEgSeSgeFyyZX4nfdiStrwwlUmt7vjg318KTT//NKBJ5LBjUiK76K2Ub28Tt7VV49umZjCKRxxIJQe1TZ6Zsk/ICjFefL0V1TStKyzIviD685MfWn+rHPC1+rISIUoO/ZXXF/VW6ZqyyLtt+rkvrAoxUZVKIAOCD96ajfntkzCPutwBMu7n2O28UezpoywISCb55dPJa+4r9jR0CdIugSfVL4+KAYVwkQHeyhl99XsBIEnmkoz2IhrqIXdJ+ryOB2d2Jr98xBqxm5OLsehH1jNbWqpGNG//I9de3kU/LzRA5oakx17bQoDKMmu7Ypo6hNe6A7EdQihuQZIoaiwVgmjLuyx6dkk75kIkoN0PkhM6OoN1T+sEnLv4lGt00tMYFtAWBmKnWnUTkPvtcEysajQ4968ltfemU/MjGsi7kT38hhB4Esnbs6fAkcSdrWReiicI7bYmykCdH3Krr21Pe5wkMVgfM5rIuRJMucdMp+ZHtZV2IOFUmook/4jopnfIhE1HWxclyM0STLnEnU1kXIk6ViXjEJRq0FyF0ZenFDEzcE5DpvabzKg/bbuPkfat+7YuIU2UiJi4RcY1LSf3j07eil9/tTFyytx9BBoE4VSaa9IlroRdaLNubYNtaWfmByAsdrcnvxxXo2KjETSAGw8ixvSzozVdLGFEil5mmYMPawqTPaUjLqDWuaXXC7OtrFsifGnrWyI1eWl2KttYQrrq2A3lTWTuVyGltLSG89VoJ9tQnv55dBNughx+B/5OnLgWAWmi9kmEk8pdAQC3tNjdvG5W4Sk1BJLK4ALH+Jg2cylAR+YMAX/boLVeMWuMCgGUdhXm4pVOUqgagGS4iX2iXnNA9o47Awx/E9QEEZfpOJcEuQJYNPyITkfdJi0Cgqmdg046UiQsAA7oZIsYPRiD/B9GyEAD/BwmR99PjTSonlDRpkeqIqpSBioo7g3samm7UlnWdQFdqSDGg+aMukfOJGtNAswi2KiUfdJtfb03V/l9YKg8DJI8iXQAAAABJRU5ErkJggg==\"","import React, {useEffect} from \"react\";\n\nimport {useSnackbar} from \"notistack\";\nimport ChallengeFrame from \"components/ui/challenge-frame\";\nimport CodeEditorCard from \"components/ui/code-editor-card\";\nimport useMarkdown from \"utils/use-markdown\";\nimport docsUrl from \"components/challenges/led.md\";\n\nexport default function Led(props) {\n  const defaultCode = \"// onGravityChange((y, x, z) => {\\n\" +\n    \"//   if (x > 5) moveRight();\\n\" +\n    \"//   if (x < -5) moveLeft();\\n\" +\n    \"//   if (y > 5) moveUp();\\n\" +\n    \"//   if (y < -5) moveDown();\\n\" +\n    \"// })\";\n\n  const markdownText = useMarkdown(docsUrl);\n  const { enqueueSnackbar } = useSnackbar();\n\n  useEffect(() => {\n    props.onStart();\n  }, [props.connected]);\n\n  useEffect(() => {\n    const isButtonDown = !!props.buttonPressed;\n\n    if (isButtonDown && typeof window.thingyOnButtonPressed === \"function\") {\n      window.thingyOnButtonPressed();\n    }\n  }, [props.buttonPressed]);\n\n  function executeCode(code) {\n    const { writeLedColor } = props;\n\n    function sleep(time) { return new Promise(resolve => setTimeout(resolve, time)); }\n\n    function changeColor(color) {\n      console.log(\"changeColor\", color);\n      writeLedColor(color, { ...props.led.reading });\n    }\n\n    function onButtonPressed(callback) {\n      window.thingyOnButtonPressed = callback;\n    }\n\n    // function changeMode(event) {\n    //   props.writeLedMode(event.target.value, this.state.led.reading);\n    // }\n\n    try {\n      eval(\"(async () => {;\\n\" + code + \"\\n;})().catch(e => { enqueueSnackbar(\\\"Ups... wygląda na to, że kod jest niepoprawny :(\\\", { variant: \\\"error\\\", preventDuplicate: true }); })\");\n      enqueueSnackbar(\"Kod wczytany!\", { variant: \"success\", preventDuplicate: true });\n    } catch (e) {\n      console.error(e);\n      enqueueSnackbar(\"Ups... wygląda na to, że kod jest niepoprawny :(\", { variant: \"error\", preventDuplicate: true });\n    }\n  }\n\n  return (\n    <ChallengeFrame\n      headerText=\"Dioda LED i głośnik\"\n      markdownText={markdownText}\n      showcasePanel={<div>{JSON.stringify(props.led)}</div>}\n      codePanel={<CodeEditorCard name=\"ledAndSound\" initial={defaultCode} onRun={executeCode} />}\n    />\n  );\n}\n","module.exports = __webpack_public_path__ + \"static/media/led.3c51df79.md\";","import React, {useEffect} from \"react\";\n\nimport CodeEditorCard from \"components/ui/code-editor-card\";\nimport GameFrame, { gameCommand } from \"components/ui/game-frame\";\nimport ChallengeFrame from \"components/ui/challenge-frame\";\nimport useMarkdown from \"utils/use-markdown\";\n\nimport docsUrl from \"components/challenges/dino.md\";\nconst GAME_NAME = \"trex-game\";\n\nexport default function Dino(props) {\n  const defaultCode = \"// jumpStart();\\n\" +\n    \"\\n\" +\n    \"// onButtonPressed(jumpStart)\\n\" +\n    \"\\n\" +\n    \"// onTap(() => console.log('tap!'));\\n\" +\n    \"\\n\" +\n    \"// onTap(jumpStart);\";\n\n  const markdownText = useMarkdown(docsUrl);\n\n  const trexGameCommand = (cmd) => gameCommand(GAME_NAME, cmd);\n\n  useEffect(() => {\n    if (props.connected) props.onStart();\n    return () => { if (props.connected) props.onEnd(); };\n  }, [props.connected]);\n\n  useEffect(() => {\n    const isButtonDown = !!props.buttonPressed;\n\n    if (isButtonDown && typeof window.thingyOnButtonPressed === \"function\") {\n      window.thingyOnButtonPressed();\n    }\n  }, [props.buttonPressed]);\n\n  useEffect(() => {\n    if (typeof window.thingyOnTap === \"function\") {\n      window.thingyOnTap();\n    }\n  }, [props.tapCount, props.tapDirection]);\n\n  function executeCode(code) {\n    console.log('executeCode', code)\n    function jumpStart() { trexGameCommand(\"JUMP_PRESSED\"); }\n    function jumpEnd() { trexGameCommand(\"JUMP_RELEADED\"); }\n\n    function onButtonPressed(callback) {\n      window.thingyOnButtonPressed = callback;\n    }\n\n    function onTap(callback) {\n      window.thingyOnTap = callback;\n    }\n\n    eval(code);\n  }\n\n  return (\n    <ChallengeFrame\n      headerText=\"Gra: Thingozaurus-Rex\"\n      markdownText={markdownText}\n      showcasePanel={<GameFrame id={GAME_NAME} publicPath=\"/trex-game/dino.game.html\" />}\n      codePanel={<CodeEditorCard name=\"dinoGame\" initial={defaultCode} onRun={executeCode} />}\n    />\n  );\n}\n","module.exports = __webpack_public_path__ + \"static/media/dino.6fae758f.md\";","import React, {useEffect} from \"react\";\nimport {useSnackbar} from \"notistack\";\n\nimport CodeEditorCard from \"components/ui/code-editor-card\";\nimport GameFrame, { gameCommand } from \"components/ui/game-frame\";\nimport ChallengeFrame from \"components/ui/challenge-frame\";\nimport useMarkdown from \"utils/use-markdown\";\nimport docsUrl from \"components/challenges/ball.md\";\n\nconst GAME_NAME = \"ball-game\";\n\nexport default function Ball(props) {\n  const defaultCode = \"// onGravityChange((y, x, z) => {\\n\" +\n    \"//   if (x > 5) moveRight();\\n\" +\n    \"//   if (x < -5) moveLeft();\\n\" +\n    \"//   if (y > 5) moveUp();\\n\" +\n    \"//   if (y < -5) moveDown();\\n\" +\n    \"// })\";\n\n  const markdownText = useMarkdown(docsUrl);\n  const { enqueueSnackbar } = useSnackbar();\n\n  const dinoGameCommand = (cmd) => gameCommand(GAME_NAME, cmd);\n\n  useEffect(() => {\n    if (props.connected) {props.onStart();}\n    return () => { if (props.connected) {props.onEnd();} };\n  }, [props.connected]);\n\n  useEffect(() => {\n    const { x, y, z } = props.gravity;\n\n    if (typeof window.thingyOnGravityChange === \"function\") {\n      window.thingyOnGravityChange(x, y, z);\n    }\n  }, [props.gravity]);\n\n  function executeCode(code) {\n\n    function moveRight() { dinoGameCommand(\"MOVE_RIGHT\"); }\n    function moveLeft() { dinoGameCommand(\"MOVE_LEFT\"); }\n    function moveUp() { dinoGameCommand(\"MOVE_UP\"); }\n    function moveDown() { dinoGameCommand(\"MOVE_DOWN\"); }\n\n    function onGravityChange(callback) {\n      window.thingyOnGravityChange = callback;\n    }\n\n    try {\n      eval(code);\n      enqueueSnackbar(\"Kod wczytany!\", { variant: \"success\", preventDuplicate: true });\n    } catch (e) {\n      console.error(e);\n      enqueueSnackbar(\"Ups... wygląda na to, że kod jest niepoprawny :(\", { variant: \"error\", preventDuplicate: true });\n    }\n  }\n\n  return (\n    <ChallengeFrame\n      headerText=\"Gra: Kulka-Thingulka\"\n      markdownText={markdownText}\n      showcasePanel={<GameFrame id={GAME_NAME} publicPath=\"/ball-game/index.html\" />}\n      codePanel={<CodeEditorCard name=\"ballGame\" initial={defaultCode} onRun={executeCode} />}\n    />\n  );\n}\n","module.exports = __webpack_public_path__ + \"static/media/ball.2b6b753d.md\";","module.exports = __webpack_public_path__ + \"static/media/sensors.f9a7dcf9.md\";","import React, { useState, useEffect } from \"react\";\n\nexport default function useMarkdown(src) {\n  const [ markdownText, setMarkdownText ] = useState(\"\");\n\n  useEffect(() => {\n    fetch(src)\n      .then(r => r.text())\n      .then(md => setMarkdownText(md));\n  }, [src]);\n\n  return markdownText;\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Prism } from \"react-syntax-highlighter\";\nimport { prism } from \"react-syntax-highlighter/dist/esm/styles/prism\";\n\nexport default function MarkdownCodeBlock(props) {\n  const { language, value } = props;\n  return <Prism language={language} style={prism}>{value}</Prism>;\n}\n\nMarkdownCodeBlock.propTypes = {\n  value: PropTypes.string.isRequired,\n  language: PropTypes.string\n};\n\nMarkdownCodeBlock.defaultProps = {\n  language: null\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport ReactMarkdown from \"react-markdown\";\nimport {makeStyles} from \"@material-ui/core\";\n\nimport MarkdownCodeBlock from \"./markdown-code-block\";\n\nconst useStyles = makeStyles(theme => ({\n  markdown: {\n    // fontFamily: theme.typography.fontFamily\n  }\n}));\n\nexport default function Markdown(props) {\n  const classes = useStyles();\n  return <ReactMarkdown\n    className={classes.markdown}\n    renderers={{ code: MarkdownCodeBlock }}\n    source={props.input}\n  />;\n}\n\nMarkdown.propTypes = {\n  input: PropTypes.string\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { makeStyles } from \"@material-ui/core\";\nimport Markdown from \"components/ui/markdown\";\n\nimport ChallengeHeader from \"components/ui/challenge-header\";\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    height: \"100vh\"\n  },\n  main: {\n    flexGrow: 1,\n    display: \"flex\",\n  },\n  sourcePanel: {\n    flexGrow: 1,\n    display: \"flex\",\n    flexDirection: \"column\"\n  },\n  codePanel: {\n    flexGrow: 1,\n  },\n  textPanel: {\n    width: \"40em\",\n    padding: theme.spacing(2)\n  },\n}));\n\nexport default function ChallengeFrame(props) {\n  const classes = useStyles();\n  const { headerText, markdownText, showcasePanel, codePanel } = props;\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.header}>\n        <ChallengeHeader text={headerText} />\n      </div>\n      <div className={classes.main}>\n        <div className={classes.sourcePanel}>\n          {showcasePanel}\n          <div className={classes.codePanel}>{codePanel}</div>\n        </div>\n        <div className={classes.textPanel}>\n          {markdownText ? <Markdown input={markdownText} /> : null}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nChallengeFrame.propTypes = {\n  headerText: PropTypes.string.isRequired,\n  markdownText: PropTypes.string,\n  showcasePanel: PropTypes.object,\n  codePanel: PropTypes.object\n}\n","import React, {Fragment} from \"react\";\nimport {makeStyles} from \"@material-ui/core/styles\";\nimport List from \"@material-ui/core/List\";\nimport Divider from \"@material-ui/core/Divider\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport {Link as RouterLink} from \"react-router-dom\";\n\nimport logo from \"assets/czarodzieje-logo.png\";\n\nfunction ListItemLink(props) {\n  const { icon, primary, secondary, to } = props;\n\n  const renderLink = React.useMemo(\n    () =>\n      React.forwardRef((itemProps, ref) => (\n        // With react-router-dom@^6.0.0 use `ref` instead of `innerRef`\n        // See https://github.com/ReactTraining/react-router/issues/6056\n        <RouterLink to={to} {...itemProps} innerRef={ref} />\n      )),\n    [to],\n  );\n\n  return (\n    <li>\n      <ListItem button component={renderLink}>\n        {icon ? <ListItemIcon>{icon}</ListItemIcon> : null}\n        <ListItemText primary={primary} secondary={secondary} />\n      </ListItem>\n    </li>\n  );\n}\n\nconst useStyles = makeStyles(theme => ({\n  toolbar: {\n    ...theme.mixins.toolbar,\n    backgroundColor: theme.palette.primary.main,\n    padding: theme.spacing(1),\n    textAlign: \"center\"\n  },\n  toolbarImg: {\n    maxHeight: \"100%\",\n    maxWidth: \"100%\"\n  },\n}));\n\nexport default function Menu(props) {\n  const classes = useStyles();\n\n  return (\n    <Fragment>\n      <div className={classes.toolbar}>\n        <img src={logo} alt=\"Czarodzieje Kodu\" className={classes.toolbarImg} />\n      </div>\n      <Divider />\n      <List>\n        {props.items.map(item => <ListItemLink key={item.path} to={item.path} primary={item.primary} secondary={item.secondary} />)}\n        <Divider />\n      </List>\n    </Fragment>\n  );\n}\n\n","import React from \"react\";\nimport {makeStyles} from \"@material-ui/core/styles\";\nimport Typography from \"@material-ui/core/Typography\";\n\nimport thingyImage from \"assets/thingy-product.png\";\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    flexFlow: \"column\",\n    width: \"100%\",\n    height: \"80vh\",\n    textAlign: \"center\"\n  },\n  thingyName: {\n    color: \"#ccc\"\n  }\n}));\n\nexport default function NotConnectedView() {\n  const classes = useStyles();\n\n  const thingyName = localStorage.getItem(\"thingyName\");\n\n  return (\n    <div className={classes.root}>\n      <img src={thingyImage} alt=\"\" />\n      <div className={classes.message}>\n        <Typography variant=\"h5\">\n          Ups, Twoje Thingy nie jest połączone!\n        </Typography>\n        {\n          thingyName\n            ? <Typography variant=\"h6\" className={classes.thingyName}>{thingyName}</Typography>\n            : null\n        }\n      </div>\n    </div>\n  );\n}\n","export const RECEIVE_NEW_READING = \"RECEIVE_NEW_READING\";\nexport const RECEIVE_NEW_NOTIFY_READING = \"RECEIVE_NEW_NOTIFY_READING\";\nexport const FEATURE_NOTIFICATION_STATUS = \"NOTIFY_FEATURE_STATUS\";\nexport const CLEAN_THE_SLATE = \"CLEAN_THE_SLATE\";\nexport const NOTIFY_USER = \"NOTIFY_USER\";\nexport const SET_FEATURE_HAS_EVENT_LISTENER = \"SET_FEATURE_HAS_EVENT_LISTENER\";\n\nexport const receiveNewReading = (feature, reading) => ({\n  type: RECEIVE_NEW_READING,\n  reading: {\n    feature,\n    reading,\n  },\n});\n\nexport const receiveNewNotifyReading = (feature, reading) => ({\n  type: RECEIVE_NEW_NOTIFY_READING,\n  reading: {\n    feature,\n    reading,\n  },\n});\n\nexport const featureNotificationStatus = (feature, status) => ({\n  type: FEATURE_NOTIFICATION_STATUS,\n  status: {\n    feature,\n    status,\n  },\n});\n\nexport const cleanTheSlate = () => ({\n  type: CLEAN_THE_SLATE,\n});\n\nexport const notifyUser = (message, category) => ({\n  type: NOTIFY_USER,\n  message,\n  category,\n});\n\nexport const setFeatureHasEventListener = (feature) => ({\n  type: SET_FEATURE_HAS_EVENT_LISTENER,\n  feature,\n});\n\n// toggle parameter: \"both\" - function as normal toggle, \"on\" - only allow sensors to become active, \"off\" - only allow sensors to go inactive\nexport const toggleFeature = (feature, toggle=\"both\", isMicrophone=false) => {\n  return async (dispatch, getState) => {\n    try {\n      if (feature === \"gas\") {\n        dispatch(notifyFeatures([\"tvoc\", \"co2\"], toggle));\n        return;\n      }\n\n      const state = await getState();\n      const status = state.thingy[feature].status;\n      const hasEventListener = state.thingy[feature].hasEventListener || false;\n\n      if (toggle === \"both\" || (toggle === \"on\" && !status) || (toggle === \"off\" && status)) {\n        const featureToUpdateStatusFor = feature;\n\n        if ([\"tvoc\", \"co2\"].includes(feature)) {\n          const isNot = feature === \"tvoc\" ? \"co2\" : \"tvoc\";\n          const isNotStatus = state.thingy[isNot].status;\n\n          if (isNotStatus) {\n            dispatch(featureNotificationStatus(featureToUpdateStatusFor, !status));\n            return;\n          }\n\n          feature = \"gas\";\n        }\n\n        let e;\n\n        if (isMicrophone) {\n          if (!status) {\n            await window.thingy.mtu.write(276);\n          }\n          e = (data) => {\n            const tempData = data.detail;\n            window.thingy.microphone.play(tempData);\n          };\n        } else {\n          e = (reading) => {\n            dispatch(receiveNewNotifyReading(feature, reading));\n          };\n        }\n\n        if (!status) {\n          if (!hasEventListener) {\n            window.thingy.addEventListener(feature, e);\n            dispatch(setFeatureHasEventListener(feature));\n          }\n          await window.thingy[feature].start();\n          dispatch(featureNotificationStatus(featureToUpdateStatusFor, true));\n        } else {\n          await window.thingy[feature].stop();\n          dispatch(featureNotificationStatus(featureToUpdateStatusFor, false));\n        }\n      }\n    } catch (error) {\n      // These errors might occur because we try to stop several ongoing notify operations after disconnecting from Thingy, which naturally is not possible.\n      // Queue the conditional under\n      if (error.message !== \"Cannot read property 'gattBusy' of undefined\" || error.message !== \"Cannot set property 'gattBusy' of undefined\") {\n        // should actually do something here\n\n        // do\n        // the\n        // something\n      }\n\n      return;\n    }\n  };\n};\n\n// notifies the list of features, given that they are not already active\nconst notifyFeatures = (features, toggle=\"both\") => {\n  return async (dispatch) => {\n    for (const f of features) {\n      await dispatch(toggleFeature(f, toggle));\n    }\n  };\n};\n\nexport const toggleEnvironment = (toggle) => {\n  const environmentFeatures = [\"temperature\", \"pressure\", \"humidity\", \"co2\", \"tvoc\", \"color\"];\n\n  return (dispatch) => {\n    dispatch(notifyFeatures(environmentFeatures, toggle));\n  };\n};\n\nexport const toggleMotion = (toggle) => {\n  const motionFeatures = [\"stepcounter\", \"tap\", \"heading\", \"quaternionorientation\"];\n\n  return (dispatch) => {\n    dispatch(notifyFeatures(motionFeatures, toggle));\n  };\n};\n\n\nexport const writeToSpeaker = (data) => {\n  return async (dispatch, getState) => {\n    await window.thingy.soundconfiguration.write({speakerMode: data.mode});\n    if (data.mode !== 2) {\n      await window.thingy.speakerdata.write(data);\n    } else {\n      let speakerStatusReady = true;\n      try {\n        dispatch(receiveNewReading(\"pcm\", {reading: {playStatus: 1}}));\n        await window.thingy.mtu.write(273);\n        const myLogger = (data) => {\n          const speakerStatus = data.detail.status;\n          switch (speakerStatus) {\n          case 0:\n            speakerStatusReady = true;\n            break;\n          case 1:\n            speakerStatusReady = false;\n            break;\n          case 16:\n            speakerStatusReady = false;\n            break;\n          default:\n            speakerStatusReady = true;\n          }\n        };\n        window.thingy.addEventListener(\"speakerstatus\", myLogger);\n        let index = 0;\n        const packetSize = 160;\n        let packets = 0;\n        let timer;\n        let retries = 0;\n        speakerStatusReady = true;\n        const writeSoundPCMBatch = async () => {\n          // Can write max 273 Bytes (MTU) at a time to the characteristic.\n          // Writing with maximum data payload might result in Thingy speaker buffer filling up and packets will be dropped.\n          // Sending 160 Byte batches has proved to be reliable.\n\n          // check if stop button was pressed\n          const state = getState();\n          if (state.thingy.pcm.reading.reading.playStatus === 0) {\n            return;\n          }\n          if (speakerStatusReady === false) {\n            // Do a sanity check in case notifications have stopped whilst whe are retrying or we might en up in an endless loop of retries.\n            // If there are 10 retries in a row it probably means notifications have stopped.\n            if ((retries > 0) && (retries % 10) === 0) {\n              await window.thingy.speakerstatus.start();\n              retries = 0;\n            } else {\n              retries++;\n            }\n            // Delay execution by 10ms if Thingy audio buffer is almost full\n            timer = setTimeout(function() {\n              writeSoundPCMBatch();\n            }, 10);\n          } else {\n            // write 160 Byte chunks of 8-bit audio data to Thingy\n            if (index + packetSize < data.data.length) {\n              await window.thingy.speakerdata.write({mode: 2, data: data.data.slice(index, index + packetSize)});\n              index += packetSize;\n              packets++;\n              // There is possibly a bug in Chrome that leads to the notification callback not firing. Happens irregularly.\n              // Restart notifications every 20 packets to make sure notifications are running.\n              // This does not add an audible delay to the aduio transmission.\n              if (packets % 20 === 0) {\n                // await window.thingy.speakerstatus.start();\n              }\n              // reset retries on successfull write\n              retries = 0;\n              // Repeat\n              writeSoundPCMBatch();\n            } else {\n              // Send the last bytes\n              if (index < data.data.length) {\n                await window.thingy.speakerdata.write({mode: 2, data: data.data.slice(index, data.data.length - 1)});\n              } else {\n                return;\n              }\n            }\n          }\n        };\n        await window.thingy.speakerstatus.start();\n        await window.thingy.soundconfiguration.write({speakerMode: 2});\n        writeSoundPCMBatch();\n      } catch (error) {\n        // do something\n      }\n    }\n  };\n};\n\nexport const stopAudioStream = () => {\n  return (dispatch) => {\n    dispatch(receiveNewReading(\"pcm\", {reading: {playStatus: 0}}));\n  };\n};\n\nexport const notifyMicrophone = (enable) => {\n  return async (dispatch) => {\n    dispatch(featureNotificationStatus(\"microphone\", enable));\n\n    const myLogger = (data) => {\n      const tempData = data.detail;\n      window.thingy.microphone.play(tempData);\n    };\n\n    if (enable) {\n      try {\n        await window.thingy.mtu.write(276);\n        window.thingy.addEventListener(\"microphone\", myLogger);\n        await window.thingy.microphone.start();\n      } catch (error) {\n        // do something\n      }\n    } else {\n      window.thingy.removeEventListener(\"microphone\", myLogger);\n      await window.thingy.microphone.stop();\n    }\n  };\n};\n\nexport const readFeature = (feature) => {\n  return async (dispatch) => {\n    try {\n      const reading = await window.thingy[feature].read();\n      dispatch(receiveNewReading(feature, reading));\n    } catch (e) {\n      return;\n    }\n  };\n};\n\nexport const writeFeature = (feature, value) => {\n  return async (dispatch) => {\n    try {\n      await window.thingy[feature].write(value);\n      const reading = await window.thingy[feature].read();\n      dispatch(receiveNewReading(feature, reading));\n    } catch (e) {\n      console.error(e);\n    }\n  };\n};\n\nexport const onConnectionEvent = (state) => {\n  return (dispatch) => {\n    dispatch(receiveNewReading(\"connected\", state));\n  };\n};\n\nexport const disconnect = () => {\n  return async (dispatch) => {\n    await window.thingy.disconnect();\n    dispatch(cleanTheSlate());\n  };\n};\n\nexport const triggerIFTTT = (eventName) => {\n  return async (dispatch, getState) => {\n    const state = getState();\n    const key = state.thingy.ifttt.key;\n\n    if (key === \"\") {\n      dispatch(notifyUser({message: \"You have to configure your IFTTT key before you can trigger events on the IFTTT platform\", category: \"warning\"}));\n    } else {\n      if ([\"\", undefined].includes(eventName)) {\n        dispatch(notifyUser({message: \"You can't trigger a nameless event\", category: \"warning\"}));\n      } else {\n        const url = `https://maker.ifttt.com/trigger/${eventName}/with/key/${key}`;\n\n        await fetch(url, {\n          method: \"GET\",\n          credentials: \"omit\",\n          mode: \"no-cors\",\n        });\n\n        dispatch(notifyUser({message: `An event with the name ${String.fromCharCode(parseInt(\"+ab\", 16))}${eventName}${String.fromCharCode(parseInt(\"+bb\", 16))} was triggered on the IFTTT platform`, category: \"success\"}));\n      }\n    }\n  };\n};\n\nexport const startDisconnectNotification = () => {\n  return async (dispatch) => {\n    const disconnectListener = async (e) => {\n      await window.thingy.disconnect();\n      dispatch(cleanTheSlate());\n      dispatch(onConnectionEvent(false));\n      dispatch(notifyUser({message: \"Lost connection to your device. Please try to reconnect\", category: \"error\"}));\n    };\n\n    window.thingy.addEventListener(\"disconnected\", disconnectListener);\n  };\n};\n\nexport const startErrorNotification = () => {\n  return async (dispatch, getState) => {\n    const errorListener = (e) => {\n      if (e.detail !== undefined) {\n        const state = getState();\n        if (state.thingy.connected.reading) {\n          dispatch(notifyUser({message: e.detail.body.message, category: \"error\"}));\n        }\n      } else {\n        dispatch(notifyUser({message: String(e), category: \"error\"}));\n      }\n    };\n    window.thingy.addEventListener(\"error\", errorListener);\n  };\n};\n\nexport const startWriteNotification = () => {\n  return async (dispatch) => {\n    const writeListener = (write) => {\n      const configurationTypes = [\n        \"name\",\n        \"advertisingparameters\",\n        \"connectionparameters\",\n        \"eddystone\",\n        \"cloudtoken\",\n        \"environmentconfiguration\",\n        \"motionconfiguration\",\n      ];\n      if (write.detail) {\n        if (configurationTypes.includes(write.detail.feature)) {\n          dispatch(notifyUser({message: \"Success\", category: \"success\"}));\n        }\n      }\n    };\n    window.thingy.addEventListener(\"write\", writeListener);\n  };\n};\n\nexport const startBatteryNotification = () => {\n  return async (dispatch) => {\n    const batteryListener = (reading) => {\n      dispatch(receiveNewNotifyReading(\"battery\", reading));\n    };\n    window.thingy.addEventListener(\"battery\", batteryListener);\n    const batteryLevel = await window.thingy.battery.read();\n    dispatch(receiveNewReading(\"battery\", batteryLevel));\n    await window.thingy.battery.start();\n  };\n};\n\nexport const notifyError = (e) => {\n  return (dispatch) => {\n    dispatch(notifyUser({message: String(e), category: \"error\"}));\n  };\n};\n","/*\nCopyright 2018 Kenneth Rohde Christiansen\n\nRedistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:\n\n1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.\n\n2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.\n\n3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nfunction defineProperties(target, descriptions) {\n  for (const property in descriptions) {\n    Object.defineProperty(target, property, {\n      configurable: true,\n      value: descriptions[property],\n    });\n  }\n}\n\nconst EventTargetMixin = (superclass, ...eventNames) => class extends superclass {\n  constructor(...args) {\n    super(args);\n    const eventTarget = document.createDocumentFragment();\n\n\n    this.addEventListener = (type, ...args) => {\n      return eventTarget.addEventListener(type, ...args);\n    };\n\n    this.removeEventListener = (...args) => {\n      return eventTarget.removeEventListener(...args);\n    };\n\n    this.dispatchEvent = (event) => {\n      defineProperties(event, {currentTarget: this});\n      if (!event.target) {\n        defineProperties(event, {target: this});\n      }\n\n      const methodName = `on${event.type}`;\n      if (typeof this[methodName] === \"function\") {\n        this[methodName](event);\n      }\n\n      const retValue = eventTarget.dispatchEvent(event);\n\n      if (retValue && this.parentNode) {\n        this.parentNode.dispatchEvent(event);\n      }\n\n      defineProperties(event, {currentTarget: null, target: null});\n\n      return retValue;\n    };\n  }\n};\n\nexport default class EventTarget extends EventTargetMixin(Object) {};\n","import EventTarget from \"./EventTarget.js\";\n\nclass Utilities extends EventTarget {\n    constructor(device) {\n      super();\n  \n      this.device = device;\n    }\n  \n\n    async wait(ms) {\n      return new Promise((resolve) => setTimeout(resolve, ms));\n    }\n\n    processEvent(type, feature, body, target = this.device) {\n      let eventObject;\n\n      switch(true) {\n        case (type === feature || type === \"operationdiscarded\"):\n          eventObject = body;\n          break;\n        default: {\n          eventObject = {\n            feature,\n            body,\n          }\n\n          break;\n        }\n      }\n\n      const ce = new CustomEvent(type, {detail: eventObject});\n  \n      target.dispatchEvent(ce);\n    }\n}\n\nexport default Utilities;","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport Utilities from \"./Utilities.js\";\n\nclass ThingyController {\n  constructor(device) {\n\n    // thingy id)\n    this.setDevice(device);\n    this.utilities = new Utilities(device);\n    this._initialize();\n  }\n\n  _initialize() {\n    if (window.thingyController === undefined) {\n        window.thingyController = {};\n      }\n\n      if (window.thingyController[this.tid] === undefined) {\n        window.thingyController[this.tid] = {};\n      }\n\n      if (window.thingyController[this.tid].gattStatus === undefined) {\n        window.thingyController[this.tid].gattStatus = true;\n      }\n\n      if (window.thingyController[this.tid].queuedOperations === undefined) {\n        window.thingyController[this.tid].queuedOperations = [];\n      }\n\n      if (window.thingyController[this.tid].executingQueuedOperations === undefined) {\n        window.thingyController[this.tid].executingQueuedOperations = false;\n      }\n\n      if (window.thingyController[this.tid].executedOperations === undefined) {\n        window.thingyController[this.tid].executedOperations = [];\n      }\n  }\n\n  addExecutedOperation(feature, method) {\n    if (this.device.getConnected()) {\n      window.thingyController[this.tid].executedOperations.push({feature, method});\n    }\n  }\n\n  clearExecutedOperations() {\n    window.thingyController[this.tid].executedOperations = [];\n  }\n\n  setGattStatus(bool) {\n    if (this.device.getConnected()) {\n      window.thingyController[this.tid].gattStatus = bool;\n\n      if (bool) {\n        this.utilities.processEvent(\"gattavailable\");\n      }\n    }\n  }\n\n  getGattStatus() {\n    if (this.device.getConnected()) {\n      return window.thingyController[this.tid].gattStatus;\n    }\n  }\n\n  getNumQueuedOperations() {\n    if (this.device.getConnected()) {\n      return window.thingyController[this.tid].queuedOperations.length;\n    }\n  }\n\n  getQueuedOperation(index) {\n    if (this.device.getConnected()) {\n      if (window.thingyController[this.tid].queuedOperations.length >= index) {\n        return window.thingyController[this.tid].queuedOperations[index];\n      }\n    }\n  }\n\n  // removes either by index or by operation specifics (feature and method)\n  removeQueuedOperation(x) {\n    if (this.device.getConnected()) {\n      if (Number.isInteger(x)) {\n        window.thingyController[this.tid].queuedOperations.splice(x, 1);\n      } else {\n        for (let i=0;i<this.getNumQueuedOperations();i++) {\n          const op = this.getQueuedOperation(i);\n      \n          if (x.feature === op.feature && x.method === op.method) {\n            this.removeQueuedOperation(i);\n            i--;\n          }\n        }\n      }\n    }\n  }\n\n  enqueue(feature, method, f) {\n    if (this.device.getConnected()) {\n      window.thingyController[this.tid].queuedOperations.push({feature, method, f});\n      this.utilities.processEvent(\"operationqueued\");\n    }\n  }\n\n  dequeue() {\n    if (this.device.getConnected()) {\n      return window.thingyController[this.tid].queuedOperations.shift();\n    }\n  }\n\n  setExecutingQueuedOperations(bool) {\n    if (this.device.getConnected()) {\n      window.thingyController[this.tid].executingQueuedOperations = bool;\n\n      if (bool) {\n       this.clearExecutedOperations();\n      }\n    }\n  }\n\n  getExecutingQueuedOperations() {\n    if (this.device.getConnected()) {\n      return window.thingyController[this.tid].executingQueuedOperations;\n    }\n  }\n\n  getDevice() {\n    return this.device;\n  }\n\n  setDevice(device) {\n    this.device = device;\n    this.tid = device.device.id;\n  }\n\n  getExecutedOperation(index) {\n    if (this.device.getConnected()) {\n      return window.thingyController[this.tid].executedOperations[index];\n    }\n  }\n\n  getNumExecutedOperations() {\n    if (this.device.getConnected()) {\n      return window.thingyController[this.tid].executedOperations.length;\n    }\n  }\n\n  terminate() {\n    window.thingyController[this.tid] = undefined;\n  }\n}\n\nexport default ThingyController;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport EventTarget from \"./EventTarget.js\";\nimport ThingyController from \"./ThingyController.js\";\nimport Utilities from \"./Utilities.js\";\n\nclass FeatureOperations {\n  constructor(device, type) {\n    this.device = device;\n    this.utilities = new Utilities(this.device);\n    this.type = type || this.constructor.name;\n    this.latestReading = new Map();\n  }\n\n  async _connect() {\n    if (!(\"thingyController\" in this)) {\n      // has to be put here rather than in the constructor as we need access to the id of the device\n      // which is not accessible before the device has performed its connect method\n      this.thingyController = new ThingyController(this.device);\n    }\n\n    this.thingyController.addExecutedOperation(this.type, \"connect\");\n    \n    if ((\"connected\" in this.characteristic) && this.characteristic.connected) {\n      if (this.device.logEnabled) {\n        console.log(`You're already connected to the ${this.type} feature`);\n      }\n\n      return true;\n    }\n\n    if (this.thingyController.getGattStatus()) {\n      try {\n        this.thingyController.setGattStatus(false);\n\n        this.service.service = await this.device.server.getPrimaryService(this.service.uuid);\n        this.characteristic.characteristic = await this.service.service.getCharacteristic(this.characteristic.uuid);\n\n        this.thingyController.setGattStatus(true);\n\n        this.characteristic.connected = true;\n        this.characteristic.notifying = false;\n        this.characteristic.hasEventListener = false;\n\n        /*\n        // This approach needs to be fundamentally revised\n        // For now we'll leave it here, commented out\n        if (this.characteristic.verifyAction && this.characteristic.verifyReaction) {\n          await this.characteristic.verifyAction();\n\n          this.addEventListener(\"verifyReaction\", this.characteristic.verifyReaction);\n\n          const verifyValue = await this._notify(true, true);\n\n          // something needs to be done here depending on the value returned\n          // by the functions over. Could prove difficult, will have to see if\n          // we can alter how verifyAction & verifyReaction works, as it's\n          // only used by the microphone per now\n        }*/\n\n        if (this.device.logEnabled) {\n          console.log(`Connected to the ${this.type} feature`);\n        }\n\n        return true;\n      } catch (error) {\n        if (\"thingyController\" in this) {\n          this.thingyController.setGattStatus(true);\n          this.thingyController.enqueue(this.type, \"connect\", this._connect.bind(this));\n        }\n        \n        this.characteristic.connected = false;\n\n        if (\"utilities\" in this) {\n          this.utilities.processEvent(\"error\", this.type, error);\n        }\n        \n        return false;\n      }\n    } else {\n      this.thingyController.enqueue(this.type, \"connect\", this._connect.bind(this));\n      return false;\n    }\n  }\n\n  async _read(returnRaw = false) {\n    try {\n      let connectIteration = 0;\n      let readIteration = 0;\n      let returnValue = false;\n\n      if (!this.characteristic.connected) {\n        await this._connect();\n      }\n\n      while (!this.characteristic.connected) {\n        connectIteration++;\n\n        if (connectIteration === 250) {\n          const error = new Error(`As we couldn't connect to the ${this.type} feature, the read operation can't be executed`);\n          this.utilities.processEvent(\"error\", this.type, error);\n          return false;\n        }\n\n        // waiting a set amount of time for any ongoing BLE operation to conclude\n        await this.utilities.wait(20);\n      }\n\n      this.thingyController.addExecutedOperation(this.type, \"read\");\n\n      if (!this.hasProperty(\"read\")) {\n        const error = new Error(`The ${this.type} feature does not support the read method`);\n        this.utilities.processEvent(\"error\", this.type, error);\n        return false;\n      }\n\n      if (!this.characteristic.decoder) {\n        const error = new Error(\"The characteristic you're trying to read does not have a specified decoder\");\n        this.utilities.processEvent(\"error\", this.type, error);\n        return false;\n      }\n\n      while (returnValue === false) {\n        readIteration++;\n\n        if (readIteration === 250) {\n          const error = new Error(\"We could not process your read request at the moment due to high operational traffic\");\n          this.utilities.processEvent(\"error\", this.type, error);\n          return false;\n        }\n\n        if (this.thingyController.getGattStatus()) {\n          this.thingyController.setGattStatus(false);\n          let prop = await this.characteristic.characteristic.readValue();\n          this.thingyController.setGattStatus(true);\n\n          if (returnRaw !== true) {\n            prop = await this.characteristic.decoder(prop);\n          }\n\n          returnValue = prop;\n        } else {\n          // waiting a set amount of time for any ongoing BLE operation to conclude\n          await this.utilities.wait(20);\n        }\n      }\n\n      return returnValue;\n    } catch (error) {\n      this.thingyController.setGattStatus(true);\n      this.utilities.processEvent(\"error\", this.type, error);\n      return false;\n    }\n  }\n\n  async _write(prop) {\n    try {\n      if (prop === undefined) {\n        const error = new Error(\"You have to write a non-empty body\");\n        this.utilities.processEvent(\"error\", this.type, error);\n        return false;\n      }\n\n      let connectIteration = 0;\n      let writeIteration = 0;\n      let returnValue = false;\n\n      if (!this.characteristic.connected) {\n        await this._connect();\n      }\n\n      while (!this.characteristic.connected) {\n        connectIteration++;\n\n        if (connectIteration === 250) {\n          const error = new Error(`As we couldn't connect to the ${this.type} feature, the write operation can't be executed`);\n          this.utilities.processEvent(\"error\", this.type, error);\n          return false;\n        }\n\n        // waiting a set amount of time for any ongoing BLE operation to conclude\n        await this.utilities.wait(20);\n      }\n\n      this.thingyController.addExecutedOperation(this.type, \"write\");\n\n      if (!this.hasProperty(\"write\") && !this.hasProperty(\"writeWithoutResponse\")) {\n        const error = new Error(`The ${this.type} feature does not support the write or writeWithoutResponse method`);\n        this.utilities.processEvent(\"error\", this.type, error);\n        return false;\n      }\n\n      if (!this.characteristic.encoder) {\n        const error = new Error(\"The characteristic you're trying to write does not have a specified encoder\");\n        this.utilities.processEvent(\"error\", this.type, error);\n        return false;\n      }\n\n      while (returnValue === false) {\n        writeIteration++;\n\n        if (writeIteration === 250) {\n          const error = new Error(\"We could not process your read request at the moment due to high operational traffic\");\n          this.utilities.processEvent(\"error\", this.type, error);\n          return false;\n        }\n\n        if (this.thingyController.getGattStatus()) {\n          const encodedProp = await this.characteristic.encoder(prop);\n          this.thingyController.setGattStatus(false);\n          await this.characteristic.characteristic.writeValue(encodedProp);\n          this.thingyController.setGattStatus(true);\n\n          // emit event for successful write\n          this.utilities.processEvent(\"write\", this.type, prop);\n\n          returnValue = true;\n        } else {\n          // waiting a set amount of time for any ongoing BLE operation to conclude\n          await this.utilities.wait(20);\n        }\n      }\n\n      return returnValue;\n    } catch (error) {\n      this.thingyController.setGattStatus(true);\n      this.utilities.processEvent(\"error\", this.type, error);\n      return false;\n    }\n  }\n\n  async _notify(enable, verify = false) {\n    if (!(enable === true || enable === false)) {\n      const error = new Error(\"You have to specify the enable parameter (true/false)\");\n      this.utilities.processEvent(\"error\", this.type, error);\n      return;\n    }\n\n    if (!this.characteristic.connected) {\n      const connected = await this._connect();\n\n      if (!connected) {\n        this.thingyController.enqueue(this.type, (enable ? \"start\" : \"stop\"), this._notify.bind(this, enable, verify));\n        return false;\n      }\n    }\n\n    this.thingyController.addExecutedOperation(this.type, (enable ? \"start\" : \"stop\"));\n\n    if (!this.hasProperty(\"notify\") && !this.hasProperty(\"indicate\")) {\n      const error = new Error(`The ${this.type} feature does not support the start/stop methods`);\n      this.utilities.processEvent(\"error\", this.type, error);\n      return;\n    }\n\n    if (enable === this.characteristic.notifying) {\n      if (this.device.logEnabled) {\n        console.log(`The ${this.type} feature has already ${(this.characteristic.notifying ? \"enabled\" : \"disabled\")} notifications`);\n      }\n      // could also just return, but technically the operation\n      // completed successfully as the desired outcome was achieved\n      return true;\n    }\n\n    if (!this.characteristic.decoder) {\n      const error = new Error(\"The characteristic you're trying to notify does not have a specified decoder\");\n      this.utilities.processEvent(\"error\", this.type, error);\n      return;\n    }\n\n    const onReading = async (e) => {\n      try {\n        const data = await this.characteristic.decoder(e.target.value);\n\n        if (verify) {\n          /*ce = new CustomEvent(\"verifyReaction\", {detail: {feature: this.type, data: decodedData}});\n          this.dispatchEvent(ce);*/\n        } else {\n          this.utilities.processEvent(this.type, this.type, data);\n        }\n      } catch (error) {\n        this.utilities.processEvent(\"error\", this.type, error);\n      }\n    };\n\n    const characteristic = this.characteristic.characteristic;\n\n    if (this.thingyController.getGattStatus()) {\n      this.thingyController.setGattStatus(false);\n      if (enable) {\n        try {\n          const csn = await characteristic.startNotifications();\n          this.thingyController.setGattStatus(true);\n          \n          if (!this.characteristic.hasEventListener) {\n            csn.addEventListener(\"characteristicvaluechanged\", onReading.bind(this));\n            this.characteristic.hasEventListener = true;\n          }\n\n          this.characteristic.notifying = true;\n\n          if (this.device.logEnabled) {\n            console.log(`Notifications enabled for the ${this.type} feature`);\n          }\n\n          return true;\n        } catch (error) {\n          this.thingyController.setGattStatus(true);\n          this.thingyController.enqueue(this.type, (enable ? \"start\" : \"stop\"), this._notify.bind(this, enable, verify));\n          this.characteristic.notifying = false;\n          this.utilities.processEvent(\"error\", this.type, error);\n          return false;\n        }\n      } else {\n        try {\n          const csn = await characteristic.stopNotifications();\n          this.thingyController.setGattStatus(true);\n\n          this.characteristic.notifying = false;\n\n          // not ideal\n          if (this.type === \"microphone\") {\n            if (this.audioCtx) {\n              this.suspendAudioContext();\n            }\n          }\n\n          if (this.device.logEnabled) {\n            console.log(`Notifications disabled for the ${this.type} feature`);\n          }\n\n          return true;\n        } catch (error) {\n          this.thingyController.setGattStatus(true);\n          this.thingyController.enqueue(this.type, (enable ? \"start\" : \"stop\"), this._notify.bind(this, enable, verify));\n          this.characteristic.notifying = true;\n          this.utilities.processEvent(\"error\", this.type, error);\n          return false;\n        }\n      }\n    } else {\n      this.thingyController.enqueue(this.type, (enable ? \"start\" : \"stop\"), this._notify.bind(this, enable, verify));\n      return false;\n    }\n  }\n\n  hasProperty(property) {\n    return (this.characteristic.characteristic.properties[property] === true ? true : false);\n  }\n\n  async start() {\n    return await this._notify(true);\n  }\n\n  async stop() {\n    return await this._notify(false);\n  }\n\n  async read() {\n    return await this._read();\n  }\n\n  async write(data) {\n    return await this._write(data);\n  }\n}\n\nexport default FeatureOperations;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass AdvertisingParametersService extends FeatureOperations {\n  constructor(device) {\n    super(device, \"advertisingparameters\");\n\n    // gatt service and characteristic used to communicate with thingy's advertising parameters configuration\n    this.service = {\n      uuid: this.device.TCS_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TCS_ADV_PARAMS_UUID,\n      decoder: this.decodeAdvertisingParam.bind(this),\n      encoder: this.encodeAdvertisingParam.bind(this),\n    };\n  }\n\n  decodeAdvertisingParam(data) {\n    try {\n      // Interval is given in units of 0.625 milliseconds\n      const littleEndian = true;\n      const interval = (data.getUint16(0, littleEndian) * 0.625).toFixed(0);\n      const timeout = data.getUint8(2);\n      const decodedAdvertisingParams = {\n        interval: interval,\n        timeout: timeout,\n      };\n      return decodedAdvertisingParams;\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  async encodeAdvertisingParam(params) {\n    try {\n\n      if (typeof params !== \"object\") {\n        const error = new Error(\"The argument has to be an object.\");\n        throw error;\n      }\n\n      if ((params.interval === undefined) && (params.timeout === undefined)) {\n        const error = new RangeError(\"The argument has to be an object with at least one of the properties 'interval' or 'timeout': {interval: someInterval, timeout: someTimeout}\");\n        throw error;\n      }\n\n      let interval = params.interval;\n      let timeout = params.timeout;\n\n      // Check parameters\n      if (interval !== undefined) {\n        if (interval < 20 || interval > 5000) {\n          const error = new RangeError(\"The advertising interval must be within the range of 20 ms to 5 000 ms\");\n          throw error;\n        }\n        // Interval is in units of 0.625 ms.\n        interval = interval * 1.6;\n      }\n\n      if (timeout !== undefined) {\n        if (timeout < 0 || timeout > 180) {\n          const error = new RangeError(\"The advertising timeout must be within the range of 0 to 180 s\");\n          throw error;\n        }\n      }\n\n      const receivedData = await this._read(true);\n      const littleEndian = true;\n      interval = interval || receivedData.getUint16(0, littleEndian);\n      timeout = timeout || receivedData.getUint8(2, littleEndian);\n\n      const dataArray = new Uint8Array(3);\n      for (let i = 0; i < dataArray.length; i++) {\n        dataArray[i] = receivedData.getUint8(i);\n      }\n\n      dataArray[0] = interval & 0xff;\n      dataArray[1] = (interval >> 8) & 0xff;\n      dataArray[2] = timeout;\n\n      return dataArray;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default AdvertisingParametersService;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass Microphone extends FeatureOperations {\n  constructor(device, eventListeners = []) {\n    super(device, \"microphone\");\n\n    // gatt service and characteristic used to communicate with Thingy's microphone\n    this.service = {\n      uuid: this.device.TSS_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TSS_MIC_UUID,\n      decoder: this.decodeMicrophoneData.bind(this),\n      // verifyAction: this.verifyMicrophoneAction.bind(this),\n      // verifyReaction: this.verifyMicrophoneReaction.bind(this),\n    };\n\n    const AudioContext = window.AudioContext || window.webkitAudioContext;\n    this.audioCtx = new AudioContext();\n\n    this._MICROPHONE_INDEX_TABLE = [-1, -1, -1, -1, 2, 4, 6, 8, -1, -1, -1, -1, 2, 4, 6, 8];\n\n    this._MICROPHONE_STEP_SIZE_TABLE = [7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 19, 21, 23, 25, 28, 31, 34, 37, 41, 45, 50, 55, 60, 66, 73, 80, 88, 97, 107, 118, 130, 143, 157, 173, 190, 209,\n      230, 253, 279, 307, 337, 371, 408, 449, 494, 544, 598, 658, 724, 796, 876, 963, 1060, 1166, 1282, 1411, 1552, 1707, 1878, 2066, 2272, 2499, 2749, 3024, 3327, 3660, 4026, 4428, 4871, 5358,\n      5894, 6484, 7132, 7845, 8630, 9493, 10442, 11487, 12635, 13899, 15289, 16818, 18500, 20350, 22385, 24623, 27086, 29794, 32767];\n\n    this.suspendAudioContext = this.suspendAudioContext.bind(this);\n  }\n\n  async suspendAudioContext() {\n    await this.audioCtx.suspend();\n  }\n  decodeMicrophoneData(event) {\n    const audioPacket = event.buffer;\n    const adpcm = {\n      header: new DataView(audioPacket.slice(0, 3)),\n      data: new DataView(audioPacket.slice(3)),\n    };\n    const decodedAudio = this._decodeAudio(adpcm);\n\n    return decodedAudio;\n  }\n\n  async verifyMicrophoneAction() {\n    try {\n      await this.device.mtu._write(140);\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  async verifyMicrophoneReaction(data) {\n    if (this.getGattAvailable()) {\n      try {\n        const microphoneData = data.detail.data;\n        await this._notify(false, true);\n        this.removeEventListener(\"verifyReaction\", this.characteristic.verifyReaction);\n\n        if (microphoneData.byteLength === 131) {\n          await this._notify(true);\n        } else {\n          console.log(microphoneData.byteLength);\n          const e = new Error(\"Your device does not currently support the use of Thingy's microphone. Check back at a later date.\");\n          this.notifyError(e);\n          throw e;\n        }\n      } catch (error) {\n        throw error;\n      }\n    }\n  }\n\n  _decodeAudio(adpcm) {\n    try {\n      // Allocate output buffer\n      const audioBufferDataLength = adpcm.data.byteLength;\n      const audioBuffer = new ArrayBuffer(512);\n      const pcm = new DataView(audioBuffer);\n      let diff;\n      let bufferStep = false;\n      let inputBuffer = 0;\n      let delta = 0;\n      let sign = 0;\n      let step;\n\n      // The first 2 bytes of ADPCM frame are the predicted value\n      let valuePredicted = adpcm.header.getInt16(0, false);\n      // The 3rd byte is the index value\n      let index = adpcm.header.getInt8(2);\n      if (index < 0) {\n        index = 0;\n      }\n      if (index > 88) {\n        index = 88;\n      }\n      step = this._MICROPHONE_STEP_SIZE_TABLE[index];\n      for (let _in = 0, _out = 0; _in < audioBufferDataLength; _out += 2) {\n        /* Step 1 - get the delta value */\n        if (bufferStep) {\n          delta = inputBuffer & 0x0F;\n          _in++;\n        } else {\n          inputBuffer = adpcm.data.getInt8(_in);\n          delta = (inputBuffer >> 4) & 0x0F;\n        }\n        bufferStep = !bufferStep;\n        /* Step 2 - Find new index value (for later) */\n        index += this._MICROPHONE_INDEX_TABLE[delta];\n        if (index < 0) {\n          index = 0;\n        }\n        if (index > 88) {\n          index = 88;\n        }\n        /* Step 3 - Separate sign and magnitude */\n        sign = delta & 8;\n        delta = delta & 7;\n        /* Step 4 - Compute difference and new predicted value */\n        diff = (step >> 3);\n        if ((delta & 4) > 0) {\n          diff += step;\n        }\n        if ((delta & 2) > 0) {\n          diff += (step >> 1);\n        }\n        if ((delta & 1) > 0) {\n          diff += (step >> 2);\n        }\n        if (sign > 0) {\n          valuePredicted -= diff;\n        } else {\n          valuePredicted += diff;\n        }\n        /* Step 5 - clamp output value */\n        if (valuePredicted > 32767) {\n          valuePredicted = 32767;\n        } else if (valuePredicted < -32768) {\n          valuePredicted = -32768;\n        }\n        /* Step 6 - Update step value */\n        step = this._MICROPHONE_STEP_SIZE_TABLE[index];\n        /* Step 7 - Output value */\n        pcm.setInt16(_out, valuePredicted, true);\n      }\n\n      return pcm;\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  play(audio) {\n    if (this._audioStack === undefined) {\n      this._audioStack = [];\n    }\n    this._audioStack.push(audio);\n    if (this._audioStack.length) {\n      this._scheduleAudioBuffers();\n    }\n  }\n  _scheduleAudioBuffers() {\n    while (this._audioStack.length > 0) {\n      const bufferTime = 0.01; // Buffer time in seconds before initial audio chunk is played\n      const buffer = this._audioStack.shift();\n      const channels = 1;\n      const framecount = buffer.byteLength / 2;\n      if (this._audioNextTime === undefined) {\n        this._audioNextTime = 0;\n      }\n      if (this.audioCtx.state === \"suspended\") {\n        this.audioCtx.resume();\n      }\n      const myArrayBuffer = this.audioCtx.createBuffer(channels, framecount, 16000);\n      // This gives us the actual array that contains the data\n      const nowBuffering = myArrayBuffer.getChannelData(0);\n      for (let i = 0; i < buffer.byteLength / 2; i++) {\n        nowBuffering[i] = buffer.getInt16(2 * i, true) / 32768.0;\n      }\n      const source = this.audioCtx.createBufferSource();\n      source.buffer = myArrayBuffer;\n      source.connect(this.audioCtx.destination);\n      if (this._audioNextTime === 0) {\n        this._audioNextTime = this.audioCtx.currentTime + bufferTime;\n      }\n      source.start(this._audioNextTime);\n      this._audioNextTime += source.buffer.duration;\n    }\n  }\n}\n\nexport default Microphone;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass MTUService extends FeatureOperations {\n  constructor(device) {\n    super(device, \"mtu\");\n\n    // gatt service and characteristic used to communicate with Thingy's MTU\n    this.service = {\n      uuid: this.device.TCS_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TCS_MTU_REQUEST_UUID,\n      decoder: this.decodeMtu.bind(this),\n      encoder: this.encodeMtu.bind(this),\n    };\n  }\n\n  decodeMtu(mtuSize) {\n    try {\n      const littleEndian = true;\n      const mtu = mtuSize.getUint16(1, littleEndian);\n\n      return mtu;\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  encodeMtu(mtuSize, peripheralRequest = true) {\n    try {\n      if (mtuSize < 23 || mtuSize > 276) {\n        const e = new Error(\"MTU size must be in range 23 - 276 bytes\");\n        throw e;\n      }\n\n      const dataArray = new Uint8Array(3);\n      dataArray[0] = peripheralRequest? 1 : 0;\n      dataArray[1] = mtuSize & 0xff;\n      dataArray[2] = (mtuSize >> 8) & 0xff;\n      return dataArray;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default MTUService;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass NameService extends FeatureOperations {\n  constructor(device) {\n    super(device, \"name\");\n\n    // gatt service and characteristic used to communicate with Thingy's name configuration\n    this.service = {\n      uuid: this.device.TCS_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TCS_NAME_UUID,\n      decoder: this.decodeName.bind(this),\n      encoder: this.encodeName.bind(this),\n    };\n  }\n\n  decodeName(data) {\n    try {\n      const decoder = new TextDecoder();\n      const name = decoder.decode(data);\n      const decodedName = {\n        name: name,\n      };\n      return decodedName;\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  encodeName(data) {\n    try {\n      if (data.length > 10) {\n        return Promise.reject(new TypeError(\"The name can't be more than 10 characters long.\"));\n      }\n      const encodedName = new Uint8Array(data.length);\n\n      for (let i = 0; i < data.length; i += 1) {\n        encodedName[i] = data.charCodeAt(i);\n      }\n      return encodedName;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default NameService;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass TemperatureSensor extends FeatureOperations {\n  constructor(device) {\n    super(device, \"temperature\");\n\n    // gatt service and characteristic used to communicate with Thingy's temperature sensor\n    this.service = {\n      uuid: this.device.TES_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TES_TEMP_UUID,\n      decoder: this.decodeTemperature.bind(this),\n    };\n  }\n\n  decodeTemperature(data) {\n    try {\n      const integer = data.getInt8(0);\n      const decimal = data.getUint8(1);\n      const temperature = integer + decimal / 100;\n\n      const decodedTemperature = {\n        value: temperature,\n        unit: \"Celsius\",\n      };\n\n      return decodedTemperature;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default TemperatureSensor;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass PressureSensor extends FeatureOperations {\n  constructor(device) {\n    super(device, \"pressure\");\n\n    // gatt service and characteristic used to communicate with Thingy's pressure sensor\n    this.service = {\n      uuid: this.device.TES_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TES_PRESSURE_UUID,\n      decoder: this.decodePressureData.bind(this),\n    };\n  }\n\n  decodePressureData(data) {\n    try {\n      const littleEndian = true;\n      const integer = data.getUint32(0, littleEndian);\n      const decimal = data.getUint8(4);\n      const pressure = integer + decimal / 100;\n      const formattedData = {\n        value: pressure,\n        unit: \"hPa\",\n      };\n      return formattedData;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default PressureSensor;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass LEDService extends FeatureOperations {\n  constructor(device) {\n    super(device, \"led\");\n\n    // gatt service and characteristic used to communicate with Thingy's LED\n    this.service = {\n      uuid: this.device.TUIS_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TUIS_LED_UUID,\n      decoder: this.decodeLedData.bind(this),\n      encoder: this.encodeLedData.bind(this),\n    };\n  }\n\n  decodeLedData(data) {\n    try {\n      const mode = data.getUint8(0);\n      const littleEndian = true;\n      let status;\n\n      switch (mode) {\n      case 0:\n        status = {\n          mode: mode,\n        };\n        break;\n      case 1:\n        status = {\n          mode: mode,\n          r: data.getUint8(1),\n          g: data.getUint8(2),\n          b: data.getUint8(3),\n        };\n        break;\n      case 2:\n        status = {\n          mode: mode,\n          color: data.getUint8(1),\n          intensity: data.getUint8(2),\n          delay: data.getUint16(3, littleEndian),\n        };\n        break;\n      case 3:\n        status = {\n          mode: mode,\n          color: data.getUint8(1),\n          intensity: data.getUint8(2),\n        };\n        break;\n      }\n      return status;\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  encodeLedData(data) {\n    try {\n      let dataArray;\n\n      if (!data.mode) {\n        const error = new Error(\"You must specify a LED mode\");\n        throw error;\n      }\n\n      switch (data.mode) {\n      case \"constant\": {\n        if (data.red === undefined || data.green === undefined || data.blue === undefined) {\n          const e = new Error(\"The options object for constant mode must contain the properties 'red', 'green', and 'blue'.\");\n          throw e;\n        }\n\n        if (\n          data.red < 0 ||\n          data.red > 255 ||\n          data.green < 0 ||\n          data.green > 255 ||\n          data.blue < 0 ||\n          data.blue > 255\n        ) {\n          const e = new Error(\"The color values must be in the range 0 - 255\");\n          throw e;\n        }\n\n        dataArray = new Uint8Array([1, data.red, data.green, data.blue]);\n        break;\n      }\n\n      case \"breathe\": {\n        if (data.color === undefined || data.intensity === undefined || data.delay === undefined) {\n          const e = new Error(\"The options object for breathe mode must have the properties 'color', 'intensity' and 'delay'.\");\n          throw e;\n        }\n\n        const colors = [\"red\", \"green\", \"yellow\", \"blue\", \"purple\", \"cyan\", \"white\"];\n        let colorCode;\n\n        if (colors.indexOf(data.color) > -1) {\n          colorCode = colors.indexOf(data.color) + 1;\n        } else if (typeof data.color === \"number\" && (data.color > 0 && data.color < 8)) {\n          colorCode = data.color;\n        } else {\n          const e = new Error(`The color must either be a recognized color (${colors.join(\", \")}), or an integer in the interval 1 - 7`);\n          throw e;\n        }\n\n        if (data.intensity < 0 || data.intensity > 100) {\n          const e = new Error(\"The intensity must be an integer in the interval 0 - 100\");\n          throw e;\n        }\n\n        if (data.delay < 50 || data.delay > 10000) {\n          const e = new Error(\"The delay must be an integer in the interval 50 - 10 000\");\n          throw e;\n        }\n\n        dataArray = new Uint8Array([2, colorCode, data.intensity, data.delay & 0xff, (data.delay >> 8) & 0xff]);\n        break;\n      }\n\n      case \"oneshot\": {\n        if (data.color === undefined || data.intensity === undefined) {\n          const e = new Error(\"The options object for the one shot mode must have the properties 'color' and 'intensity.\");\n          throw e;\n        }\n\n        if (data.color < 1 || data.color > 7) {\n          const e = new Error(\"The color must either be a recognized color or an integer in the interval 1 - 7\");\n          throw e;\n        }\n\n        if (data.intensity < 0 || data.intensity > 100) {\n          const e = new Error(\"The intensity must be an integer in the interval 0 - 100\");\n          throw e;\n        }\n\n        dataArray = new Uint8Array([3, data.color, data.intensity]);\n        break;\n      }\n\n      case \"off\": {\n        dataArray = new Uint8Array([0]);\n        break;\n      }\n\n      default: {\n        dataArray = new Uint8Array([2, 6, 20, 3500]);\n        break;\n      }\n      }\n\n      return dataArray;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default LEDService;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass TapSensor extends FeatureOperations {\n  constructor(device) {\n    super(device, \"tap\");\n\n    // gatt service and characteristic used to communicate with Thingy's tap sensor\n    this.service = {\n      uuid: this.device.TMS_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TMS_TAP_UUID,\n      decoder: this.decodeTapData.bind(this),\n    };\n  }\n\n  decodeTapData(data) {\n    try {\n      const direction = data.getUint8(0);\n      const count = data.getUint8(1);\n\n      const formattedData = {\n        direction,\n        count,\n      };\n\n      return formattedData;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default TapSensor;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass AbsoluteOrientationSensor extends FeatureOperations {\n  constructor(device) {\n    super(device, \"absoluteorientation\");\n\n    // gatt service and characteristic used to communicate with Thingy's orientation sensor\n    this.service = {\n      uuid: this.device.TMS_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TMS_ORIENTATION_UUID,\n      decoder: this.decodeOrientationData.bind(this),\n    };\n  }\n\n  decodeOrientationData(data) {\n    try {\n      const orientation = data.getUint8(0);\n\n      const formattedData = {\n        orientation,\n      };\n\n      return formattedData;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default AbsoluteOrientationSensor;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass QuaternionOrientationSensor extends FeatureOperations {\n  constructor(device) {\n    super(device, \"quaternionorientation\");\n\n    // gatt service and characteristic used to communicate with Thingy's quaternion sensor\n    this.service = {\n      uuid: this.device.TMS_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TMS_QUATERNION_UUID,\n      decoder: this.decodeQuaternionData.bind(this),\n    };\n  }\n\n  decodeQuaternionData(data) {\n    try {\n      const littleEndian = true;\n      let w = data.getInt32(0, littleEndian) / (1 << 30);\n      let x = data.getInt32(4, littleEndian) / (1 << 30);\n      let y = data.getInt32(8, littleEndian) / (1 << 30);\n      let z = data.getInt32(12, littleEndian) / (1 << 30);\n      const magnitude = Math.sqrt(Math.pow(w, 2) + Math.pow(x, 2) + Math.pow(y, 2) + Math.pow(z, 2));\n\n      if (magnitude !== 0) {\n        w /= magnitude;\n        x /= magnitude;\n        y /= magnitude;\n        z /= magnitude;\n      }\n\n      const formattedData = {\n        w,\n        x,\n        y,\n        z,\n      };\n\n      return formattedData;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default QuaternionOrientationSensor;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass ButtonSensor extends FeatureOperations {\n  constructor(device) {\n    super(device, \"button\");\n\n    // gatt service and characteristic used to communicate with Thingy's button state\n    this.service = {\n      uuid: this.device.TUIS_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TUIS_BTN_UUID,\n      decoder: this.decodeButtonData.bind(this),\n    };\n  }\n\n  decodeButtonData(data) {\n    try {\n      const state = data.getUint8(0);\n      const decodedButton = {\n        value: state,\n      };\n      return decodedButton;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default ButtonSensor;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass CloudTokenService extends FeatureOperations {\n  constructor(device) {\n    super(device, \"cloudtoken\");\n\n    // gatt service and characteristic used to communicate with Thingy's cloud configuration\n    this.service = {\n      uuid: this.device.TCS_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TCS_CLOUD_TOKEN_UUID,\n      decoder: this.decodeCloudToken.bind(this),\n      encoder: this.encodeCloudToken.bind(this),\n    };\n  }\n\n  decodeCloudToken(data) {\n    try {\n      const decoder = new TextDecoder();\n      const token = decoder.decode(data);\n\n      const decodedToken = {\n        token: token,\n      };\n      return decodedToken;\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  encodeCloudToken(token) {\n    try {\n      if (token.length > 250) {\n        const error = new Error(\"The length of the cloud token can not exceed 250 characters.\");\n        throw error;\n      }\n\n      const encoder = new TextEncoder();\n      const encodedToken = encoder.encode(token);\n\n      return encodedToken;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default CloudTokenService;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass ColorSensor extends FeatureOperations {\n  constructor(device) {\n    super(device, \"color\");\n\n    // gatt service and characteristic used to communicate with thingy's color sensor\n    this.service = {\n      uuid: this.device.TES_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TES_COLOR_UUID,\n      decoder: this.decodeColorData.bind(this),\n    };\n  }\n\n  decodeColorData(data) {\n    try {\n      const littleEndian = true;\n      const r = data.getUint16(0, littleEndian);\n      const g = data.getUint16(2, littleEndian);\n      const b = data.getUint16(4, littleEndian);\n      const c = data.getUint16(6, littleEndian);\n      const rRatio = r / (r + g + b);\n      const gRatio = g / (r + g + b);\n      const bRatio = b / (r + g + b);\n      const clearAtBlack = 300;\n      const clearAtWhite = 400;\n      const clearDiff = clearAtWhite - clearAtBlack;\n      let clearNormalized = (c - clearAtBlack) / clearDiff;\n\n      if (clearNormalized < 0) {\n        clearNormalized = 0;\n      }\n\n      let red = rRatio * 255.0 * 3 * clearNormalized;\n      if (red > 255) {\n        red = 255;\n      }\n\n      let green = gRatio * 255.0 * 3 * clearNormalized;\n      if (green > 255) {\n        green = 255;\n      }\n\n      let blue = bRatio * 255.0 * 3 * clearNormalized;\n      if (blue > 255) {\n        blue = 255;\n      }\n\n      const formattedData = {\n        red: parseInt(red.toFixed(0)),\n        green: parseInt(green.toFixed(0)),\n        blue: parseInt(blue.toFixed(0)),\n      };\n\n      return formattedData;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default ColorSensor;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass ConnectionParametersService extends FeatureOperations {\n  constructor(device) {\n    super(device, \"connectionparameters\");\n\n    // gatt service and characteristic used to communicate with Thingy's connection parameters configuration\n    this.service = {\n      uuid: this.device.TCS_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TCS_CONN_PARAMS_UUID,\n      decoder: this.decodeConnectionParam.bind(this),\n      encoder: this.encodeConnectionParam.bind(this),\n    };\n  }\n\n  decodeConnectionParam(data) {\n    try {\n      // Connection intervals are given in units of 1.25 ms\n      const littleEndian = true;\n      const minConnInterval = data.getUint16(0, littleEndian) * 1.25;\n      const maxConnInterval = data.getUint16(2, littleEndian) * 1.25;\n      const slaveLatency = data.getUint16(4, littleEndian);\n\n      // Supervision timeout is given i units of 10 ms\n      const supervisionTimeout = data.getUint16(6, littleEndian) * 10;\n      const params = {\n        minInterval: minConnInterval,\n        maxInterval: maxConnInterval,\n        slaveLatency: slaveLatency,\n        timeout: supervisionTimeout,\n      };\n      return params;\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  async encodeConnectionParam(params) {\n    try {\n      if (typeof params !== \"object\") {\n        const error = new Error(\"The argument has to be an object.\");\n        throw error;\n      }\n\n      if ((params.timeout === undefined) && (params.slaveLatency === undefined) && (params.minInterval === undefined) && (params.maxInterval === undefined)) {\n        const error = new Error(\"The argument has to be an object with at least one of the properties 'timeout', 'slaveLatency', 'minInterval' or 'maxInterval'.\");\n        throw error;\n      }\n\n      let timeout = params.timeout;\n      let slaveLatency = params.slaveLatency;\n      let minInterval = params.minInterval;\n      let maxInterval = params.maxInterval;\n\n      // Check parameters\n      if (timeout !== undefined) {\n        if (timeout < 100 || timeout > 32000) {\n          const error = new Error(\"The supervision timeout must be in the range from 100 ms to 32 000 ms.\");\n          throw error;\n        }\n        // The supervision timeout has to be set in units of 10 ms\n        timeout = Math.round(timeout / 10);\n      }\n\n      if (slaveLatency !== undefined) {\n        if (slaveLatency < 0 || slaveLatency > 499) {\n          const error = new Error(\"The slave latency must be in the range from 0 to 499 connection intervals.\");\n          throw error;\n        }\n      }\n\n      if (minInterval !== undefined) {\n        if (minInterval < 7.5 || minInterval > maxInterval) {\n          const error = new Error(\"The minimum connection interval must be greater than 7.5 ms and <= maximum interval\");\n          throw error;\n        }\n        // Interval is in units of 1.25 ms.\n        minInterval = Math.round(minInterval * 0.8);\n      }\n\n      if (maxInterval !== undefined) {\n        if (maxInterval > 4000 || maxInterval < minInterval) {\n          const error = new Error(\"The minimum connection interval must be less than 4 000 ms and >= minimum interval\");\n          throw error;\n        }\n        // Interval is in units of 1.25 ms.\n        maxInterval = Math.round(maxInterval * 0.8);\n      }\n\n      const receivedData = await this._read(true);\n      const littleEndian = true;\n      minInterval = minInterval || receivedData.getUint16(0, littleEndian);\n      maxInterval = maxInterval || receivedData.getUint16(2, littleEndian);\n      slaveLatency = slaveLatency || receivedData.getUint16(4, littleEndian);\n      timeout = timeout || receivedData.getUint16(6, littleEndian);\n\n      // Check that the timeout obeys  conn_sup_timeout * 4 > (1 + slave_latency) * max_conn_interval\n      if (timeout * 4 < (1 + slaveLatency) * maxInterval) {\n        const error = new Error(\"The supervision timeout in milliseconds must be greater than (1 + slaveLatency) * maxConnInterval * 2, where maxConnInterval is also given in milliseconds.\");\n        throw error;\n      }\n\n      const dataArray = new Uint8Array(8);\n      for (let i = 0; i < dataArray.length; i++) {\n        dataArray[i] = receivedData.getUint8(i);\n      }\n\n      dataArray[0] = minInterval & 0xff;\n      dataArray[1] = (minInterval >> 8) & 0xff;\n      dataArray[2] = maxInterval & 0xff;\n      dataArray[3] = (maxInterval >> 8) & 0xff;\n      dataArray[4] = slaveLatency & 0xff;\n      dataArray[5] = (slaveLatency >> 8) & 0xff;\n      dataArray[6] = timeout & 0xff;\n      dataArray[7] = (timeout >> 8) & 0xff;\n\n      return dataArray;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default ConnectionParametersService;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass FirmwareService extends FeatureOperations {\n  constructor(device) {\n    super(device, \"firmware\");\n\n    // gatt service and characteristic used to communicate with Thingy's firmware version configuration\n    this.service = {\n      uuid: this.device.TCS_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TCS_FW_VER_UUID,\n      decoder: this.decodeFirmwareVersion.bind(this),\n    };\n  }\n\n  decodeFirmwareVersion(data) {\n    try {\n      const major = data.getUint8(0);\n      const minor = data.getUint8(1);\n      const patch = data.getUint8(2);\n      const version = `v${major}.${minor}.${patch}`;\n\n      const decodedVersion = {\n        firmware: version,\n      };\n\n      return decodedVersion;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default FirmwareService;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass GasSensor extends FeatureOperations {\n  constructor(device) {\n    super(device, \"gas\");\n\n    // gatt service and characteristic used to communicate with Thingy's gas sensor\n    this.service = {\n      uuid: this.device.TES_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TES_GAS_UUID,\n      decoder: this.decodeGasData.bind(this),\n    };\n  }\n\n  decodeGasData(data) {\n    try {\n      const littleEndian = true;\n      const eco2 = data.getUint16(0, littleEndian);\n      const tvoc = data.getUint16(2, littleEndian);\n      const formattedData = {\n        eCO2: {\n          value: eco2,\n          unit: \"ppm\",\n        },\n        TVOC: {\n          value: tvoc,\n          unit: \"ppb\",\n        },\n      };\n      return formattedData;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default GasSensor;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass GravityVectorSensor extends FeatureOperations {\n  constructor(device) {\n    super(device, \"gravityvector\");\n\n    // gatt service and characteristic used to communicate with Thingy's gravity vector sensor\n    this.service = {\n      uuid: this.device.TMS_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TMS_GRAVITY_UUID,\n      decoder: this.decodeGravityVectorData.bind(this),\n    };\n  }\n\n  decodeGravityVectorData(data) {\n    try {\n      const x = data.getFloat32(0, true);\n      const y = data.getFloat32(4, true);\n      const z = data.getFloat32(8, true);\n\n      const formattedData = {\n        value: {x: x, y: y, z: z},\n      };\n\n      return formattedData;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default GravityVectorSensor;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass HumiditySensor extends FeatureOperations {\n  constructor(device) {\n    super(device, \"humidity\");\n\n    // gatt service and characteristic used to communicate with Thingy's humidity sensor\n    this.service = {\n      uuid: this.device.TES_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TES_HUMIDITY_UUID,\n      decoder: this.decodeHumidityData.bind(this),\n    };\n  }\n\n  decodeHumidityData(data) {\n    try {\n      const humidity = data.getUint8(0);\n\n      const formattedData = {\n        value: humidity,\n        unit: \"%\",\n      };\n\n      return formattedData;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default HumiditySensor;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass StepCounterSensor extends FeatureOperations {\n  constructor(device) {\n    super(device, \"stepcounter\");\n\n    // gatt service and characteristic used to communicate with Thingy's step counter sensor\n    this.service = {\n      uuid: this.device.TMS_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TMS_STEP_UUID,\n      decoder: this.decodeStepData.bind(this),\n    };\n  }\n\n  decodeStepData(data) {\n    try {\n      const littleEndian = true;\n      const count = data.getUint32(0, littleEndian);\n      const time = data.getUint32(4, littleEndian);\n\n      const formattedData = {\n        count,\n        time: {\n          value: time,\n          unit: \"ms\",\n        },\n      };\n\n      return formattedData;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default StepCounterSensor;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass RawDataSensor extends FeatureOperations {\n  constructor(device) {\n    super(device, \"rawdata\");\n\n    // gatt service and characteristic used to communicate with Thingy's raw data sensor\n    this.service = {\n      uuid: this.device.TMS_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TMS_RAW_UUID,\n      decoder: this.decodeRawDataData.bind(this),\n    };\n  }\n\n  decodeRawDataData(data) {\n    try {\n      const littleEndian = true;\n      const accX = data.getInt16(0, littleEndian) / 64;\n      const accY = data.getInt16(2, littleEndian) / 64;\n      const accZ = data.getInt16(4, littleEndian) / 64;\n\n      // Divide by 2^11 = 2048 to get correct gyroscope values\n      const gyroX = data.getInt16(6, littleEndian) / 2048;\n      const gyroY = data.getInt16(8, littleEndian) / 2048;\n      const gyroZ = data.getInt16(10, littleEndian) / 2048;\n\n      // Divide by 2^12 = 4096 to get correct compass values\n      const compassX = data.getInt16(12, littleEndian) / 4096;\n      const compassY = data.getInt16(14, littleEndian) / 4096;\n      const compassZ = data.getInt16(16, littleEndian) / 4096;\n\n      const formattedData = {\n        accelerometer: {\n          x: accX,\n          y: accY,\n          z: accZ,\n          unit: \"G\",\n        },\n        gyroscope: {\n          x: gyroX,\n          y: gyroY,\n          z: gyroZ,\n          unit: \"deg/s\",\n        },\n        compass: {\n          x: compassX,\n          y: compassY,\n          z: compassZ,\n          unit: \"microTesla\",\n        },\n      };\n\n      return formattedData;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default RawDataSensor;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass EulerOrientationSensor extends FeatureOperations {\n  constructor(device) {\n    super(device, \"eulerorientation\");\n\n    // gatt service and characteristic used to communicate with Thingy's euler sensor\n    this.service = {\n      uuid: this.device.TMS_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TMS_EULER_UUID,\n      decoder: this.decodeEulerData.bind(this),\n    };\n  }\n\n  decodeEulerData(data) {\n    try {\n      const littleEndian = true;\n\n      const roll = data.getInt32(0, littleEndian) / 65536;\n      const pitch = data.getInt32(4, littleEndian) / 65536;\n      const yaw = data.getInt32(8, littleEndian) / 65536;\n\n      const formattedData = {\n        roll,\n        pitch,\n        yaw,\n      };\n\n      return formattedData;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default EulerOrientationSensor;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass RotationMatrixOrientationSensor extends FeatureOperations {\n  constructor(device) {\n    super(device, \"rotationmatrixorientation\");\n\n    // gatt service and characteristic used to communicate with Thingy's rotation matrix sensor\n    this.service = {\n      uuid: this.device.TMS_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TMS_ROT_MATRIX_UUID,\n      decoder: this.decodeRotationData.bind(this),\n    };\n  }\n\n  decodeRotationData(data) {\n    try {\n      // Divide by 2^2 = 4 to get correct values\n      const r1c1 = data.getInt16(0, true) / 4;\n      const r1c2 = data.getInt16(0, true) / 4;\n      const r1c3 = data.getInt16(0, true) / 4;\n      const r2c1 = data.getInt16(0, true) / 4;\n      const r2c2 = data.getInt16(0, true) / 4;\n      const r2c3 = data.getInt16(0, true) / 4;\n      const r3c1 = data.getInt16(0, true) / 4;\n      const r3c2 = data.getInt16(0, true) / 4;\n      const r3c3 = data.getInt16(0, true) / 4;\n\n      const formattedData = {\n        row1: [r1c1, r1c2, r1c3],\n        row2: [r2c1, r2c2, r2c3],\n        row3: [r3c1, r3c2, r3c3],\n      };\n\n      return formattedData;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default RotationMatrixOrientationSensor;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass HeadingSensor extends FeatureOperations {\n  constructor(device) {\n    super(device, \"heading\");\n\n    // gatt service and characteristic used to communicate with Thingy's heading sensor\n    this.service = {\n      uuid: this.device.TMS_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TMS_HEADING_UUID,\n      decoder: this.decodeHeadingData.bind(this),\n    };\n  }\n\n  decodeHeadingData(data) {\n    try {\n      const littleEndian = true;\n      const heading = data.getInt32(0, littleEndian) / 65536;\n\n      const formattedData = {\n        heading,\n      };\n\n      return formattedData;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default HeadingSensor;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass EddystoneUrlService extends FeatureOperations {\n  constructor(device) {\n    super(device, \"eddystone\");\n\n    // gatt service and characteristic used to communicate with Thingy's Eddystone url\n    this.service = {\n      uuid: this.device.TCS_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TCS_EDDYSTONE_UUID,\n      decoder: this.decodeEddystoneData.bind(this),\n      encoder: this.encodeEddystoneData.bind(this),\n    };\n  }\n\n  decodeEddystoneData(data) {\n    try {\n      // According to Eddystone URL encoding specification, certain elements can be expanded: https://github.com/google/eddystone/tree/master/eddystone-url\n      const prefixArray = [\"http://www.\", \"https://www.\", \"http://\", \"https://\"];\n      const expansionCodes = [\n        \".com/\",\n        \".org/\",\n        \".edu/\",\n        \".net/\",\n        \".info/\",\n        \".biz/\",\n        \".gov/\",\n        \".com\",\n        \".org\",\n        \".edu\",\n        \".net\",\n        \".info\",\n        \".biz\",\n        \".gov\",\n      ];\n      const prefix = prefixArray[data.getUint8(0)];\n      const decoder = new TextDecoder();\n      let url = decoder.decode(data);\n      url = prefix + url.slice(1);\n\n      expansionCodes.forEach((element, i) => {\n        if (url.indexOf(String.fromCharCode(i)) !== -1) {\n          url = url.replace(String.fromCharCode(i), expansionCodes[i]);\n        }\n      });\n\n      return new URL(url);\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  encodeEddystoneData(data) {\n    try {\n      // Uses URL API to check for valid URL\n      const url = new URL(data);\n\n      // Eddystone URL specification defines codes for URL scheme prefixes and expansion codes in the URL.\n      // The array index corresponds to the defined code in the specification.\n      // Details here: https://github.com/google/eddystone/tree/master/eddystone-url\n      const prefixArray = [\"http://www.\", \"https://www.\", \"http://\", \"https://\"];\n      const expansionCodes = [\n        \".com/\",\n        \".org/\",\n        \".edu/\",\n        \".net/\",\n        \".info/\",\n        \".biz/\",\n        \".gov/\",\n        \".com\",\n        \".org\",\n        \".edu\",\n        \".net\",\n        \".info\",\n        \".biz\",\n        \".gov\",\n      ];\n\n      let prefixCode = null;\n      let expansionCode = null;\n      let eddystoneUrl = url.href;\n      let len = eddystoneUrl.length;\n\n      prefixArray.forEach((element, i) => {\n        if (url.href.indexOf(element) !== -1 && prefixCode === null) {\n          prefixCode = String.fromCharCode(i);\n          eddystoneUrl = eddystoneUrl.replace(element, prefixCode);\n          len -= element.length;\n        }\n      });\n\n      expansionCodes.forEach((element, i) => {\n        if (url.href.indexOf(element) !== -1 && expansionCode === null) {\n          expansionCode = String.fromCharCode(i);\n          eddystoneUrl = eddystoneUrl.replace(element, expansionCode);\n          len -= element.length;\n        }\n      });\n\n      if (len < 1 || len > 14) {\n        const error = new Error(\"The URL can't be longer than 14 characters, excluding URL scheme such as \\\"https://\\\" and \\\".com/\\\".\");\n        throw error;\n      }\n\n      const byteArray = new Uint8Array(eddystoneUrl.length);\n\n      for (let i = 0; i < eddystoneUrl.length; i++) {\n        byteArray[i] = eddystoneUrl.charCodeAt(i);\n      }\n\n      return byteArray;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default EddystoneUrlService;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass EnvironmentConfigurationService extends FeatureOperations {\n  constructor(device) {\n    super(device, \"environmentconfiguration\");\n\n    // gatt service and characteristic used to communicate with thingy's environment configuration characteristic\n    this.service = {\n      uuid: this.device.TES_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TES_CONFIG_UUID,\n      decoder: this.decodeConfigData.bind(this),\n      encoder: this.encodeConfigData.bind(this),\n    };\n  }\n\n  decodeConfigData(data) {\n    try {\n      const littleEndian = true;\n      const temperatureInterval = data.getUint16(0, littleEndian);\n      const pressureInterval = data.getUint16(2, littleEndian);\n      const humidityInterval = data.getUint16(4, littleEndian);\n      const colorInterval = data.getUint16(6, littleEndian);\n      let gasInterval = data.getUint8(8);\n      const colorSensorRed = data.getUint8(9);\n      const colorSensorGreen = data.getUint8(10);\n      const colorSensorBlue = data.getUint8(11);\n\n      if (gasInterval === 1) {\n        gasInterval = 1;\n      } else if (gasInterval === 2) {\n        gasInterval = 10;\n      } else if (gasInterval === 3) {\n        gasInterval = 60;\n      }\n\n      const formattedData = {\n        temperatureInterval: temperatureInterval,\n        pressureInterval: pressureInterval,\n        humidityInterval: humidityInterval,\n        colorInterval: colorInterval,\n        gasInterval: gasInterval,\n        colorSensorCalibration: {\n          red: colorSensorRed,\n          green: colorSensorGreen,\n          blue: colorSensorBlue,\n        },\n      };\n\n      return formattedData;\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  async encodeConfigData(params) {\n    try {\n      if (typeof params !== \"object\") {\n        return Promise.reject(new TypeError(\"The argument has to be an object.\"));\n      }\n\n      if ((params.temperatureInterval === undefined) && (params.pressureInterval === undefined) && (params.humidityInterval === undefined) && (params.colorInterval === undefined) && (params.gasInterval === undefined) && (params.colorSensorCalibration === undefined)) {\n        return Promise.reject(new TypeError(\"The argument has to be an object with at least one of the properties 'temperatureInterval', 'pressureInterval', 'humidityInterval', 'colorInterval', 'gasInterval' or 'colorSensorCalibration'.\"));\n      }\n\n      let temperatureInterval = params.temperatureInterval;\n      let pressureInterval = params.pressureInterval;\n      let humidityInterval = params.humidityInterval;\n      let colorInterval = params.colorInterval;\n      let gasInterval = params.gasInterval;\n      const colorSensorCalibration = params.colorSensorCalibration;\n\n      if (temperatureInterval !== undefined) {\n        if (temperatureInterval < 100 || temperatureInterval > 60000) {\n          return Promise.reject(new RangeError(\"The temperature sensor sampling interval must be in the range 100 ms - 60 000 ms\"));\n        }\n      }\n\n      if (pressureInterval !== undefined) {\n        if (pressureInterval < 50 || pressureInterval > 60000) {\n          return Promise.reject(new RangeError(\"The pressure sensor sampling interval must be in the range 50 ms - 60 000 ms\"));\n        }\n      }\n\n      if (humidityInterval !== undefined) {\n        if (humidityInterval < 100 || humidityInterval > 60000) {\n          return Promise.reject(new RangeError(\"The humidity sensor sampling interval must be in the range 100 ms - 60 000 ms\"));\n        }\n      }\n\n      if (colorInterval !== undefined) {\n        if (colorInterval < 200 || colorInterval > 60000) {\n          return Promise.reject(new RangeError(\"The color sensor sampling interval must be in the range 200 ms - 60 000 ms\"));\n        }\n      }\n\n      if (gasInterval !== undefined) {\n        if (gasInterval === 1) {\n          gasInterval = 1;\n        } else if (gasInterval === 10) {\n          gasInterval = 2;\n        } else if (gasInterval === 60) {\n          gasInterval = 3;\n        } else {\n          const e = new RangeError(\"The gas sensor sampling interval has to be 1, 10 or 60 seconds.\");\n          throw e;\n        }\n      }\n\n      let colorSensorRed;\n      let colorSensorGreen;\n      let colorSensorBlue;\n      if (colorSensorCalibration !== undefined) {\n        if (typeof colorSensorCalibration !== \"object\") {\n          return Promise.reject(new TypeError(\"The colorSensorCalibration argument has to be an object.\"));\n        }\n        if (colorSensorCalibration.red === undefined || colorSensorCalibration.green === undefined || colorSensorCalibration.blue === undefined) {\n          return Promise.reject(new TypeError(\"The colorSensorCalibration argument has to be an object with the properties red, green and blue.\"));\n        }\n\n        colorSensorRed = colorSensorCalibration.red;\n        colorSensorGreen = colorSensorCalibration.green;\n        colorSensorBlue = colorSensorCalibration.blue;\n      }\n\n      // Preserve values for those settings that are not being changed\n      const receivedData = await this._read(true);\n      const littleEndian = true;\n      temperatureInterval = temperatureInterval || receivedData.getUint16(0, littleEndian);\n      pressureInterval = pressureInterval || receivedData.getUint16(2, littleEndian);\n      humidityInterval = humidityInterval || receivedData.getUint16(4, littleEndian);\n      colorInterval = colorInterval || receivedData.getUint16(6, littleEndian);\n      gasInterval = gasInterval || receivedData.getUint8(8);\n      colorSensorRed = colorSensorRed || receivedData.getUint8(9);\n      colorSensorGreen = colorSensorGreen|| receivedData.getUint8(10);\n      colorSensorBlue = colorSensorBlue || receivedData.getUint8(11);\n\n      const dataArray = new Uint8Array(12);\n      for (let i = 0; i < dataArray.length; i++) {\n        dataArray[i] = receivedData.getUint8(i);\n      }\n\n      dataArray[0] = temperatureInterval & 0xff;\n      dataArray[1] = (temperatureInterval >> 8) & 0xff;\n      dataArray[2] = pressureInterval & 0xff;\n      dataArray[3] = (pressureInterval >> 8) & 0xff;\n      dataArray[4] = humidityInterval & 0xff;\n      dataArray[5] = (humidityInterval >> 8) & 0xff;\n      dataArray[6] = colorInterval & 0xff;\n      dataArray[7] = (colorInterval >> 8) & 0xff;\n      dataArray[8] = gasInterval;\n      dataArray[9] = colorSensorRed;\n      dataArray[10] = colorSensorGreen;\n      dataArray[11] = colorSensorBlue;\n\n      return dataArray;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default EnvironmentConfigurationService;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass MotionConfigurationService extends FeatureOperations {\n  constructor(device) {\n    super(device, \"motionconfiguration\");\n\n    // gatt service and characteristic used to communicate with thingy's motion configuration characteristic\n    this.service = {\n      uuid: this.device.TMS_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TMS_CONFIG_UUID,\n      decoder: this.decodeConfigData.bind(this),\n      encoder: this.encodeConfigData.bind(this),\n    };\n  }\n\n  decodeConfigData(data) {\n    try {\n      const littleEndian = true;\n      const stepCounterInterval = data.getUint16(0, littleEndian);\n      const tempCompensationInterval = data.getUint16(2, littleEndian);\n      const magnetCompInterval = data.getUint16(4, littleEndian);\n      const motionProcessFrequency = data.getUint16(6, littleEndian);\n      const wakeOnMotion = data.getUint8(8);\n\n      const formattedData = {\n        stepCounterInterval: stepCounterInterval,\n        tempCompensationInterval: tempCompensationInterval,\n        magnetCompInterval: magnetCompInterval,\n        motionProcessFrequency: motionProcessFrequency,\n        wakeOnMotion: wakeOnMotion,\n      };\n\n      return formattedData;\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  async encodeConfigData(params) {\n    try {\n      if (typeof params !== \"object\") {\n        return Promise.reject(new TypeError(\"The argument has to be an object.\"));\n      }\n\n      if ((params.stepCounterInterval === undefined) && (params.tempCompensationInterval === undefined) && (params.magnetCompInterval === undefined) && (params.motionProcessFrequency === undefined) && (params.wakeOnMotion === undefined)) {\n        return Promise.reject(new TypeError(\"The argument has to be an object with at least one of the properties 'stepCounterInterval', 'tempCompensationInterval', 'magnetCompInterval', 'motionProcessFrequency' or 'wakeOnMotion'.\"));\n      }\n\n      let stepCounterInterval = params.stepCounterInterval;\n      let tempCompensationInterval = params.tempCompensationInterval;\n      let magnetCompInterval = params.magnetCompInterval;\n      let motionProcessFrequency = params.motionProcessFrequency;\n      let wakeOnMotion = params.wakeOnMotion;\n\n      if (stepCounterInterval !== undefined) {\n        if (stepCounterInterval < 100 || stepCounterInterval > 5000) {\n          return Promise.reject(new RangeError(\"The step counter interval must be in the range 100 ms - 5000 ms\"));\n        }\n      }\n\n      if (tempCompensationInterval !== undefined) {\n        if (tempCompensationInterval < 100 || tempCompensationInterval > 5000) {\n          return Promise.reject(new RangeError(\"The temperature compensation interval must be in the range 100 ms - 5000 ms\"));\n        }\n      }\n\n      if (magnetCompInterval !== undefined) {\n        if (magnetCompInterval < 100 || magnetCompInterval > 1000) {\n          return Promise.reject(new RangeError(\"The magnetometer compensation interval must be in the range 100 ms - 1000 ms\"));\n        }\n      }\n\n      if (motionProcessFrequency !== undefined) {\n        if (motionProcessFrequency < 5 || motionProcessFrequency > 200) {\n          return Promise.reject(new RangeError(\"The motion processing unit frequency must be in the range 5 hz - 200 hz\"));\n        }\n      }\n\n      if (wakeOnMotion !== undefined) {\n        if (typeof wakeOnMotion !== \"boolean\") {\n          return Promise.reject(new RangeError(\"The argument must be true or false.\"));\n        }\n        wakeOnMotion = wakeOnMotion ? 1 : 0;\n      }\n\n      const receivedData = await this._read(true);\n      const littleEndian = true;\n      stepCounterInterval = stepCounterInterval || receivedData.getUint16(0, littleEndian);\n      tempCompensationInterval = tempCompensationInterval || receivedData.getUint16(2, littleEndian);\n      magnetCompInterval = magnetCompInterval || receivedData.getUint16(4, littleEndian);\n      motionProcessFrequency = motionProcessFrequency || receivedData.getUint16(6, littleEndian);\n\n      // Do it this way because otherwise it would evaluate a truth statement, i.e. wakeOnMotion = 0 || 1.\n      // This would result in never being able to turn wakeOnMotion off once it was on.\n      if (wakeOnMotion === undefined) {\n        wakeOnMotion = receivedData.getUint8(8);\n      }\n\n      const dataArray = new Uint8Array(9);\n      for (let i = 0; i < dataArray.length; i++) {\n        dataArray[i] = receivedData.getUint8(i);\n      }\n\n      dataArray[0] = stepCounterInterval & 0xff;\n      dataArray[1] = (stepCounterInterval >> 8) & 0xff;\n      dataArray[2] = tempCompensationInterval & 0xff;\n      dataArray[3] = (tempCompensationInterval >> 8) & 0xff;\n      dataArray[4] = magnetCompInterval & 0xff;\n      dataArray[5] = (magnetCompInterval >> 8) & 0xff;\n      dataArray[6] = motionProcessFrequency & 0xff;\n      dataArray[7] = (motionProcessFrequency >> 8) & 0xff;\n      dataArray[8] = wakeOnMotion;\n\n      return dataArray;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default MotionConfigurationService;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass SoundConfigurationService extends FeatureOperations {\n  constructor(device) {\n    super(device, \"soundconfiguration\");\n\n    // gatt service and characteristic used to communicate with Thingy's sound service\n    this.service = {\n      uuid: this.device.TSS_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TSS_CONFIG_UUID,\n      decoder: this.decodeSoundConfigurationData.bind(this),\n      encoder: this.encodeSoundConfigurationData.bind(this),\n    };\n  }\n\n  decodeSoundConfigurationData(data) {\n    try {\n      const speakerMode = data.getUint8(0);\n      const microphoneMode = data.getUint8(1);\n      const decodedSoundConfiguration = {\n        speakerMode: speakerMode,\n        microphoneMode: microphoneMode,\n      };\n      return decodedSoundConfiguration;\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  async encodeSoundConfigurationData(data) {\n    try {\n      if (typeof data !== \"object\") {\n        return Promise.reject(new TypeError(\"The argument has to be an object.\"));\n      }\n\n      if ((data.speakerMode === undefined) && (data.microphoneMode === undefined)) {\n        return Promise.reject(new TypeError(\"The argument has to be an object with at least one of the properties speakerMode and microphoneMode.\"));\n      }\n\n      let speakerMode = data.speakerMode;\n      let microphoneMode = data.microphoneMode;\n\n      if (speakerMode !== undefined) {\n        if (!(speakerMode === 1 || speakerMode === 2 || speakerMode === 3)) {\n          return Promise.reject(new RangeError(\"The speaker mode must be one of the integers 1, 2 or 3.\"));\n        }\n      }\n\n      if (microphoneMode !== undefined) {\n        if (!(microphoneMode === 1 || microphoneMode === 2)) {\n          return Promise.reject(new RangeError(\"The microphone mode must be one of the integers 1 or 2.\"));\n        }\n      }\n\n      const receivedData = await this._read(true);\n      speakerMode = speakerMode || receivedData.getUint8(0);\n      microphoneMode = microphoneMode || receivedData.getUint8(1);\n\n      const dataArray = new Uint8Array(2);\n      for (let i = 0; i < dataArray.length; i++) {\n        dataArray[i] = receivedData.getUint8(i);\n      }\n\n      dataArray[0] = speakerMode & 0xff;\n      dataArray[1] = microphoneMode & 0xff;\n\n      return dataArray;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default SoundConfigurationService;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\nimport SoundConfigurationService from \"./SoundConfigurationService.js\";\n\nclass SpeakerDataService extends FeatureOperations {\n  constructor(device) {\n    super(device, \"speakerdata\");\n\n    // gatt service and characteristic used to communicate with Thingy's speaker data\n    this.service = {\n      uuid: this.device.TSS_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TSS_SPEAKER_DATA_UUID,\n      encoder: this.encodeSpeakerData.bind(this),\n    };\n\n    this.soundconfigurationservice = new SoundConfigurationService(this);\n  }\n\n  async encodeSpeakerData(data) {\n    try {\n      if (data.mode === 1) {\n        const dataArray = new Uint8Array(5);\n        const frequency = data.frequency;\n        const duration = data.duration;\n        const volume = data.volume;\n\n        dataArray[0] = frequency & 0xff;\n        dataArray[1] = (frequency >> 8) & 0xff;\n        dataArray[2] = duration & 0xff;\n        dataArray[3] = (duration >> 8) & 0xff;\n        dataArray[4] = volume & 0xff;\n\n        return dataArray;\n      } else if (data.mode === 2) {\n        return data.data;\n      } else if (data.mode === 3) {\n        const dataArray = new Uint8Array(1);\n        const sample = data.sample;\n\n        dataArray[0] = sample & 0xff;\n\n        return dataArray;\n      }\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default SpeakerDataService;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass SpeakerStatusService extends FeatureOperations {\n  constructor(device) {\n    super(device, \"speakerstatus\");\n\n    // gatt service and characteristic used to communicate with Thingy's speaker status\n    this.service = {\n      uuid: this.device.TSS_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.TSS_SPEAKER_STAT_UUID,\n      decoder: this.decodeSpeakerStatus.bind(this),\n    };\n  }\n\n  decodeSpeakerStatus(data) {\n    try {\n      const speakerStatus = data.getInt8(0);\n\n      const decodedSpeakerStatus = {\n        status: speakerStatus,\n      };\n\n      return decodedSpeakerStatus;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default SpeakerStatusService;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass BatteryService extends FeatureOperations {\n  constructor(device) {\n    super(device, \"battery\");\n\n    // gatt service and characteristic used to communicate with Thingy's battery level\n    this.service = {\n      uuid: \"battery_service\",\n    };\n\n    this.characteristic = {\n      uuid: \"battery_level\",\n      decoder: this.decodeBatteryStatus.bind(this),\n    };\n  }\n\n  decodeBatteryStatus(data) {\n    try {\n      const batteryStatus = data.getInt8(0);\n\n      const decodedBatteryStatus = {\n        status: batteryStatus,\n      };\n\n      return decodedBatteryStatus;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default BatteryService;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass DFUControlPointService extends FeatureOperations {\n  constructor(device) {\n    super(device, \"dfucontrolpoint_v1\");\n\n    // gatt service and characteristic used to communicate with Thingy's dfu control point configuration\n    this.service = {\n      uuid: this.device.DFU_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.DFU_CTRL_POINT_UUID_VERSION_1,\n      decoder: this.decodeDfuData.bind(this),\n      encoder: this.encodeDfuData.bind(this),\n    };\n  }\n\n  decodeDfuData(data) {\n    try {\n      const state = data.getUint8(0);\n      const decodedDfu = {\n        value: state,\n      };\n      return decodedDfu;\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  encodeDfuData(data) {\n    try {\n      const dataArray = new Uint8Array(1);\n      dataArray[0] = data & 0xff;\n      return dataArray;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default DFUControlPointService;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FeatureOperations from \"./FeatureOperations.js\";\n\nclass DFUControlPointService extends FeatureOperations {\n  constructor(device) {\n    super(device, \"dfucontrolpoint_v2\");\n\n    // gatt service and characteristic used to communicate with Thingy's dfu control point configuration\n    this.service = {\n      uuid: this.device.DFU_UUID,\n    };\n\n    this.characteristic = {\n      uuid: this.device.DFU_CTRL_POINT_UUID_VERSION_2,\n      decoder: this.decodeDfuData.bind(this),\n      encoder: this.encodeDfuData.bind(this),\n    };\n  }\n\n  decodeDfuData(data) {\n    try {\n      const state = data.getUint8(0);\n      const decodedDfu = {\n        value: state,\n      };\n      return decodedDfu;\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  encodeDfuData(data) {\n    try {\n      const dataArray = new Uint8Array(1);\n      dataArray[0] = data & 0xff;\n      return dataArray;\n    } catch (error) {\n      throw error;\n    }\n  }\n}\n\nexport default DFUControlPointService;\n","/*\n  Copyright (c) 2010 - 2017, Nordic Semiconductor ASA\n  All rights reserved.\n  Redistribution and use in source and binary forms, with or without modification,\n  are permitted provided that the following conditions are met:\n  1. Redistributions of source code must retain the above copyright notice, this\n     list of conditions and the following disclaimer.\n  2. Redistributions in binary form, except as embedded into a Nordic\n     Semiconductor ASA integrated circuit in a product or a software update for\n     such product, must reproduce the above copyright notice, this list of\n     conditions and the following disclaimer in the documentation and/or other\n     materials provided with the distribution.\n  3. Neither the name of Nordic Semiconductor ASA nor the names of its\n     contributors may be used to endorse or promote products derived from this\n     software without specific prior written permission.\n  4. This software, with or without modification, must only be used with a\n     Nordic Semiconductor ASA integrated circuit.\n  5. Any software provided in binary form under this license must not be reverse\n     engineered, decompiled, modified and/or disassembled.\n  THIS SOFTWARE IS PROVIDED BY NORDIC SEMICONDUCTOR ASA \"AS IS\" AND ANY EXPRESS\n  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n  OF MERCHANTABILITY, NONINFRINGEMENT, AND FITNESS FOR A PARTICULAR PURPOSE ARE\n  DISCLAIMED. IN NO EVENT SHALL NORDIC SEMICONDUCTOR ASA OR CONTRIBUTORS BE\n  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport AdvertisingParametersService from \"./AdvertisingParametersService.js\";\nimport MicrophoneSensor from \"./MicrophoneSensor.js\";\nimport MTUService from \"./MTUService.js\";\nimport NameService from \"./NameService.js\";\nimport TemperatureSensor from \"./TemperatureSensor.js\";\nimport PressureSensor from \"./PressureSensor.js\";\nimport LEDService from \"./LEDService.js\";\nimport TapSensor from \"./TapSensor.js\";\nimport AbsoluteOrientationSensor from \"./AbsoluteOrientationSensor.js\";\nimport QuaternionOrientationSensor from \"./QuaternionOrientationSensor.js\";\nimport ButtonSensor from \"./ButtonSensor.js\";\nimport CloudTokenService from \"./CloudTokenService.js\";\nimport ColorSensor from \"./ColorSensor.js\";\nimport ConnectionParametersService from \"./ConnectionParametersService.js\";\nimport FirmwareService from \"./FirmwareService.js\";\nimport GasSensor from \"./GasSensor.js\";\nimport GravityVectorSensor from \"./GravityVectorSensor.js\";\nimport HumiditySensor from \"./HumiditySensor.js\";\nimport StepCounterSensor from \"./StepCounterSensor.js\";\nimport RawDataSensor from \"./RawDataSensor.js\";\nimport EulerOrientationSensor from \"./EulerOrientationSensor.js\";\nimport RotationMatrixOrientationSensor from \"./RotationMatrixOrientationSensor.js\";\nimport HeadingSensor from \"./HeadingSensor.js\";\nimport EddystoneUrlService from \"./EddystoneUrlService.js\";\nimport EnvironmentConfigurationService from \"./EnvironmentConfigurationService.js\";\nimport MotionConfigurationService from \"./MotionConfigurationService.js\";\nimport SoundConfigurationService from \"./SoundConfigurationService.js\";\nimport SpeakerDataService from \"./SpeakerDataService.js\";\nimport SpeakerStatusService from \"./SpeakerStatusService.js\";\nimport BatteryService from \"./BatteryService.js\";\nimport ThingyController from \"./ThingyController.js\";\nimport Utilities from \"./Utilities.js\";\nimport EventTarget from \"./EventTarget.js\";\nimport DFUControlPointServiceFirmwarev1 from \"./DFUControlPointServiceFirmwarev1.js\";\nimport DFUControlPointServiceFirmwarev2 from \"./DFUControlPointServiceFirmwarev2.js\";\n\nclass Thingy extends EventTarget {\n  constructor(options = {logEnabled: true}) {\n    super();\n\n    this.logEnabled = options.logEnabled;\n    this.connected = false;\n\n    if (this.logEnabled) {\n      console.log(\"I am alive!\");\n    }\n\n    // TCS = Thingy Configuration Service\n    this.TCS_UUID = \"ef680100-9b35-4933-9b10-52ffa9740042\";\n    this.TCS_NAME_UUID = \"ef680101-9b35-4933-9b10-52ffa9740042\";\n    this.TCS_ADV_PARAMS_UUID = \"ef680102-9b35-4933-9b10-52ffa9740042\";\n    this.TCS_CONN_PARAMS_UUID = \"ef680104-9b35-4933-9b10-52ffa9740042\";\n    this.TCS_EDDYSTONE_UUID = \"ef680105-9b35-4933-9b10-52ffa9740042\";\n    this.TCS_CLOUD_TOKEN_UUID = \"ef680106-9b35-4933-9b10-52ffa9740042\";\n    this.TCS_FW_VER_UUID = \"ef680107-9b35-4933-9b10-52ffa9740042\";\n    this.TCS_MTU_REQUEST_UUID = \"ef680108-9b35-4933-9b10-52ffa9740042\";\n\n    // TES = Thingy Environment Service\n    this.TES_UUID = \"ef680200-9b35-4933-9b10-52ffa9740042\";\n    this.TES_TEMP_UUID = \"ef680201-9b35-4933-9b10-52ffa9740042\";\n    this.TES_PRESSURE_UUID = \"ef680202-9b35-4933-9b10-52ffa9740042\";\n    this.TES_HUMIDITY_UUID = \"ef680203-9b35-4933-9b10-52ffa9740042\";\n    this.TES_GAS_UUID = \"ef680204-9b35-4933-9b10-52ffa9740042\";\n    this.TES_COLOR_UUID = \"ef680205-9b35-4933-9b10-52ffa9740042\";\n    this.TES_CONFIG_UUID = \"ef680206-9b35-4933-9b10-52ffa9740042\";\n\n    // TUIS = Thingy User Interface Service\n    this.TUIS_UUID = \"ef680300-9b35-4933-9b10-52ffa9740042\";\n    this.TUIS_LED_UUID = \"ef680301-9b35-4933-9b10-52ffa9740042\";\n    this.TUIS_BTN_UUID = \"ef680302-9b35-4933-9b10-52ffa9740042\";\n    this.TUIS_PIN_UUID = \"ef680303-9b35-4933-9b10-52ffa9740042\";\n\n    // TMS = Thingy Motion Service\n    this.TMS_UUID = \"ef680400-9b35-4933-9b10-52ffa9740042\";\n    this.TMS_CONFIG_UUID = \"ef680401-9b35-4933-9b10-52ffa9740042\";\n    this.TMS_TAP_UUID = \"ef680402-9b35-4933-9b10-52ffa9740042\";\n    this.TMS_ORIENTATION_UUID = \"ef680403-9b35-4933-9b10-52ffa9740042\";\n    this.TMS_QUATERNION_UUID = \"ef680404-9b35-4933-9b10-52ffa9740042\";\n    this.TMS_STEP_UUID = \"ef680405-9b35-4933-9b10-52ffa9740042\";\n    this.TMS_RAW_UUID = \"ef680406-9b35-4933-9b10-52ffa9740042\";\n    this.TMS_EULER_UUID = \"ef680407-9b35-4933-9b10-52ffa9740042\";\n    this.TMS_ROT_MATRIX_UUID = \"ef680408-9b35-4933-9b10-52ffa9740042\";\n    this.TMS_HEADING_UUID = \"ef680409-9b35-4933-9b10-52ffa9740042\";\n    this.TMS_GRAVITY_UUID = \"ef68040a-9b35-4933-9b10-52ffa9740042\";\n\n    // TSS = Thingy Sound Service\n    this.TSS_UUID = \"ef680500-9b35-4933-9b10-52ffa9740042\";\n    this.TSS_CONFIG_UUID = \"ef680501-9b35-4933-9b10-52ffa9740042\";\n    this.TSS_SPEAKER_DATA_UUID = \"ef680502-9b35-4933-9b10-52ffa9740042\";\n    this.TSS_SPEAKER_STAT_UUID = \"ef680503-9b35-4933-9b10-52ffa9740042\";\n    this.TSS_MIC_UUID = \"ef680504-9b35-4933-9b10-52ffa9740042\";\n\n    // DFU = Device Firmware Update\n    this.DFU_UUID = \"0000fe59-0000-1000-8000-00805f9b34fb\";\n    this.DFU_CTRL_POINT_UUID_VERSION_1 = \"8ec90001-f315-4f60-9fb8-838830daea50\";\n    this.DFU_CTRL_POINT_UUID_VERSION_2 = \"8ec90003-f315-4f60-9fb8-838830daea50\";\n\n    this.serviceUUIDs = [\n      \"battery_service\",\n      this.TCS_UUID,\n      this.TES_UUID,\n      this.TUIS_UUID,\n      this.TMS_UUID,\n      this.TSS_UUID,\n      this.DFU_UUID,\n    ];\n\n    this.addEventListener(\"gattavailable\", this.executeQueuedOperations.bind(this));\n    this.addEventListener(\"operationqueued\", this.executeQueuedOperations.bind(this));\n\n    this.advertisingparameters = new AdvertisingParametersService(this);\n    this.microphone = new MicrophoneSensor(this);\n    this.mtu = new MTUService(this);\n    this.name = new NameService(this);\n    this.temperature = new TemperatureSensor(this);\n    this.pressure = new PressureSensor(this);\n    this.led = new LEDService(this);\n    this.tap = new TapSensor(this);\n    this.absoluteorientation = new AbsoluteOrientationSensor(this);\n    this.quaternionorientation = new QuaternionOrientationSensor(this);\n    this.button = new ButtonSensor(this);\n    this.cloudtoken = new CloudTokenService(this);\n    this.color = new ColorSensor(this);\n    this.connectionparameters = new ConnectionParametersService(this);\n    this.eddystone = new EddystoneUrlService(this);\n    this.firmware = new FirmwareService(this);\n    this.gas = new GasSensor(this);\n    this.gravityvector = new GravityVectorSensor(this);\n    this.humidity = new HumiditySensor(this);\n    this.stepcounter = new StepCounterSensor(this);\n    this.rawdata = new RawDataSensor(this);\n    this.eulerorientation = new EulerOrientationSensor(this);\n    this.rotationmatrixorientation = new RotationMatrixOrientationSensor(this);\n    this.heading = new HeadingSensor(this);\n    this.environmentconfiguration = new EnvironmentConfigurationService(this);\n    this.motionconfiguration = new MotionConfigurationService(this);\n    this.soundconfiguration = new SoundConfigurationService(this);\n    this.speakerdata = new SpeakerDataService(this);\n    this.speakerstatus = new SpeakerStatusService(this);\n    this.battery = new BatteryService(this);\n    this.dfucontrolpoint_v1 = new DFUControlPointServiceFirmwarev1(this);\n    this.dfucontrolpoint_v2 = new DFUControlPointServiceFirmwarev2(this);\n  }\n\n  getStoredThingyName() {\n    try {\n      return localStorage.getItem(\"thingyName\");\n    } catch (e) {\n      return;\n    }\n  }\n\n  async connect() {\n    try {\n      // Scan for Thingys\n      const storedThingyName = this.getStoredThingyName();\n\n      const filters = [];\n\n      if (storedThingyName) {\n        filters.push({ name: storedThingyName });\n\n        if (this.logEnabled) {\n          console.log(`Scanning for devices with name equal to ${storedThingyName}`);\n        }\n\n      } else {\n        filters.push({ services: [this.TCS_UUID] });\n\n        if (this.logEnabled) {\n          console.log(`Scanning for devices with service UUID equal to ${this.TCS_UUID}`);\n        }\n      }\n\n      this.device = await navigator.bluetooth.requestDevice({\n        filters,\n        optionalServices: this.serviceUUIDs,\n      });\n\n      this.device.addEventListener('gattserverdisconnected', this.onDisconnected.bind(this));\n\n      this.setConnected(true);\n\n      if (this.logEnabled) {\n        console.log(`Found Thingy named \"${this.device.name}\", trying to connect`);\n      }\n\n      // Connect to GATT server\n      this.server = await this.device.gatt.connect();\n\n      this.thingyController = new ThingyController(this);\n      this.utilities = new Utilities(this);\n\n      if (this.logEnabled) {\n        console.log(`Connected to \"${this.device.name}\"`);\n      }\n\n      return true;\n    } catch (error) {\n      this.setConnected(false);\n\n      if (\"utilities\" in this) {\n        this.utilities.processEvent(\"error\", \"thingy\", error);\n      }\n\n      return false;\n    }\n  }\n\n  // used to execute queued operations.\n  // as long as this method perceives operations to be executed (without regard to the operation's outcome) it will run.\n  // if an operation fails three times and seemingly no other operations are executed at the same time, the operation is discarded.\n  async executeQueuedOperations() {\n    try {\n      if (!this.thingyController.getExecutingQueuedOperations()) {\n        if (this.thingyController.getNumQueuedOperations() !== 0) {\n          if (this.thingyController.getGattStatus()) {\n            this.thingyController.setExecutingQueuedOperations(true);\n\n            const triedOperations = {};\n            let operation;\n\n            let totalOperationsExecutedUntilLastIteration = 0;\n            let totalOperationsExecutedSinceLastIteration = 0;\n\n            while (this.thingyController.getNumQueuedOperations() !== 0) {\n              if (!this.getConnected()) {\n                break;\n              }\n\n              totalOperationsExecutedSinceLastIteration = this.thingyController.getNumExecutedOperations() - totalOperationsExecutedUntilLastIteration;\n              totalOperationsExecutedUntilLastIteration = this.thingyController.getNumExecutedOperations();\n              operation = this.thingyController.dequeue();\n\n              if (!(operation.feature in triedOperations)) {\n                triedOperations[operation.feature] = {};\n              }\n\n              if (!(operation.method in triedOperations[operation.feature])) {\n                triedOperations[operation.feature][operation.method] = 0;\n              }\n\n              triedOperations[operation.feature][operation.method]++;\n\n              const successful = await operation.f();\n\n              // this condition will hopefully never be met\n              if (triedOperations[operation.feature][operation.method] === 10 && successful !== true) {\n                this.thingyController.removeQueuedOperation(operation);\n                this.utilities.processEvent(\"operationdiscarded\", \"thingy\", operation);\n              }\n\n              if (triedOperations[operation.feature][operation.method] >= 3) {\n                if (successful !== true) {\n                  if (totalOperationsExecutedSinceLastIteration < 2) {\n                    if (totalOperationsExecutedSinceLastIteration === 1) {\n                      const op = this.thingyController.getExecutedOperation(this.thingyController.getNumExecutedOperations() - 1);\n\n                      if (op.feature !== operation.feature || op.method !== operation.method) {\n                        continue;\n                      }\n                    }\n\n                    // we have now tried this particular operation three times.\n                    // It's still not completing successfully, and no other operations\n                    // are going through. We are therefore discarding it.\n                    this.thingyController.removeQueuedOperation(operation);\n                    this.utilities.processEvent(\"operationdiscarded\", \"thingy\", operation);\n                  }\n                }\n              }\n            }\n\n            this.thingyController.setExecutingQueuedOperations(false);\n          }\n        }\n      }\n    } catch (error) {\n      this.thingyController.setExecutingQueuedOperations(false);\n      this.utilities.processEvent(\"error\", \"thingy\", error);\n    }\n  }\n\n  getConnected() {\n    return this.connected;\n  }\n\n  setConnected(bool) {\n    this.connected = bool;\n  }\n\n  resetDeviceProperties() {\n    this.setConnected(false);\n    this.thingyController.terminate();\n  }\n\n  onDisconnected({target}) {\n    if (!this.getConnected()) {\n      if (this.logEnabled) {\n        console.log(`Disconnected from device named ${target.name}`);\n      }\n    } else {\n      this.resetDeviceProperties();\n      this.utilities.processEvent(\"disconnected\", \"thingy\");\n    }\n  }\n\n  async disconnect() {\n    try {\n      this.resetDeviceProperties();\n      await this.device.gatt.disconnect();\n      return true;\n    } catch (error) {\n      this.utilities.processEvent(\"error\", \"thingy\", error);\n      return false;\n    }\n  }\n}\n\nexport default Thingy;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport Thingy from \"module/thingy/api/Thingy\";\nimport Button from \"@material-ui/core/Button\";\nimport BluetoothSearchingIcon from \"@material-ui/icons/BluetoothSearching\";\nimport BluetoothDisabledIcon from \"@material-ui/icons/BluetoothDisabled\";\nimport {makeStyles} from \"@material-ui/core\";\n\nconst useStyles = makeStyles(theme => ({\n  btIconConnect: {\n    color: \"#1976d2\",\n  },\n  btIconDisconnect: {\n    color: \"#f00\"\n  }\n}));\n\nconst thingy = new Thingy({ logEnabled: true });\nwindow.thingy = thingy;\n\nexport default function ConnectButton(props) {\n  const classes = useStyles();\n\n  async function start() {\n    if (!props.connected) {\n      try {\n        const connected = await window.thingy.connect();\n        if (connected) {\n          props.onConnectionEvent(true);\n        }\n      } catch (e) {\n        props.notifyError(e);\n      }\n    } else {\n      props.onConnectionEvent(false);\n      props.disconnect();\n    }\n  }\n\n  const text = props.connected\n    ? \"Rozłącz urządzenie\"\n    : \"Połącz z urządzeniem\";\n\n  const icon = props.connected\n    ? <BluetoothDisabledIcon className={classes.btIconDisconnect} />\n    : <BluetoothSearchingIcon className={classes.btIconConnect} />;\n\n  return (\n    <div>\n      <Button fullWidth={true} onClick={start} startIcon={icon}>\n        {text}\n      </Button>\n    </div>\n  );\n}\n\nConnectButton.propTypes = {\n  connected: PropTypes.bool,\n  disconnect: PropTypes.func.isRequired,\n  onConnectionEvent: PropTypes.func.isRequired,\n  notifyError: PropTypes.func,\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport BatteryFull from \"@material-ui/icons/BatteryFull\";\nimport Battery20 from \"@material-ui/icons/Battery20\";\nimport Battery30 from \"@material-ui/icons/Battery30\";\nimport Battery50 from \"@material-ui/icons/Battery50\";\nimport Battery60 from \"@material-ui/icons/Battery60\";\nimport Battery80 from \"@material-ui/icons/Battery80\";\nimport Battery90 from \"@material-ui/icons/Battery90\";\n\n\nexport default function Battery(props) {\n  return getBatteryIconFor(props.batteryLevel);\n}\n\nconst getBatteryIconFor = (batteryLevel) => {\n  if (batteryLevel <= 20) {\n    return (<Battery20/>);\n  } else if (batteryLevel <= 30) {\n    return (<Battery30/>);\n  } else if (batteryLevel <= 50) {\n    return (<Battery50/>);\n  } else if (batteryLevel <= 60) {\n    return (<Battery60/>);\n  } else if (batteryLevel <= 80) {\n    return (<Battery80/>);\n  } else if (batteryLevel <= 90) {\n    return (<Battery90/>);\n  } else {\n    return (<BatteryFull/>);\n  }\n};\n\nBattery.propTypes = {\n  batteryLevel: PropTypes.number,\n};\n","import * as firebase from \"firebase/app\";\nimport \"firebase/firestore\";\nimport {useCollection} from \"react-firebase-hooks/firestore\";\n\nconst key = localStorage.getItem(\"thingyFirebaseKey\");\n\nif (key) {\n  firebase.initializeApp({\n    apiKey: key,\n    authDomain: \"thingy-workshop.firebaseapp.com\",\n    databaseURL: \"https://thingy-workshop.firebaseio.com\",\n    projectId: \"thingy-workshop\",\n    storageBucket: \"thingy-workshop.appspot.com\",\n    messagingSenderId: \"137166886055\",\n    appId: \"1:137166886055:web:224969bcdca7d8d947f782\"\n  });\n}\n\nexport default firebase;\n\nexport function saveDeviceStatus(name, options) {\n  try {\n    const ref = firebase.firestore().doc(\"/deviceStatus/\" + name);\n    ref.set({\n      ...options,\n      lastContact: firebase.firestore.FieldValue.serverTimestamp(),\n    });\n  } catch (e) {}\n}\n\nexport function useDeviceCollection(collectionPath) {\n  try {\n    return useCollection(firebase.firestore().collection(collectionPath));\n  } catch (e) {\n    return [null, false, new Error(\"firebase error\")];\n  }\n}\n","import React, {Fragment, useEffect} from \"react\";\nimport ConnectButton from \"./connect-button\";\nimport Drawer from \"@material-ui/core/Drawer\";\nimport Battery from \"components/ui/battery\";\nimport PropTypes from \"prop-types\";\nimport {useSnackbar} from \"notistack\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemAvatar from \"@material-ui/core/ListItemAvatar\";\nimport Avatar from \"@material-ui/core/Avatar\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport {Link as RouterLink} from \"react-router-dom\";\n\nimport { saveDeviceStatus } from \"module/firestore/firebase\";\nimport Button from \"@material-ui/core/Button\";\nimport {makeStyles} from \"@material-ui/core\";\n\nconst StatusLink = React.forwardRef((props, ref) => (\n  <RouterLink innerRef={ref} to=\"/status\" {...props} />\n));\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    flexGrow: \"1\"\n  },\n  statusBtn: {\n    alignSelf: \"flex-end\",\n    color: \"#ccc\"\n  },\n  spacer: {\n    flexGrow: 1\n  }\n}));\n\nexport default function ConnectionPanel(props) {\n  const { enqueueSnackbar } = useSnackbar();\n  const classes = useStyles();\n\n  useEffect(() => {\n    if (props.connected && props.name) {\n      saveDeviceStatus(props.name, {\n        battery: props.batteryLevel,\n        firmware: props.firmware\n      });\n    }\n  }, [props.connected, props.name, props.firmware, props.batteryLevel]);\n\n  function onConnectionEvent(state) {\n    props.onConnectionEvent(state);\n    if (state) {\n      props.readName();\n      props.readFirmware();\n\n      enqueueSnackbar(\"Thingy połączone!\", { variant: \"success\"});\n      props.startErrorNotification();\n      props.startDisconnectNotification();\n      props.startWriteNotification();\n      props.startBatteryNotification();\n    } else {\n      enqueueSnackbar(\"Thingy rozłączone!\");\n    }\n  }\n\n  const connectButton = <ConnectButton onConnectionEvent={onConnectionEvent} disconnect={props.disconnect} notifyError={props.notifyError} connected={props.connected} />;\n  const statusButton = <Button fullWidth={true} className={classes.statusBtn} component={StatusLink}>status</Button>;\n\n  const infoBlock = props.connected && props.name && props.firmware && props.batteryLevel\n    ? (\n      <ListItem>\n        <ListItemAvatar>\n          <Avatar>\n            <Battery className=\"battery\" batteryLevel={props.batteryLevel} />\n          </Avatar>\n        </ListItemAvatar>\n        <ListItemText primary={props.name} secondary={`${props.firmware} / bateria: ${props.batteryLevel}%`} />\n      </ListItem>\n    )\n    : null;\n\n  return (\n    <div className={classes.root}>\n      {infoBlock}\n      {connectButton}\n      <div className={classes.spacer} />\n      {statusButton}\n    </div>\n  );\n}\n\nConnectionPanel.propTypes = {\n  name: PropTypes.string,\n  notification: PropTypes.object,\n  connected: PropTypes.bool,\n  batteryLevel: PropTypes.number,\n  onConnectionEvent: PropTypes.func,\n  readName: PropTypes.func,\n  readFirmware: PropTypes.func,\n  startErrorNotification: PropTypes.func,\n  startWriteNotification: PropTypes.func,\n  startBatteryNotification: PropTypes.func,\n  startDisconnectNotification: PropTypes.func,\n  notifyError: PropTypes.func,\n  disconnect: PropTypes.func,\n  firmware: PropTypes.string,\n};\n","import {connect} from \"react-redux\";\nimport {readFeature, onConnectionEvent, disconnect, startDisconnectNotification, startErrorNotification, startWriteNotification, startBatteryNotification, notifyError} from \"module/thingy/thingy-actions\";\nimport ConnectionPanel from \"./connection-panel\";\n\nconst mapStateToProps = ({thingy}) => {\n  return ({\n    connected: thingy.connected.reading,\n    name: thingy.name.reading.name,\n    firmware: thingy.firmware.reading.firmware,\n    notification: thingy.notification,\n    batteryLevel: thingy.battery.reading.status,\n  });\n};\n\nconst mapDispatchToProps = (dispatch) => ({\n  onConnectionEvent: (state) => {\n    dispatch(onConnectionEvent(state));\n  },\n  readName: () => {\n    dispatch(readFeature(\"name\"));\n  },\n  readFirmware: () => {\n    dispatch(readFeature(\"firmware\"));\n  },\n  disconnect: () => {\n    dispatch(disconnect());\n  },\n  startDisconnectNotification: () => {\n    dispatch(startDisconnectNotification());\n  },\n  startErrorNotification: () => {\n    dispatch(startErrorNotification());\n  },\n  startWriteNotification: () => {\n    dispatch(startWriteNotification());\n  },\n  startBatteryNotification: () => {\n    dispatch(startBatteryNotification(\"battery\", \"on\"));\n  },\n  notifyError: (e) => {\n    dispatch(notifyError(e));\n  },\n});\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps,\n)(ConnectionPanel);\n","import React from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Table from \"@material-ui/core/Table\";\nimport TableBody from \"@material-ui/core/TableBody\";\nimport TableCell from \"@material-ui/core/TableCell\";\nimport TableHead from \"@material-ui/core/TableHead\";\nimport TableRow from \"@material-ui/core/TableRow\";\nimport Paper from \"@material-ui/core/Paper\";\n\nimport thingyImage from \"assets/thingy-product.png\";\nimport {useDeviceCollection} from \"module/firestore/firebase\";\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: \"flex\",\n    margin: theme.spacing(3)\n  },\n  table: {\n    minWidth: 650,\n  },\n  thingyImage: {\n    marginTop: theme.spacing(4)\n  }\n}));\n\nexport default function StatusView() {\n  const classes = useStyles();\n  const [value, loading, error] = useDeviceCollection(\"deviceStatus\");\n\n  return (\n    <Paper className={classes.root}>\n      <img src={thingyImage} className={classes.thingyImage} alt=\"\" />\n      {error && <strong>Error: {JSON.stringify(error)}</strong>}\n      {loading && <span>Collection: Loading...</span>}\n      {value && (\n        <Table className={classes.table} aria-label=\"simple table\">\n          <TableHead>\n            <TableRow>\n              <TableCell>Nazwa</TableCell>\n              <TableCell align=\"right\">Poziom baterii</TableCell>\n              <TableCell align=\"right\">Wersja</TableCell>\n              <TableCell align=\"right\">Ostatnio oktywny</TableCell>\n            </TableRow>\n          </TableHead>\n          <TableBody>\n            {value.docs\n              .map(doc => ({ id: doc.id, ...doc.data() }))\n              .sort((a,b) => a.id.localeCompare(b.id))\n              .map(doc => {\n                const date = doc.lastContact\n                  ? new Date(Number(doc.lastContact.seconds) * 1000)\n                  : null;\n                return (\n                  <TableRow key={doc.id}>\n                    <TableCell component=\"th\" scope=\"row\">\n                      {doc.id}\n                    </TableCell>\n                    <TableCell align=\"right\">{doc.battery}%</TableCell>\n                    <TableCell align=\"right\">{doc.firmware ? doc.firmware : '-'}</TableCell>\n                    <TableCell align=\"right\">{date ? (date.toLocaleString(\"pl\")) : null}\n                    </TableCell>\n                  </TableRow>\n                );\n              }\n              )}\n          </TableBody>\n        </Table>\n      )}\n    </Paper>\n  );\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport {makeStyles} from \"@material-ui/core/styles\";\nimport Menu from \"components/ui/menu\";\nimport Drawer from \"@material-ui/core/Drawer\";\nimport {Route, Switch} from \"react-router-dom\";\n\nimport NotConnectedView from \"../components/not-connected-view\";\nimport ConnectionPanel from \"../components/connection-panel-container\";\nimport StatusView from \"components/status-view\";\n\nconst drawerWidth = 240;\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: \"flex\",\n  },\n  drawer: {\n    width: drawerWidth,\n    flexShrink: 0,\n  },\n  drawerPaper: {\n    width: drawerWidth,\n    backgroundColor: theme.palette.background.darker,\n  },\n  toolbar: theme.mixins.toolbar,\n  content: {\n    flexGrow: 1,\n    backgroundColor: theme.palette.background.default,\n  },\n}));\n\nexport default function App(props) {\n  const classes = useStyles();\n  const { isConnected, challenges } = props;\n\n  const router = (\n    <Switch>\n      <Route exact path=\"/status\" component={StatusView} />\n      {\n        isConnected\n          ? challenges.map(item => <Route exact key={item.path} path={item.path} component={item.component} />)\n          : <Route path=\"*\" component={NotConnectedView} />\n      }\n    </Switch>\n  );\n\n  return (\n    <div className={classes.root}>\n      <Drawer className={classes.drawer} variant=\"permanent\" classes={{ paper: classes.drawerPaper }}>\n        <Menu items={challenges} />\n        <ConnectionPanel />\n      </Drawer>\n      <main className={classes.content}>\n        {router}\n      </main>\n    </div>\n  );\n}\n\nApp.propTypes = {\n  isConnected: PropTypes.bool,\n  challenges: PropTypes.array\n};\n","import {connect} from \"react-redux\";\nimport App from \"./app\";\n\nconst mapStateToProps = ({ thingy }) => ({\n  isConnected: thingy.connected.reading\n});\n\nexport default connect(mapStateToProps)(App);\n","import { red } from \"@material-ui/core/colors\";\nimport { createMuiTheme } from \"@material-ui/core/styles\";\n\n// A custom theme for this app\nconst theme = createMuiTheme({\n  palette: {\n    primary: {\n      main: \"#3f51b5\",\n    },\n    secondary: {\n      main: \"#ffff02\",\n    },\n    error: {\n      main: red.A400,\n    },\n    background: {\n      darker: \"#f2f2f2\",\n    },\n  },\n});\n\nexport default theme;\n","import {\n  RECEIVE_NEW_READING,\n  RECEIVE_NEW_NOTIFY_READING,\n  FEATURE_NOTIFICATION_STATUS,\n  CLEAN_THE_SLATE,\n  NOTIFY_USER,\n  SET_FEATURE_HAS_EVENT_LISTENER,\n} from \"module/thingy/thingy-actions\";\n\nconst thingyState = {\n  connected: {\n    reading: false,\n  },\n  temperature: {\n    status: false,\n    reading: undefined,\n  },\n  pressure: {\n    status: false,\n    reading: undefined,\n  },\n  co2: {\n    status: false,\n    reading: undefined,\n  },\n  tvoc: {\n    status: false,\n    reading: undefined,\n  },\n  humidity: {\n    status: false,\n    reading: undefined,\n  },\n  color: {\n    status: false,\n    reading: undefined,\n  },\n  stepcounter: {\n    status: false,\n    reading: {\n      count: 0,\n      time: {\n        unit: \"ms\",\n        value: 0,\n      },\n    },\n  },\n  tap: {\n    status: false,\n    reading: {\n      direction: 0,\n      count: 0,\n    },\n  },\n  gravityvector: {\n    status: false,\n    reading: {\n      value: {\n        x: 0,\n        y: 0,\n        z: 0\n      }\n    },\n  },\n  heading: {\n    status: false,\n    reading: {\n      heading: 0,\n    },\n  },\n  quaternionorientation: {\n    status: false,\n    reading: {\n      x: 0,\n      y: 0,\n      z: 0,\n      w: 0,\n    },\n  },\n  led: {\n    reading: {\n      mode: -1,\n    },\n  },\n  button: {\n    status: false,\n    reading: {\n      value: 0,\n    },\n  },\n  firmware: {\n    reading: {\n      firmware: \"\",\n    },\n  },\n  name: {\n    reading: {\n      name: \"\",\n    },\n  },\n  advertisingparameters: {\n    reading: {\n      interval: 0,\n      timeout: 0,\n    },\n  },\n  connectionparameters: {\n    reading: {\n      minInterval: 8,\n      maxInterval: 4000,\n      slaveLatency: 0,\n      timeout: 100,\n    },\n  },\n  eddystone: {\n    reading: {\n      href: \"\",\n    },\n  },\n  cloudtoken: {\n    reading: {\n      token: \"\",\n    },\n  },\n  environmentconfiguration: {\n    reading: {\n      temperatureInterval: 0,\n      pressureInterval: 0,\n      humidityInterval: 0,\n      colorInterval: 0,\n      gasInterval: 1,\n      colorSensorCalibration: {\n        blue: 0,\n        green: 0,\n        red: 0,\n      },\n    },\n  },\n  motionconfiguration: {\n    reading: {\n      stepCounterInterval: 0,\n      tempCompensationInterval: 0,\n      magnetCompInterval: 0,\n      motionProcessFrequency: 0,\n      wakeOnMotion: 0,\n    },\n  },\n  samples: {\n    reading: undefined,\n  },\n  tones: {\n    reading: undefined,\n  },\n  pcm: {\n    reading: {\n      playStatus: 0,\n    },\n  },\n  microphone: {\n    reading: undefined,\n    status: false,\n  },\n  battery: {\n    reading: {\n      status: 100,\n    },\n  },\n};\n\nexport default (state = thingyState, action) => {\n  switch (action.type) {\n  case RECEIVE_NEW_READING:\n    return {\n      ...state,\n      [action.reading.feature]: {\n        ...state[action.reading.feature],\n        reading: action.reading.reading,\n      },\n    };\n\n  case RECEIVE_NEW_NOTIFY_READING:\n    if (action.reading.feature === \"gas\") {\n      return {\n        ...state,\n        co2: {\n          ...state.co2,\n          reading: (state.co2.status ? action.reading.reading.detail.eCO2 : state.co2.reading),\n        },\n        tvoc: {\n          ...state.tvoc,\n          reading: (state.tvoc.status ? action.reading.reading.detail.TVOC : state.tvoc.reading),\n        },\n      };\n    } else {\n      return {\n        ...state,\n        [action.reading.feature]: {\n          ...state[action.reading.feature],\n          reading: action.reading.reading.detail,\n        },\n      };\n    }\n\n  case FEATURE_NOTIFICATION_STATUS:\n    return {\n      ...state,\n      [action.status.feature]: {\n        ...state[action.status.feature],\n        status: action.status.status,\n      },\n    };\n\n  case CLEAN_THE_SLATE:\n    return thingyState;\n\n  case NOTIFY_USER:\n    return {\n      ...state,\n      notification: action.message,\n    };\n\n  case SET_FEATURE_HAS_EVENT_LISTENER:\n    return {\n      ...state,\n      [action.feature]: {\n        ...state[action.feature],\n        hasEventListener: true,\n      },\n    };\n\n  default:\n    return state;\n  }\n};\n","import { combineReducers } from \"redux\";\nimport thingy from \"module/thingy/thingy-reducer\";\n\nexport default combineReducers({\n  thingy,\n});\n","// Converts a number representing a color into an RGB value\nexport const colorToRgb = (color) => {\n  let rgb;\n  switch (color) {\n  case 1:\n    rgb = {red: 255, green: 0, blue: 0};\n    break;\n  case 2:\n    rgb = {red: 0, green: 128, blue: 0};\n    break;\n  case 3:\n    rgb = {red: 255, green: 255, blue: 0};\n    break;\n  case 4:\n    rgb = {red: 0, green: 0, blue: 255};\n    break;\n  case 5:\n    rgb = {red: 128, green: 0, blue: 128};\n    break;\n  case 6:\n    rgb = {red: 0, green: 255, blue: 255};\n    break;\n  case 7:\n    rgb = {red: 255, green: 255, blue: 255};\n    break;\n  default:\n    rgb = {red: 0, green: 255, blue: 255};\n  }\n  return rgb;\n};\n\n// Converts an RGB value into a number representing a color\nexport const rgbToColor = (rgb) => {\n  let color;\n  switch (true) {\n  case rgb.red === 255 && rgb.green === 0 && rgb.blue === 0:\n    color = 1;\n    break;\n  case rgb.red === 0 && rgb.green === 128 && rgb.blue === 0:\n    color = 2;\n    break;\n  case rgb.red === 255 && rgb.green === 255 && rgb.blue === 0:\n    color = 3;\n    break;\n  case rgb.red === 0 && rgb.green === 0 && rgb.blue === 255:\n    color = 4;\n    break;\n  case rgb.red === 128 && rgb.green === 0 && rgb.blue === 128:\n    color = 5;\n    break;\n  case rgb.red === 0 && rgb.green === 255 && rgb.blue === 255:\n    color = 6;\n    break;\n  case rgb.red === 255 && rgb.green === 255 && rgb.blue === 255:\n    color = 7;\n    break;\n  default:\n    color = undefined;\n  }\n\n  return color;\n};\n","import React from \"react\";\nimport {rgbToColor} from \"../../../utils/colorConverter\";\n\nexport const CardLedView = (props) => (\n  <div className=\"card_led_view\">\n    <div className=\"led_modes\">\n      <button type=\"button\" className=\"led_mode_button button_blue\" value=\"constant\" disabled={props.feature.reading.mode === 1} onClick={props.changeMode}>Stałe</button>\n      <button type=\"button\" className=\"led_mode_button button_blue\" value=\"breathe\" disabled={props.feature.reading.mode === 2} onClick={props.changeMode}>Pulsujące</button>\n      <button type=\"button\" className=\"led_mode_button button_blue\" value=\"oneshot\" disabled={props.feature.reading.mode === 3} onClick={props.changeMode}>Jednorazowe</button>\n      <button type=\"button\" className=\"led_mode_button button_blue\" value=\"off\" disabled={props.feature.reading.mode === 0} onClick={props.changeMode}>Wyłącz</button>\n    </div>\n    <div className=\"led_colorpicker\">\n      <div>\n        <button type=\"button\" className=\"button red\" value=\"1\" disabled={props.feature.reading.mode === 0 || (props.feature.reading.mode === 1 && rgbToColor({red: props.feature.reading.r, green: props.feature.reading.g, blue: props.feature.reading.b}) === 1) || ([2, 3].includes(props.feature.reading.mode) && props.feature.reading.color === 1)} onClick={props.changeColor}></button>\n        <button type=\"button\" className=\"button green\" value=\"2\" disabled={props.feature.reading.mode === 0 || (props.feature.reading.mode === 1 && rgbToColor({red: props.feature.reading.r, green: props.feature.reading.g, blue: props.feature.reading.b}) === 2) || ([2, 3].includes(props.feature.reading.mode) && props.feature.reading.color === 2)} onClick={props.changeColor}></button>\n        <button type=\"button\" className=\"button yellow\" value=\"3\" disabled={props.feature.reading.mode === 0 || (props.feature.reading.mode === 1 && rgbToColor({red: props.feature.reading.r, green: props.feature.reading.g, blue: props.feature.reading.b}) === 3) || ([2, 3].includes(props.feature.reading.mode) && props.feature.reading.color === 3)} onClick={props.changeColor}></button>\n        <button type=\"button\" className=\"button blue\" value=\"4\" disabled={props.feature.reading.mode === 0 || (props.feature.reading.mode === 1 && rgbToColor({red: props.feature.reading.r, green: props.feature.reading.g, blue: props.feature.reading.b}) === 4) || ([2, 3].includes(props.feature.reading.mode) && props.feature.reading.color === 4)} onClick={props.changeColor}></button>\n      </div>\n      <div>\n        <button className=\"button purple\" value=\"5\" disabled={props.feature.reading.mode === 0 || (props.feature.reading.mode === 1 && rgbToColor({red: props.feature.reading.r, green: props.feature.reading.g, blue: props.feature.reading.b}) === 5) || ([2, 3].includes(props.feature.reading.mode) && props.feature.reading.color === 5)} onClick={props.changeColor}></button>\n        <button className=\"button cyan\" value=\"6\" disabled={props.feature.reading.mode === 0 || (props.feature.reading.mode === 1 && rgbToColor({red: props.feature.reading.r, green: props.feature.reading.g, blue: props.feature.reading.b}) === 6) || ([2, 3].includes(props.feature.reading.mode) && props.feature.reading.color === 6)} onClick={props.changeColor}></button>\n        <button className=\"button white\" value=\"7\" disabled={props.feature.reading.mode === 0 || (props.feature.reading.mode === 1 && rgbToColor({red: props.feature.reading.r, green: props.feature.reading.g, blue: props.feature.reading.b}) === 7 || ([2, 3].includes(props.feature.reading.mode) && props.feature.reading.color === 7))} onClick={props.changeColor}></button>\n      </div>\n    </div>\n  </div>\n);\n","import React, {Fragment} from \"react\";\n\nimport {CardButtonView, CardLedView} from \"./UICards\";\n\nimport PropTypes from \"prop-types\";\nimport \"./styles.css\";\nimport ChallengeHeader from \"components/ui/challenge-header\";\n\nclass UI extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      led: props.led,\n    };\n\n    this.changeTab = props.changeTab;\n    this.changeColor = this.changeColor.bind(this);\n    this.changeMode = this.changeMode.bind(this);\n    this.shutdown = props.shutdown;\n  }\n\n  componentWillReceiveProps(np) {\n    if (np.button !== this.state.button) {\n      this.setState((ps) => ({\n        ...ps,\n        button: np.button,\n      }));\n    }\n\n    if (np.led !== this.state.led) {\n      this.setState((ps) => ({\n        ...ps,\n        led: np.led,\n      }));\n    }\n  }\n\n  componentDidMount() {\n    this.props.startUiFeatures();\n  }\n\n  changeColor(event) {\n    this.props.writeLedColor(parseInt(event.target.value, 10), this.state.led.reading);\n  }\n\n  changeMode(event) {\n    this.props.writeLedMode(event.target.value, this.state.led.reading);\n  }\n\n  render() {\n    return (\n      <div className=\"content\">\n        <ChallengeHeader text=\"Dioda\" />\n        <CardLedView feature={this.state.led} changeColor={this.changeColor} changeMode={this.changeMode}/>\n      </div>\n    );\n  }\n}\n\nUI.propTypes = {\n  button: PropTypes.object,\n  led: PropTypes.object,\n  changeTab: PropTypes.func,\n  toggleButton: PropTypes.func,\n  stopButton: PropTypes.func,\n  startUiFeatures: PropTypes.func,\n  writeLedColor: PropTypes.func,\n  writeLedMode: PropTypes.func,\n  shutdown: PropTypes.func,\n};\n\nexport default UI;\n","import {connect} from \"react-redux\";\nimport {readFeature, writeFeature} from \"module/thingy/thingy-actions\";\n\nimport {colorToRgb, rgbToColor} from \"utils/colorConverter\";\n\nimport Lesson from './index';\n\nconst mapStateToProps = ({ thingy }) => {\n  return ({\n    led: thingy.led,\n  });\n};\n\nconst mapDispatchToProps = (dispatch) => ({\n  startUiFeatures: () => {\n    dispatch(readFeature(\"led\"));\n  },\n  writeLedColor: (color, led) => {\n    let mode;\n    switch (led.mode) {\n    case 0:\n      mode = \"off\";\n      break;\n    case 1:\n      mode = \"constant\";\n      break;\n    case 2:\n      mode = \"breathe\";\n      break;\n    case 3:\n      mode = \"oneshot\";\n      break;\n    default:\n      mode = \"breathe\";\n    }\n\n    const rgbConvertedColor = colorToRgb(color);\n    const red = rgbConvertedColor.red;\n    const green = rgbConvertedColor.green;\n    const blue = rgbConvertedColor.blue;\n\n    const delay = led.delay || 3500;\n    const params = {\n      mode: mode,\n      color: color,\n      intensity: led.intensity,\n      delay: delay,\n      red: red,\n      green: green,\n      blue: blue,\n    };\n\n    console.log({ params });\n    dispatch(writeFeature(\"led\", params));\n  },\n  writeLedMode: (mode, led) => {\n    let color;\n    if (led.mode === 1) {\n      color = rgbToColor({red: led.r, green: led.g, blue: led.b});\n    } else {\n      color = led.color || 6;\n    }\n    const delay = led.delay || 1000;\n    const intensity = led.intensity || 20;\n    const rgbConvertedColor = colorToRgb(color);\n    const red = rgbConvertedColor.red;\n    const green = rgbConvertedColor.green;\n    const blue = rgbConvertedColor.blue;\n    const params = {\n      mode: mode,\n      color: color,\n      intensity: intensity,\n      delay: delay,\n      red: red,\n      green: green,\n      blue: blue,\n    };\n    dispatch(writeFeature(\"led\", params));\n  },\n});\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps,\n)(Lesson);\n","import {connect} from \"react-redux\";\nimport {readFeature, toggleFeature, writeFeature} from \"module/thingy/thingy-actions\";\n\nimport {colorToRgb} from \"utils/colorConverter\";\nimport Lesson from \"components/challenges/led.js\";\n\nconst mapStateToProps = ({ thingy }) => {\n  return ({\n    connected: thingy.connected.reading,\n    buttonPressed: thingy.button.reading.value,\n    led: thingy.led,\n  });\n};\n\nconst mapDispatchToProps = (dispatch) => ({\n  onStart: () => {\n    dispatch(readFeature(\"led\"));\n    dispatch(toggleFeature(\"button\", \"on\"));\n  },\n  writeLedColor: (color, led) => {\n    let mode;\n    switch (led.mode) {\n    case 0:\n      mode = \"off\";\n      break;\n    case 1:\n      mode = \"constant\";\n      break;\n    case 2:\n      mode = \"breathe\";\n      break;\n    case 3:\n      mode = \"oneshot\";\n      break;\n    default:\n      mode = \"breathe\";\n    }\n\n    const rgbConvertedColor = colorToRgb(color);\n    const red = rgbConvertedColor.red;\n    const green = rgbConvertedColor.green;\n    const blue = rgbConvertedColor.blue;\n\n    const delay = led.delay || 3500;\n    const params = {\n      mode: mode,\n      color: color,\n      intensity: led.intensity,\n      delay: delay,\n      red: red,\n      green: green,\n      blue: blue,\n    };\n\n    console.log({ params });\n    dispatch(writeFeature(\"led\", params));\n  }\n});\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps,\n)(Lesson);\n","import {connect} from \"react-redux\";\nimport {toggleFeature} from \"module/thingy/thingy-actions\";\n\nimport Dino from \"components/challenges/dino\";\n\nconst mapStateToProps = ({ thingy }) => {\n  return ({\n    connected: thingy.connected.reading,\n    buttonPressed: thingy.button.reading.value,\n    tapDirection: thingy.tap.reading.direction,\n    tapCount: thingy.tap.reading.count\n  });\n};\n\nconst mapDispatchToProps = (dispatch) => ({\n  onStart: () => {\n    dispatch(toggleFeature(\"button\", \"on\"));\n    dispatch(toggleFeature(\"tap\", \"on\"));\n  },\n  onEnd: () => {\n  }\n});\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps,\n)(Dino);\n","import {connect} from \"react-redux\";\nimport {toggleFeature} from \"module/thingy/thingy-actions\";\n\nimport Ball from \"components/challenges/ball\";\n\nconst mapStateToProps = ({ thingy }) => ({\n  connected: thingy.connected.reading,\n  gravity: thingy.gravityvector.reading.value\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n  onStart: () => {\n    dispatch(toggleFeature(\"button\", \"on\"));\n    dispatch(toggleFeature(\"gravityvector\", \"on\"));\n  },\n  onEnd: () => {\n    dispatch(toggleFeature(\"gravityvector\", \"off\"));\n  }\n});\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps,\n)(Ball);\n","import React, {useEffect, useState} from \"react\";\nimport Chart from \"react-apexcharts\";\n\nexport default function RealtimeChart(props) {\n  const [temps, setTemps] = useState([]);\n\n  useEffect(() => {\n    if (props.data) {\n      const newData = temps.slice(-10);\n      newData.push({ x: Date.now(), y: props.data.value });\n      setTemps(newData);\n    }\n  }, [props.data]);\n\n  const options = {\n    chart: {\n      id: \"realtime\",\n      animations: {\n        enabled: false\n      },\n      toolbar: {\n        show: false\n      },\n      zoom: {\n        enabled: false\n      }\n    },\n    dataLabels: {\n      enabled: false\n    },\n    stroke: {\n      curve: \"smooth\"\n    },\n    markers: {\n      size: 0\n    },\n    xaxis: {\n      type: \"datetime\",\n      //range: XAXISRANGE,\n    },\n    yaxis: {\n      // min: Math.min(...temps.map(y))\n      // max: 100\n    },\n    legend: {\n      show: true\n    }\n  };\n\n  const series = [{\n    data: temps.slice()\n  }];\n\n  return <Chart options={options} series={series} type=\"line\" height=\"350\" />;\n}\n","import {connect} from \"react-redux\";\nimport {toggleFeature} from \"module/thingy/thingy-actions\";\n\nimport Sensors from \"./sensors\";\n\nconst mapStateToProps = ({ thingy }) => {\n  return ({\n    connected: thingy.connected.reading,\n    temperature: thingy.temperature.reading,\n    humidity: thingy.humidity.reading\n  });\n};\n\nconst mapDispatchToProps = (dispatch) => ({\n  onStart: () => {\n    dispatch(toggleFeature(\"temperature\", \"on\"));\n    dispatch(toggleFeature(\"humidity\", \"on\"));\n  }\n});\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps,\n)(Sensors);\n","import LightAndSound2 from \"components/challenges/light-and-sound/container\";\nimport LightAndSound from \"components/challenges/led-container\";\nimport DinosaurGame from \"components/challenges/dino-container\";\nimport BallGame from \"components/challenges/ball-container\";\nimport Sensors from \"components/challenges/sensors-container\";\n\nexport default [\n  { path: \"/sensors\", component: Sensors, primary: \"Zadanie #1\", secondary: \"Czujniki\" },\n  { path: \"/lights\", component: LightAndSound, primary: \"Zadanie #2\", secondary: \"Światło i dźwięk\" },\n  // { path: \"/lights2\", component: LightAndSound2, primary: \"Zadanie #02a\", secondary: \"Światło i dźwięk\" },\n  { path: \"/dino\", component: DinosaurGame, primary: \"Zadanie #3\", secondary: \"Gra: Skaczący Dinozaur\" },\n  { path: \"/ball\", component: BallGame, primary: \"Zadanie #4\", secondary: \"Gra: Kulka\" }\n];\n","import React, {useEffect} from \"react\";\n\nimport useMarkdown from \"utils/use-markdown\";\nimport helpTextUrl from \"./sensors.md\";\nimport ChallengeFrame from \"components/ui/challenge-frame\";\nimport RealtimeChart from \"components/ui/realtime-chart\";\n\nexport default function Sensors(props) {\n  const markdownText = useMarkdown(helpTextUrl);\n\n  useEffect(() => {\n    props.onStart();\n  }, [props.connected]);\n\n  return (\n    <ChallengeFrame\n      headerText=\"Sensory\"\n      markdownText={markdownText}\n      showcasePanel={<div>\n        Temperatura:\n        <RealtimeChart data={props.temperature} />\n        Wilgotność:\n        <RealtimeChart data={props.humidity} />\n      </div>}\n    />\n  );\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport { ThemeProvider } from \"@material-ui/styles\";\nimport App from \"./components/app-container\";\nimport theme from \"./theme\";\nimport { BrowserRouter as Router } from \"react-router-dom\";\n\nimport {createStore, applyMiddleware} from \"redux\";\nimport {Provider } from \"react-redux\";\nimport thunk from \"redux-thunk\";\nimport AppReducer from \"./reducers\";\nimport {SnackbarProvider} from \"notistack\";\n\nimport challenges from \"./challenges\";\n\nimport { pathPrefix } from \"../package.json\";\n\nconst store = createStore(AppReducer, applyMiddleware(thunk));\n\nReactDOM.render(\n  <ThemeProvider theme={theme}>\n    <CssBaseline />\n    <Provider store={store}>\n      <SnackbarProvider maxSnack={3}>\n        <Router basename={pathPrefix}>\n          <App challenges={challenges} />\n        </Router>\n      </SnackbarProvider>\n    </Provider>\n  </ThemeProvider>,\n  document.querySelector(\"#root\"),\n);\n","import React from \"react\";\nimport AceEditor from \"react-ace\";\n\nimport \"ace-builds/src-noconflict/mode-java\";\nimport \"ace-builds/src-noconflict/theme-github\";\n\nexport default function CodeEditor(props) {\n  return (\n    <AceEditor\n      placeholder=\"Tu wprowadź czarodziejski kod...\"\n      mode=\"javascript\"\n      theme=\"github\"\n      name=\"blah2\"\n      width=\"100%\"\n      fontSize={20}\n      showPrintMargin={true}\n      showGutter={true}\n      highlightActiveLine={true}\n      setOptions={{\n        showLineNumbers: true,\n        tabSize: 2,\n      }}\n      {...props}\n    />\n  );\n}\n","import React from \"react\";\nimport Card from \"@material-ui/core/Card\";\nimport CardActions from \"@material-ui/core/CardActions\";\nimport Button from \"@material-ui/core/Button\";\nimport PlayCircleOutlineIcon from \"@material-ui/icons/PlayCircleOutline\";\n\nimport CodeEditor from \"./code-editor\";\n\nexport default function CodeEditorCard(props) {\n  const { name, initial, onRun } = props;\n\n  const codeString = localStorage.getItem(name) || initial || \"\";\n  const handleCodeChange = (newValue) => localStorage.setItem(name, newValue);\n  const executeCode = () => onRun(localStorage.getItem(name));\n\n  return (\n    <Card>\n      <CodeEditor onChange={handleCodeChange} value={codeString} />\n      <CardActions>\n        <Button onClick={executeCode} size=\"medium\" variant=\"contained\" color=\"primary\" startIcon={<PlayCircleOutlineIcon />}>\n          Wykonaj\n        </Button>\n      </CardActions>\n    </Card>\n  );\n}\n","import React from \"react\";\nimport {pathPrefix} from \"../../../package.json\";\nimport {makeStyles} from \"@material-ui/core\";\n\nconst useStyles = makeStyles(theme => ({\n  iframeNode: {\n    display: \"block\"\n  },\n}));\n\nexport function gameCommand(id, cmd) {\n  document.getElementById(id).contentWindow.postMessage({ cmd });\n}\n\nexport default function GameFrame(props) {\n  const { id, publicPath } = props;\n  const iframeSrc = (window.location.hostname !== \"localhost\" ? pathPrefix : \"\") + publicPath;\n  const classes = useStyles();\n\n  return (\n    <iframe src={iframeSrc} id={id} width=\"100%\" height={320} frameBorder={0} className={classes.iframeNode} />\n  );\n}\n","module.exports = __webpack_public_path__ + \"static/media/thingy-product.3a8d5863.png\";","import React from \"react\";\n\nimport AppBar from \"@material-ui/core/AppBar/AppBar\";\nimport Toolbar from \"@material-ui/core/Toolbar\";\nimport Typography from \"@material-ui/core/Typography\";\nimport {makeStyles} from \"@material-ui/core\";\n\nconst useStyles = makeStyles(theme => ({\n  toolbar: {\n    padding: theme.spacing(1.05),\n    boxShadow: theme.shadows[2],\n  },\n}));\n\nexport default function ChallengeHeader(props) {\n  const classes = useStyles();\n\n  return (\n    <AppBar position=\"static\" color=\"secondary\" className={classes.toolbar}>\n      <Toolbar>\n        <Typography variant=\"h5\">\n          {props.text}\n        </Typography>\n      </Toolbar>\n    </AppBar>\n  );\n}\n"],"sourceRoot":""}